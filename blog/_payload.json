[{"data":1,"prerenderedAt":10029},["ShallowReactive",2],{"navigation":3,"blog-page":54,"blogs":63},[4],{"title":5,"path":6,"stem":7,"children":8,"page":53},"Blog","/blog","blog",[9,13,17,21,25,29,33,37,41,45,49],{"title":10,"path":11,"stem":12},"Third post","/blog/_lorem-ipsum","blog/_lorem-ipsum",{"title":14,"path":15,"stem":16},"Markdown Style Guide","/blog/_markdown-style-guide","blog/_markdown-style-guide",{"title":18,"path":19,"stem":20},"Remote Debugging Addon for Blender","/blog/blender-debugger","blog/blender-debugger",{"title":22,"path":23,"stem":24},"How to use Dynamic Variables with Tailwind","/blog/dynamic-tailwind","blog/dynamic-tailwind",{"title":26,"path":27,"stem":28},"Krita Popup Palette Improvements","/blog/krita-brush-pr","blog/krita-brush-pr",{"title":30,"path":31,"stem":32},"How to map Mod+Number keys in Vim/Neovim (using Wezterm)","/blog/neovim-wezterm-mod-number-keys","blog/neovim-wezterm-mod-number-keys",{"title":34,"path":35,"stem":36},"Handling Thousands Cards on an Infinite Canvas","/blog/performant-pixi-infinite-canvas","blog/performant-pixi-infinite-canvas",{"title":38,"path":39,"stem":40},"Abusing Typescript's New `satisfies` Operator","/blog/satisfies","blog/satisfies",{"title":42,"path":43,"stem":44},"How to Publish v0.x.x Versioned Packages with Semantic Release","/blog/semantic-release-v0","blog/semantic-release-v0",{"title":46,"path":47,"stem":48},"I cave, Tailwind rocks.","/blog/tailwind-rocks","blog/tailwind-rocks",{"title":50,"path":51,"stem":52},"How To Add Tests To A Zig Project","/blog/zig-testing","blog/zig-testing",false,{"id":55,"title":56,"body":57,"description":57,"extension":58,"links":57,"meta":59,"navigation":60,"path":6,"seo":61,"stem":7,"__hash__":62},"pages/blog.yml","Blog Posts",null,"yml",{},true,{"title":56,"description":57},"X2KAaQFqfJnP41-6N6Sca0ptnW9NqZyswt9ZE0IoH1c",[64,6175,6487,6683,8255,8616,9158,9865,9983],{"id":65,"title":34,"body":66,"date":6158,"description":6159,"extension":6160,"image":6161,"langs":6162,"meta":6166,"navigation":60,"path":35,"published":60,"rawbody":6167,"seo":6168,"static_image":6169,"stem":36,"tags":6170,"video_image":6173,"__hash__":6174},"blog/blog/performant-pixi-infinite-canvas.md",{"type":67,"value":68,"toc":6135},"minimark",[69,81,84,94,99,111,118,133,138,145,149,158,161,164,168,171,174,177,213,217,220,223,230,237,240,243,922,937,941,946,949,952,1229,1233,1236,1241,1244,1247,1250,1254,1257,1260,1263,1266,1270,1281,1943,1949,1952,1956,1963,1966,1974,1977,1988,1991,1994,1998,2008,2011,2015,2018,2021,2024,2031,2038,2041,2045,2052,2055,4102,4106,4115,4705,4708,4715,4722,4725,4729,4732,4735,4739,4742,4745,4748,4751,4754,4757,4763,4770,4773,4842,4845,4854,4857,4860,4863,4866,6061,6065,6069,6072,6075,6079,6093,6097,6111,6115,6132],[70,71,72,73,80],"p",{},"I'm working on an app, ",[74,75,79],"a",{"href":76,"rel":77},"https://pyramidnotes.com",[78],"nofollow","Pyramid Notes",", which will have an infinite canvas.",[70,82,83],{},"It will have two modes mainly:",[85,86,87,91],"ul",{},[88,89,90],"li",{},"freeform mode - users can drop and place cards everywhere.",[88,92,93],{},"\"structured\" mode - with a preset layout. In this initial version, the layout will is a visualization of note tags (they function more like folders).",[95,96,98],"h2",{"id":97},"initial-dom-based-attempt","Initial DOM Based Attempt",[70,100,101,102,106,107,110],{},"I had initially planned to create an HTML based infinite canvas as it's just easier to get started with, but the DOM approach has a lot of lag, ",[103,104,105],"em",{},"especially"," when zooming, which was a deal breaker. I ",[103,108,109],{},"needed"," really fast zoom in/out performance.",[70,112,113,114,117],{},"The html version ",[103,115,116],{},"was"," a bit naively coded, but the same approach with pixi.js (webgl canvas lib) was 10x more performant. Properly optimized HTML starts lagging at around 1000 notes, my initial quick canvas implementation started lagging at around 10,000.",[70,119,120,121,126,127,132],{},"Here is a link to ",[74,122,125],{"href":123,"rel":124},"https://www.tldraw.com/f/cTRjZahSxPYiXwM6Ws3yH?d=v10977.-651.19434.9393.page",[78],"1000 notes on tldraw"," (and the ",[74,128,131],{"href":129,"rel":130},"https://www.tldraw.com/f/mEG6km2LEfSaAn7TD-JOO?d=v16327.1343.6034.3497.page",[78],"blank version",") which seems well optimized so you can see it's not me with a bad implementation.",[134,135],"video",{":autoplay":136,":controls":136,":muted":136,"src":137},"true","/posts/infinite-canvas-tldraw-comparison.mp4",[70,139,140,141,144],{},"There's just like a very sluggish feeling, especially zooming. I suspect the culprit might be shadows because they seem to get turned on/off at the point zoom feels sluggish, but I don't think there's any way around that. The blank version is clearly faster so some of it is the text itself rendering when very zoomed out, but I tried different lod levels in DOM, and the zoom range where they change ",[103,142,143],{},"feels"," slow. Sometimes canvas also skips a frame at that point but it doesn't feel nearly as bad.",[95,146,148],{"id":147},"switching-to-pixijs","Switching to Pixi.js",[70,150,151,152,157],{},"Once I switched to ",[74,153,156],{"href":154,"rel":155},"https://pixijs.com/8.x/guides/getting-started/introduction",[78],"pixi.js",", I was way too tempted to properly test the limits and see how many notes I could get to render.",[70,159,160],{},"I setup some basic culling + lod states, and changed the layout structure (from flat to a tree) and got to around 50,000 notes before serious lagging, but I wanted to find the real limit. In part out of curiosity, in part to not attempt to load so many (users can limit what they load with a search filter).",[70,162,163],{},"Mind you, the 50,000 at that point was a bit of a lie because the notes weren't unique. I also made this mistake when I initially tweeted about reaching 100,000. See below for more details.",[95,165,167],{"id":166},"actual-usage-expectations","Actual Usage Expectations",[70,169,170],{},"From what I've researched and from the number of notes I have myself, I expect the average user to probably have ~1000-10,000 notes. As a maximum I can see maybe some power users will have 20-50,000.",[70,172,173],{},"I don't expect >50,000 notes, but it is possible, depending on how they organize them, that they might need to render more since notes can appear more than once in the structured tree.",[70,175,176],{},"I do not expect freeform mode to get nearly as big as notes must be added by hand.",[178,179,180,184,187,190,193,196,199,202],"md-emphasis-block",{},[95,181,183],{"id":182},"limits-reached","Limits Reached",[70,185,186],{},"I ended up reaching about 60,000 unique cards before there started to be some minor lag (still snappier than the DOM approach), and 90,000 unique cards before it started to feel too sluggish. I reached 100,000 a few times, but past 95,000 the page would occasionally crash as it finished generating all the text.",[70,188,189],{},"One can sacrifice a bit of LOD to reach smoother 100,000, but I didn't like it. I think it's best to just warn the user to use a filter past 60,000. If they want to risk it they can (on chrome the crashes sometimes required I restart the entire browser ğŸ’€).",[70,191,192],{},"Here's what 100,000 feels like, you can see it's starting to struggle:",[134,194],{":autoplay":136,":controls":136,":muted":136,"src":195},"/posts/inifite-canvas-100000.mp4",[70,197,198],{},"Here's 50,000 which feels super snappy (this was the thumb). 60,000 starts to occasionally skip a frame on zoom but still feels fast:",[134,200],{":autoplay":136,":controls":136,":muted":136,"src":201},"/posts/infinite-canvas-50000.mp4",[70,203,204,205,208,209,212],{},"I'm actually sure we could go ",[103,206,207],{},"further"," (see ",[74,210,211],{"href":211},"#pooling",") but I don't think the increase in code complexity is worth it.",[95,214,216],{"id":215},"avoiding-accidental-optimizations","Avoiding Accidental Optimizations",[70,218,219],{},"It's easy to accidentally get performance speedups from how one sets up the test scenario.",[70,221,222],{},"In this case initially I only had 1000 unique notes and initially they were just repeated to get 50,000/100,000. I started like this because generating 50,000 real random documents is currently still super slow, I can only do about 300 docs max at a time. This is because generating a note requires generating a random prosemirror document and this was tricky to even get working.",[70,224,225,226,229],{},"Now Pixi.js does caching internally to speed up scenerios with duplicate cards like this so I had to make adjustments to avoid all unreasonably performance optimizations and find the real number of ",[103,227,228],{},"unique"," notes I could render.",[70,231,232,233,236],{},"I say unreasonable because some repitition is expected in every day use. To control the uniqueness and take more ",[103,234,235],{},"reasonable"," advantage of pixi's internal caches (it has per word (temporary), and per text), I generated 170,000 unique \"words\" (they're just random characters/symbols) and replaced the card text with random slices from those words.",[70,238,239],{},"Why 170,000? This is about how many words are actively in use in the english language. They are distributed randomly here, unlike a realistic distribution where some words appear way more than others, but that just means real usage will be slightly faster.",[70,241,242],{},"Here's the code I used:",[244,245,246],"md-details",{},[247,248,253],"pre",{"className":249,"code":250,"language":251,"meta":252,"style":252},"language-ts shiki shiki-themes material-theme-lighter material-theme material-theme-palenight","import { faker } from \"@faker-js/faker\"\n\nexport const perfUtilsConfig = {\n    minWordLength: 3,\n    maxWordLength: 10,\n    uniqueWords: 170000,\n    uniqueNoteCount: 90000\n}\nconst seenWords = new Set\u003Cstring>()\nexport function createWords(count: number) {\n    const res = Array.from(\n        { length: count },\n        () => {\n            // i know faker has word generation, but I want random symbols included\n            let word = faker.string.sample({ min: perfUtilsConfig.minWordLength, max: perfUtilsConfig.maxWordLength })\n            while (seenWords.has(word)) {\n                word = faker.string.sample({ min: perfUtilsConfig.minWordLength, max: perfUtilsConfig.maxWordLength })\n            }\n            return word\n        }\n    ).join(\" \")\n    return res\n}\n// estimated number of english words in active use\nconst additionalText = createWords(perfUtilsConfig.uniqueWords)\nseenWords.clear()\n\nconst noteSlicePoints = Array.from({ length: perfUtilsConfig.uniqueNoteCount }).map(i => Math.floor(Math.random() * additionalText.length))\n// slice random bits from the text\nexport function generateText(max: number) {\n    const cut = noteSlicePoints[Math.floor(Math.random() * noteSlicePoints.length)]\n    const res = additionalText.slice(cut, cut + max)\n    return res\n}\n\n","ts","",[254,255,256,289,295,314,331,344,357,368,374,405,433,457,474,485,492,552,580,628,634,643,649,669,678,683,689,709,721,726,804,810,833,878,910,917],"code",{"__ignoreMap":252},[257,258,261,265,269,273,276,279,282,286],"span",{"class":259,"line":260},"line",1,[257,262,264],{"class":263},"s7zQu","import",[257,266,268],{"class":267},"sMK4o"," {",[257,270,272],{"class":271},"sTEyZ"," faker",[257,274,275],{"class":267}," }",[257,277,278],{"class":263}," from",[257,280,281],{"class":267}," \"",[257,283,285],{"class":284},"sfazB","@faker-js/faker",[257,287,288],{"class":267},"\"\n",[257,290,292],{"class":259,"line":291},2,[257,293,294],{"emptyLinePlaceholder":60},"\n",[257,296,298,301,305,308,311],{"class":259,"line":297},3,[257,299,300],{"class":263},"export",[257,302,304],{"class":303},"spNyl"," const",[257,306,307],{"class":271}," perfUtilsConfig ",[257,309,310],{"class":267},"=",[257,312,313],{"class":267}," {\n",[257,315,317,321,324,328],{"class":259,"line":316},4,[257,318,320],{"class":319},"swJcz","    minWordLength",[257,322,323],{"class":267},":",[257,325,327],{"class":326},"sbssI"," 3",[257,329,330],{"class":267},",\n",[257,332,334,337,339,342],{"class":259,"line":333},5,[257,335,336],{"class":319},"    maxWordLength",[257,338,323],{"class":267},[257,340,341],{"class":326}," 10",[257,343,330],{"class":267},[257,345,347,350,352,355],{"class":259,"line":346},6,[257,348,349],{"class":319},"    uniqueWords",[257,351,323],{"class":267},[257,353,354],{"class":326}," 170000",[257,356,330],{"class":267},[257,358,360,363,365],{"class":259,"line":359},7,[257,361,362],{"class":319},"    uniqueNoteCount",[257,364,323],{"class":267},[257,366,367],{"class":326}," 90000\n",[257,369,371],{"class":259,"line":370},8,[257,372,373],{"class":267},"}\n",[257,375,377,380,383,385,388,392,395,399,402],{"class":259,"line":376},9,[257,378,379],{"class":303},"const",[257,381,382],{"class":271}," seenWords ",[257,384,310],{"class":267},[257,386,387],{"class":267}," new",[257,389,391],{"class":390},"s2Zo4"," Set",[257,393,394],{"class":267},"\u003C",[257,396,398],{"class":397},"sBMFI","string",[257,400,401],{"class":267},">",[257,403,404],{"class":271},"()\n",[257,406,408,410,413,416,419,423,425,428,431],{"class":259,"line":407},10,[257,409,300],{"class":263},[257,411,412],{"class":303}," function",[257,414,415],{"class":390}," createWords",[257,417,418],{"class":267},"(",[257,420,422],{"class":421},"sHdIc","count",[257,424,323],{"class":267},[257,426,427],{"class":397}," number",[257,429,430],{"class":267},")",[257,432,313],{"class":267},[257,434,436,439,442,445,448,451,454],{"class":259,"line":435},11,[257,437,438],{"class":303},"    const",[257,440,441],{"class":271}," res",[257,443,444],{"class":267}," =",[257,446,447],{"class":271}," Array",[257,449,450],{"class":267},".",[257,452,453],{"class":390},"from",[257,455,456],{"class":319},"(\n",[257,458,460,463,466,468,471],{"class":259,"line":459},12,[257,461,462],{"class":267},"        {",[257,464,465],{"class":319}," length",[257,467,323],{"class":267},[257,469,470],{"class":271}," count",[257,472,473],{"class":267}," },\n",[257,475,477,480,483],{"class":259,"line":476},13,[257,478,479],{"class":267},"        ()",[257,481,482],{"class":303}," =>",[257,484,313],{"class":267},[257,486,488],{"class":259,"line":487},14,[257,489,491],{"class":490},"sHwdD","            // i know faker has word generation, but I want random symbols included\n",[257,493,495,498,501,503,505,507,509,511,514,516,519,522,524,527,529,532,535,538,540,542,544,547,549],{"class":259,"line":494},15,[257,496,497],{"class":303},"            let",[257,499,500],{"class":271}," word",[257,502,444],{"class":267},[257,504,272],{"class":271},[257,506,450],{"class":267},[257,508,398],{"class":271},[257,510,450],{"class":267},[257,512,513],{"class":390},"sample",[257,515,418],{"class":319},[257,517,518],{"class":267},"{",[257,520,521],{"class":319}," min",[257,523,323],{"class":267},[257,525,526],{"class":271}," perfUtilsConfig",[257,528,450],{"class":267},[257,530,531],{"class":271},"minWordLength",[257,533,534],{"class":267},",",[257,536,537],{"class":319}," max",[257,539,323],{"class":267},[257,541,526],{"class":271},[257,543,450],{"class":267},[257,545,546],{"class":271},"maxWordLength",[257,548,275],{"class":267},[257,550,551],{"class":319},")\n",[257,553,555,558,561,564,566,569,571,574,577],{"class":259,"line":554},16,[257,556,557],{"class":263},"            while",[257,559,560],{"class":319}," (",[257,562,563],{"class":271},"seenWords",[257,565,450],{"class":267},[257,567,568],{"class":390},"has",[257,570,418],{"class":319},[257,572,573],{"class":271},"word",[257,575,576],{"class":319},")) ",[257,578,579],{"class":267},"{\n",[257,581,583,586,588,590,592,594,596,598,600,602,604,606,608,610,612,614,616,618,620,622,624,626],{"class":259,"line":582},17,[257,584,585],{"class":271},"                word",[257,587,444],{"class":267},[257,589,272],{"class":271},[257,591,450],{"class":267},[257,593,398],{"class":271},[257,595,450],{"class":267},[257,597,513],{"class":390},[257,599,418],{"class":319},[257,601,518],{"class":267},[257,603,521],{"class":319},[257,605,323],{"class":267},[257,607,526],{"class":271},[257,609,450],{"class":267},[257,611,531],{"class":271},[257,613,534],{"class":267},[257,615,537],{"class":319},[257,617,323],{"class":267},[257,619,526],{"class":271},[257,621,450],{"class":267},[257,623,546],{"class":271},[257,625,275],{"class":267},[257,627,551],{"class":319},[257,629,631],{"class":259,"line":630},18,[257,632,633],{"class":267},"            }\n",[257,635,637,640],{"class":259,"line":636},19,[257,638,639],{"class":263},"            return",[257,641,642],{"class":271}," word\n",[257,644,646],{"class":259,"line":645},20,[257,647,648],{"class":267},"        }\n",[257,650,652,655,657,660,662,665,667],{"class":259,"line":651},21,[257,653,654],{"class":319},"    )",[257,656,450],{"class":267},[257,658,659],{"class":390},"join",[257,661,418],{"class":319},[257,663,664],{"class":267},"\"",[257,666,281],{"class":267},[257,668,551],{"class":319},[257,670,672,675],{"class":259,"line":671},22,[257,673,674],{"class":263},"    return",[257,676,677],{"class":271}," res\n",[257,679,681],{"class":259,"line":680},23,[257,682,373],{"class":267},[257,684,686],{"class":259,"line":685},24,[257,687,688],{"class":490},"// estimated number of english words in active use\n",[257,690,692,694,697,699,701,704,706],{"class":259,"line":691},25,[257,693,379],{"class":303},[257,695,696],{"class":271}," additionalText ",[257,698,310],{"class":267},[257,700,415],{"class":390},[257,702,703],{"class":271},"(perfUtilsConfig",[257,705,450],{"class":267},[257,707,708],{"class":271},"uniqueWords)\n",[257,710,712,714,716,719],{"class":259,"line":711},26,[257,713,563],{"class":271},[257,715,450],{"class":267},[257,717,718],{"class":390},"clear",[257,720,404],{"class":271},[257,722,724],{"class":259,"line":723},27,[257,725,294],{"emptyLinePlaceholder":60},[257,727,729,731,734,736,738,740,742,744,746,748,750,752,754,757,760,762,764,767,769,772,774,777,779,782,785,787,790,793,796,799,801],{"class":259,"line":728},28,[257,730,379],{"class":303},[257,732,733],{"class":271}," noteSlicePoints ",[257,735,310],{"class":267},[257,737,447],{"class":271},[257,739,450],{"class":267},[257,741,453],{"class":390},[257,743,418],{"class":271},[257,745,518],{"class":267},[257,747,465],{"class":319},[257,749,323],{"class":267},[257,751,526],{"class":271},[257,753,450],{"class":267},[257,755,756],{"class":271},"uniqueNoteCount ",[257,758,759],{"class":267},"}",[257,761,430],{"class":271},[257,763,450],{"class":267},[257,765,766],{"class":390},"map",[257,768,418],{"class":271},[257,770,771],{"class":421},"i",[257,773,482],{"class":303},[257,775,776],{"class":271}," Math",[257,778,450],{"class":267},[257,780,781],{"class":390},"floor",[257,783,784],{"class":271},"(Math",[257,786,450],{"class":267},[257,788,789],{"class":390},"random",[257,791,792],{"class":271},"() ",[257,794,795],{"class":267},"*",[257,797,798],{"class":271}," additionalText",[257,800,450],{"class":267},[257,802,803],{"class":271},"length))\n",[257,805,807],{"class":259,"line":806},29,[257,808,809],{"class":490},"// slice random bits from the text\n",[257,811,813,815,817,820,822,825,827,829,831],{"class":259,"line":812},30,[257,814,300],{"class":263},[257,816,412],{"class":303},[257,818,819],{"class":390}," generateText",[257,821,418],{"class":267},[257,823,824],{"class":421},"max",[257,826,323],{"class":267},[257,828,427],{"class":397},[257,830,430],{"class":267},[257,832,313],{"class":267},[257,834,836,838,841,843,846,849,852,854,856,858,860,862,864,866,868,870,872,875],{"class":259,"line":835},31,[257,837,438],{"class":303},[257,839,840],{"class":271}," cut",[257,842,444],{"class":267},[257,844,845],{"class":271}," noteSlicePoints",[257,847,848],{"class":319},"[",[257,850,851],{"class":271},"Math",[257,853,450],{"class":267},[257,855,781],{"class":390},[257,857,418],{"class":319},[257,859,851],{"class":271},[257,861,450],{"class":267},[257,863,789],{"class":390},[257,865,792],{"class":319},[257,867,795],{"class":267},[257,869,845],{"class":271},[257,871,450],{"class":267},[257,873,874],{"class":271},"length",[257,876,877],{"class":319},")]\n",[257,879,881,883,885,887,889,891,894,896,899,901,903,906,908],{"class":259,"line":880},32,[257,882,438],{"class":303},[257,884,441],{"class":271},[257,886,444],{"class":267},[257,888,798],{"class":271},[257,890,450],{"class":267},[257,892,893],{"class":390},"slice",[257,895,418],{"class":319},[257,897,898],{"class":271},"cut",[257,900,534],{"class":267},[257,902,840],{"class":271},[257,904,905],{"class":267}," +",[257,907,537],{"class":271},[257,909,551],{"class":319},[257,911,913,915],{"class":259,"line":912},33,[257,914,674],{"class":263},[257,916,677],{"class":271},[257,918,920],{"class":259,"line":919},34,[257,921,373],{"class":267},[70,923,924,925,928,929,932,933,936],{},"You will see in the top right of videos, in the debug details it sayse ",[254,926,927],{},"Uniqueness: [count]",", this is the number of unique cards generated. ",[254,930,931],{},"Card Count"," is the number of cards in the full tree. ",[254,934,935],{},"In View"," will show how many cards are actually in view.",[95,938,940],{"id":939},"optimizations","Optimizations",[942,943,945],"h3",{"id":944},"decoupled-reactive-lifecycle","Decoupled Reactive Lifecycle",[70,947,948],{},"The rendering loop is decoupled from vueâ€™s reactivity. Instead of immediately reacting to every state change, we set dirty flags and do the appropriate action on the next tick.",[70,950,951],{},"I used a class (I did not have a good experience trying to figure out pixi-vue unfortunately) so watchers created here must be properly cleaned up (vue is not automatically aware of them like it is in SFCs).",[244,953,954],{},[247,955,957],{"className":249,"code":956,"language":251,"meta":252,"style":252},"class PixiCanvas {\n    toDestroy = []\n    onMounted() {\n        let layoutDirty = true\n        this.toDestroy.push(watch(this.layout, () => {\n            layoutDirty = true\n        }).stop)\n        app.ticker.add(() => {\n            if (layoutDirty) {\n                // ...\n            }\n        })\n    }\n    \n    destroy() {\n        if (!this.initialized) throw new Error(\"Pixi not initialized, cannot destroy.\")\n        for (const item of this.toDestroy) {\n            item()\n        }\n        // textures should also be destroyed here\n        this.app.destroy()\n    }\n}\n",[254,958,959,969,979,989,1003,1038,1047,1061,1084,1099,1104,1108,1114,1119,1124,1133,1167,1191,1198,1202,1207,1221,1225],{"__ignoreMap":252},[257,960,961,964,967],{"class":259,"line":260},[257,962,963],{"class":303},"class",[257,965,966],{"class":397}," PixiCanvas",[257,968,313],{"class":267},[257,970,971,974,976],{"class":259,"line":291},[257,972,973],{"class":319},"    toDestroy",[257,975,444],{"class":267},[257,977,978],{"class":271}," []\n",[257,980,981,984,987],{"class":259,"line":297},[257,982,983],{"class":319},"    onMounted",[257,985,986],{"class":267},"()",[257,988,313],{"class":267},[257,990,991,994,997,999],{"class":259,"line":316},[257,992,993],{"class":303},"        let",[257,995,996],{"class":271}," layoutDirty",[257,998,444],{"class":267},[257,1000,1002],{"class":1001},"sfNiH"," true\n",[257,1004,1005,1008,1011,1013,1016,1018,1021,1023,1026,1029,1031,1034,1036],{"class":259,"line":333},[257,1006,1007],{"class":267},"        this.",[257,1009,1010],{"class":271},"toDestroy",[257,1012,450],{"class":267},[257,1014,1015],{"class":390},"push",[257,1017,418],{"class":319},[257,1019,1020],{"class":390},"watch",[257,1022,418],{"class":319},[257,1024,1025],{"class":267},"this.",[257,1027,1028],{"class":271},"layout",[257,1030,534],{"class":267},[257,1032,1033],{"class":267}," ()",[257,1035,482],{"class":303},[257,1037,313],{"class":267},[257,1039,1040,1043,1045],{"class":259,"line":346},[257,1041,1042],{"class":271},"            layoutDirty",[257,1044,444],{"class":267},[257,1046,1002],{"class":1001},[257,1048,1049,1052,1054,1056,1059],{"class":259,"line":359},[257,1050,1051],{"class":267},"        }",[257,1053,430],{"class":319},[257,1055,450],{"class":267},[257,1057,1058],{"class":271},"stop",[257,1060,551],{"class":319},[257,1062,1063,1066,1068,1071,1073,1076,1078,1080,1082],{"class":259,"line":370},[257,1064,1065],{"class":271},"        app",[257,1067,450],{"class":267},[257,1069,1070],{"class":271},"ticker",[257,1072,450],{"class":267},[257,1074,1075],{"class":390},"add",[257,1077,418],{"class":319},[257,1079,986],{"class":267},[257,1081,482],{"class":303},[257,1083,313],{"class":267},[257,1085,1086,1089,1091,1094,1097],{"class":259,"line":376},[257,1087,1088],{"class":263},"            if",[257,1090,560],{"class":319},[257,1092,1093],{"class":271},"layoutDirty",[257,1095,1096],{"class":319},") ",[257,1098,579],{"class":267},[257,1100,1101],{"class":259,"line":407},[257,1102,1103],{"class":490},"                // ...\n",[257,1105,1106],{"class":259,"line":435},[257,1107,633],{"class":267},[257,1109,1110,1112],{"class":259,"line":459},[257,1111,1051],{"class":267},[257,1113,551],{"class":319},[257,1115,1116],{"class":259,"line":476},[257,1117,1118],{"class":267},"    }\n",[257,1120,1121],{"class":259,"line":487},[257,1122,1123],{"class":271},"    \n",[257,1125,1126,1129,1131],{"class":259,"line":494},[257,1127,1128],{"class":319},"    destroy",[257,1130,986],{"class":267},[257,1132,313],{"class":267},[257,1134,1135,1138,1140,1143,1146,1148,1151,1153,1156,1158,1160,1163,1165],{"class":259,"line":554},[257,1136,1137],{"class":263},"        if",[257,1139,560],{"class":319},[257,1141,1142],{"class":267},"!this.",[257,1144,1145],{"class":271},"initialized",[257,1147,1096],{"class":319},[257,1149,1150],{"class":263},"throw",[257,1152,387],{"class":267},[257,1154,1155],{"class":390}," Error",[257,1157,418],{"class":319},[257,1159,664],{"class":267},[257,1161,1162],{"class":284},"Pixi not initialized, cannot destroy.",[257,1164,664],{"class":267},[257,1166,551],{"class":319},[257,1168,1169,1172,1174,1176,1179,1182,1185,1187,1189],{"class":259,"line":582},[257,1170,1171],{"class":263},"        for",[257,1173,560],{"class":319},[257,1175,379],{"class":303},[257,1177,1178],{"class":271}," item",[257,1180,1181],{"class":267}," of",[257,1183,1184],{"class":267}," this.",[257,1186,1010],{"class":271},[257,1188,1096],{"class":319},[257,1190,579],{"class":267},[257,1192,1193,1196],{"class":259,"line":630},[257,1194,1195],{"class":390},"            item",[257,1197,404],{"class":319},[257,1199,1200],{"class":259,"line":636},[257,1201,648],{"class":267},[257,1203,1204],{"class":259,"line":645},[257,1205,1206],{"class":490},"        // textures should also be destroyed here\n",[257,1208,1209,1211,1214,1216,1219],{"class":259,"line":651},[257,1210,1007],{"class":267},[257,1212,1213],{"class":271},"app",[257,1215,450],{"class":267},[257,1217,1218],{"class":390},"destroy",[257,1220,404],{"class":319},[257,1222,1223],{"class":259,"line":671},[257,1224,1118],{"class":267},[257,1226,1227],{"class":259,"line":680},[257,1228,373],{"class":267},[942,1230,1232],{"id":1231},"culling","Culling",[70,1234,1235],{},"Naive culling is not enough, checking thousands of notes is too expensive.",[1237,1238,1240],"h4",{"id":1239},"take-advantage-of-existing-structure","Take Advantage of Existing Structure",[70,1242,1243],{},"If your data is structured in any form of tree, take advantage of that even if it makes it harder to traverse/update the tree.",[70,1245,1246],{},"If a parent container is not visible, all children will be skipped making things way faster.",[70,1248,1249],{},"For the freeform mode, I plan to place them inside invisible containers/buckets to simulate this. The freeform layout will be saveable and we can cache the notes each bucket contains and we would only need to update this if a user moves a note.",[1237,1251,1253],{"id":1252},"use-a-custom-algorithm-if-needed","Use a Custom Algorithm If Needed",[70,1255,1256],{},"I used a custom algorithm for two reasons:",[70,1258,1259],{},"I already know how big the viewport will be before pixi loads. I can do the culling beforehand.",[70,1261,1262],{},"I know the constraints of my layout. Nested areas are always contained within their parent, and notes are always contained by their areas. We can make optimizations based on this. For example, if the viewport is inside an area, only that area needs to be checked. All other areas can be immediately skipped.",[70,1264,1265],{},"Pixi does not do this internally because children can exist outside of their parent bounds.",[942,1267,1269],{"id":1268},"manual-texture-baking","Manual Texture Baking",[70,1271,1272,1273,1276,1277,1280],{},"This example demonstrates how to manually instruct the renderer to bake any display object (like a ",[254,1274,1275],{},"Container"," or ",[254,1278,1279],{},"Graphics"," object) into a reusable texture. This is highly efficient as the complex object is drawn only once.",[244,1282,1283],{},[247,1284,1286],{"className":249,"code":1285,"language":251,"meta":252,"style":252},"// example for the full LOD card background\n\n// this is called once, then only again if the theme ref changes\ncreateTextures() {\n    // careful to give enough space if using shadows\n    const shadowPadding = 4 * 4\n    const container = new Container()\n\n    const shadowGraphic = new Graphics()\n        .roundRect(shadowPadding, shadowPadding, this.config.cardWidth, this.config.cardHeight, this.config.cardRounding)\n        .fill({\n            color: this.theme.value.note.shadow,\n            alpha: this.theme.value.note.shadowAlpha\n        })\n    shadowGraphic.filters = [new BlurFilter({ strength: 4, quality: 3, resolution: window.devicePixelRatio })]\n    container.addChild(shadowGraphic)\n\n    const cardGraphic = new Graphics()\n        .roundRect(shadowPadding, shadowPadding - 2, this.config.cardWidth, this.config.cardHeight, this.config.cardRounding)\n        .fill({ color: this.theme.value.note.bg })\n    container.addChild(cardGraphic)\n\n    this.cardFullTexture = this.app.renderer.generateTexture({\n        target: container,\n        frame: new Rectangle(0, 0, this.config.cardWidth + shadowPadding * 2, this.config.cardHeight + shadowPadding * 2)\n    })\n\n    // save the texture for later use\n    this.cardFullTexture = this.app.renderer.generateTexture({\n        target: container,\n        frame: new Rectangle(0, 0, this.config.cardWidth + shadowPadding * 2, this.config.cardHeight + shadowPadding * 2)\n    })\n}\n\n// later during the actual card creation:\nconst cardSprite = new Sprite(this.cardFullTexture)\n",[254,1287,1288,1293,1297,1302,1311,1316,1334,1350,1354,1370,1423,1434,1463,1487,1493,1553,1570,1574,1589,1641,1677,1692,1696,1724,1735,1795,1802,1806,1811,1835,1845,1901,1907,1911,1915,1921],{"__ignoreMap":252},[257,1289,1290],{"class":259,"line":260},[257,1291,1292],{"class":490},"// example for the full LOD card background\n",[257,1294,1295],{"class":259,"line":291},[257,1296,294],{"emptyLinePlaceholder":60},[257,1298,1299],{"class":259,"line":297},[257,1300,1301],{"class":490},"// this is called once, then only again if the theme ref changes\n",[257,1303,1304,1307,1309],{"class":259,"line":316},[257,1305,1306],{"class":390},"createTextures",[257,1308,792],{"class":271},[257,1310,579],{"class":267},[257,1312,1313],{"class":259,"line":333},[257,1314,1315],{"class":490},"    // careful to give enough space if using shadows\n",[257,1317,1318,1320,1323,1325,1328,1331],{"class":259,"line":346},[257,1319,438],{"class":303},[257,1321,1322],{"class":271}," shadowPadding",[257,1324,444],{"class":267},[257,1326,1327],{"class":326}," 4",[257,1329,1330],{"class":267}," *",[257,1332,1333],{"class":326}," 4\n",[257,1335,1336,1338,1341,1343,1345,1348],{"class":259,"line":359},[257,1337,438],{"class":303},[257,1339,1340],{"class":271}," container",[257,1342,444],{"class":267},[257,1344,387],{"class":267},[257,1346,1347],{"class":390}," Container",[257,1349,404],{"class":319},[257,1351,1352],{"class":259,"line":370},[257,1353,294],{"emptyLinePlaceholder":60},[257,1355,1356,1358,1361,1363,1365,1368],{"class":259,"line":376},[257,1357,438],{"class":303},[257,1359,1360],{"class":271}," shadowGraphic",[257,1362,444],{"class":267},[257,1364,387],{"class":267},[257,1366,1367],{"class":390}," Graphics",[257,1369,404],{"class":319},[257,1371,1372,1375,1378,1380,1383,1385,1387,1389,1391,1394,1396,1399,1401,1403,1405,1407,1410,1412,1414,1416,1418,1421],{"class":259,"line":407},[257,1373,1374],{"class":267},"        .",[257,1376,1377],{"class":390},"roundRect",[257,1379,418],{"class":319},[257,1381,1382],{"class":271},"shadowPadding",[257,1384,534],{"class":267},[257,1386,1322],{"class":271},[257,1388,534],{"class":267},[257,1390,1184],{"class":267},[257,1392,1393],{"class":271},"config",[257,1395,450],{"class":267},[257,1397,1398],{"class":271},"cardWidth",[257,1400,534],{"class":267},[257,1402,1184],{"class":267},[257,1404,1393],{"class":271},[257,1406,450],{"class":267},[257,1408,1409],{"class":271},"cardHeight",[257,1411,534],{"class":267},[257,1413,1184],{"class":267},[257,1415,1393],{"class":271},[257,1417,450],{"class":267},[257,1419,1420],{"class":271},"cardRounding",[257,1422,551],{"class":319},[257,1424,1425,1427,1430,1432],{"class":259,"line":435},[257,1426,1374],{"class":267},[257,1428,1429],{"class":390},"fill",[257,1431,418],{"class":319},[257,1433,579],{"class":267},[257,1435,1436,1439,1441,1443,1446,1448,1451,1453,1456,1458,1461],{"class":259,"line":459},[257,1437,1438],{"class":319},"            color",[257,1440,323],{"class":267},[257,1442,1184],{"class":267},[257,1444,1445],{"class":271},"theme",[257,1447,450],{"class":267},[257,1449,1450],{"class":271},"value",[257,1452,450],{"class":267},[257,1454,1455],{"class":271},"note",[257,1457,450],{"class":267},[257,1459,1460],{"class":271},"shadow",[257,1462,330],{"class":267},[257,1464,1465,1468,1470,1472,1474,1476,1478,1480,1482,1484],{"class":259,"line":476},[257,1466,1467],{"class":319},"            alpha",[257,1469,323],{"class":267},[257,1471,1184],{"class":267},[257,1473,1445],{"class":271},[257,1475,450],{"class":267},[257,1477,1450],{"class":271},[257,1479,450],{"class":267},[257,1481,1455],{"class":271},[257,1483,450],{"class":267},[257,1485,1486],{"class":271},"shadowAlpha\n",[257,1488,1489,1491],{"class":259,"line":487},[257,1490,1051],{"class":267},[257,1492,551],{"class":319},[257,1494,1495,1498,1500,1503,1505,1508,1511,1514,1516,1518,1521,1523,1525,1527,1530,1532,1534,1536,1539,1541,1544,1546,1549,1551],{"class":259,"line":494},[257,1496,1497],{"class":271},"    shadowGraphic",[257,1499,450],{"class":267},[257,1501,1502],{"class":271},"filters",[257,1504,444],{"class":267},[257,1506,1507],{"class":319}," [",[257,1509,1510],{"class":267},"new",[257,1512,1513],{"class":390}," BlurFilter",[257,1515,418],{"class":319},[257,1517,518],{"class":267},[257,1519,1520],{"class":319}," strength",[257,1522,323],{"class":267},[257,1524,1327],{"class":326},[257,1526,534],{"class":267},[257,1528,1529],{"class":319}," quality",[257,1531,323],{"class":267},[257,1533,327],{"class":326},[257,1535,534],{"class":267},[257,1537,1538],{"class":319}," resolution",[257,1540,323],{"class":267},[257,1542,1543],{"class":271}," window",[257,1545,450],{"class":267},[257,1547,1548],{"class":271},"devicePixelRatio",[257,1550,275],{"class":267},[257,1552,877],{"class":319},[257,1554,1555,1558,1560,1563,1565,1568],{"class":259,"line":554},[257,1556,1557],{"class":271},"    container",[257,1559,450],{"class":267},[257,1561,1562],{"class":390},"addChild",[257,1564,418],{"class":319},[257,1566,1567],{"class":271},"shadowGraphic",[257,1569,551],{"class":319},[257,1571,1572],{"class":259,"line":582},[257,1573,294],{"emptyLinePlaceholder":60},[257,1575,1576,1578,1581,1583,1585,1587],{"class":259,"line":630},[257,1577,438],{"class":303},[257,1579,1580],{"class":271}," cardGraphic",[257,1582,444],{"class":267},[257,1584,387],{"class":267},[257,1586,1367],{"class":390},[257,1588,404],{"class":319},[257,1590,1591,1593,1595,1597,1599,1601,1603,1606,1609,1611,1613,1615,1617,1619,1621,1623,1625,1627,1629,1631,1633,1635,1637,1639],{"class":259,"line":636},[257,1592,1374],{"class":267},[257,1594,1377],{"class":390},[257,1596,418],{"class":319},[257,1598,1382],{"class":271},[257,1600,534],{"class":267},[257,1602,1322],{"class":271},[257,1604,1605],{"class":267}," -",[257,1607,1608],{"class":326}," 2",[257,1610,534],{"class":267},[257,1612,1184],{"class":267},[257,1614,1393],{"class":271},[257,1616,450],{"class":267},[257,1618,1398],{"class":271},[257,1620,534],{"class":267},[257,1622,1184],{"class":267},[257,1624,1393],{"class":271},[257,1626,450],{"class":267},[257,1628,1409],{"class":271},[257,1630,534],{"class":267},[257,1632,1184],{"class":267},[257,1634,1393],{"class":271},[257,1636,450],{"class":267},[257,1638,1420],{"class":271},[257,1640,551],{"class":319},[257,1642,1643,1645,1647,1649,1651,1654,1656,1658,1660,1662,1664,1666,1668,1670,1673,1675],{"class":259,"line":645},[257,1644,1374],{"class":267},[257,1646,1429],{"class":390},[257,1648,418],{"class":319},[257,1650,518],{"class":267},[257,1652,1653],{"class":319}," color",[257,1655,323],{"class":267},[257,1657,1184],{"class":267},[257,1659,1445],{"class":271},[257,1661,450],{"class":267},[257,1663,1450],{"class":271},[257,1665,450],{"class":267},[257,1667,1455],{"class":271},[257,1669,450],{"class":267},[257,1671,1672],{"class":271},"bg",[257,1674,275],{"class":267},[257,1676,551],{"class":319},[257,1678,1679,1681,1683,1685,1687,1690],{"class":259,"line":651},[257,1680,1557],{"class":271},[257,1682,450],{"class":267},[257,1684,1562],{"class":390},[257,1686,418],{"class":319},[257,1688,1689],{"class":271},"cardGraphic",[257,1691,551],{"class":319},[257,1693,1694],{"class":259,"line":671},[257,1695,294],{"emptyLinePlaceholder":60},[257,1697,1698,1701,1704,1706,1708,1710,1712,1715,1717,1720,1722],{"class":259,"line":680},[257,1699,1700],{"class":267},"    this.",[257,1702,1703],{"class":271},"cardFullTexture",[257,1705,444],{"class":267},[257,1707,1184],{"class":267},[257,1709,1213],{"class":271},[257,1711,450],{"class":267},[257,1713,1714],{"class":271},"renderer",[257,1716,450],{"class":267},[257,1718,1719],{"class":390},"generateTexture",[257,1721,418],{"class":319},[257,1723,579],{"class":267},[257,1725,1726,1729,1731,1733],{"class":259,"line":685},[257,1727,1728],{"class":319},"        target",[257,1730,323],{"class":267},[257,1732,1340],{"class":271},[257,1734,330],{"class":267},[257,1736,1737,1740,1742,1744,1747,1749,1752,1754,1757,1759,1761,1763,1765,1767,1769,1771,1773,1775,1777,1779,1781,1783,1785,1787,1789,1791,1793],{"class":259,"line":691},[257,1738,1739],{"class":319},"        frame",[257,1741,323],{"class":267},[257,1743,387],{"class":267},[257,1745,1746],{"class":390}," Rectangle",[257,1748,418],{"class":319},[257,1750,1751],{"class":326},"0",[257,1753,534],{"class":267},[257,1755,1756],{"class":326}," 0",[257,1758,534],{"class":267},[257,1760,1184],{"class":267},[257,1762,1393],{"class":271},[257,1764,450],{"class":267},[257,1766,1398],{"class":271},[257,1768,905],{"class":267},[257,1770,1322],{"class":271},[257,1772,1330],{"class":267},[257,1774,1608],{"class":326},[257,1776,534],{"class":267},[257,1778,1184],{"class":267},[257,1780,1393],{"class":271},[257,1782,450],{"class":267},[257,1784,1409],{"class":271},[257,1786,905],{"class":267},[257,1788,1322],{"class":271},[257,1790,1330],{"class":267},[257,1792,1608],{"class":326},[257,1794,551],{"class":319},[257,1796,1797,1800],{"class":259,"line":711},[257,1798,1799],{"class":267},"    }",[257,1801,551],{"class":319},[257,1803,1804],{"class":259,"line":723},[257,1805,294],{"emptyLinePlaceholder":60},[257,1807,1808],{"class":259,"line":728},[257,1809,1810],{"class":490},"    // save the texture for later use\n",[257,1812,1813,1815,1817,1819,1821,1823,1825,1827,1829,1831,1833],{"class":259,"line":806},[257,1814,1700],{"class":267},[257,1816,1703],{"class":271},[257,1818,444],{"class":267},[257,1820,1184],{"class":267},[257,1822,1213],{"class":271},[257,1824,450],{"class":267},[257,1826,1714],{"class":271},[257,1828,450],{"class":267},[257,1830,1719],{"class":390},[257,1832,418],{"class":319},[257,1834,579],{"class":267},[257,1836,1837,1839,1841,1843],{"class":259,"line":812},[257,1838,1728],{"class":319},[257,1840,323],{"class":267},[257,1842,1340],{"class":271},[257,1844,330],{"class":267},[257,1846,1847,1849,1851,1853,1855,1857,1859,1861,1863,1865,1867,1869,1871,1873,1875,1877,1879,1881,1883,1885,1887,1889,1891,1893,1895,1897,1899],{"class":259,"line":835},[257,1848,1739],{"class":319},[257,1850,323],{"class":267},[257,1852,387],{"class":267},[257,1854,1746],{"class":390},[257,1856,418],{"class":319},[257,1858,1751],{"class":326},[257,1860,534],{"class":267},[257,1862,1756],{"class":326},[257,1864,534],{"class":267},[257,1866,1184],{"class":267},[257,1868,1393],{"class":271},[257,1870,450],{"class":267},[257,1872,1398],{"class":271},[257,1874,905],{"class":267},[257,1876,1322],{"class":271},[257,1878,1330],{"class":267},[257,1880,1608],{"class":326},[257,1882,534],{"class":267},[257,1884,1184],{"class":267},[257,1886,1393],{"class":271},[257,1888,450],{"class":267},[257,1890,1409],{"class":271},[257,1892,905],{"class":267},[257,1894,1322],{"class":271},[257,1896,1330],{"class":267},[257,1898,1608],{"class":326},[257,1900,551],{"class":319},[257,1902,1903,1905],{"class":259,"line":880},[257,1904,1799],{"class":267},[257,1906,551],{"class":319},[257,1908,1909],{"class":259,"line":912},[257,1910,373],{"class":267},[257,1912,1913],{"class":259,"line":919},[257,1914,294],{"emptyLinePlaceholder":60},[257,1916,1918],{"class":259,"line":1917},35,[257,1919,1920],{"class":490},"// later during the actual card creation:\n",[257,1922,1924,1926,1929,1931,1933,1936,1938,1940],{"class":259,"line":1923},36,[257,1925,379],{"class":303},[257,1927,1928],{"class":271}," cardSprite ",[257,1930,310],{"class":267},[257,1932,387],{"class":267},[257,1934,1935],{"class":390}," Sprite",[257,1937,418],{"class":271},[257,1939,1025],{"class":267},[257,1941,1942],{"class":271},"cardFullTexture)\n",[70,1944,1945,1946,450],{},"Do NOT attempt to cache the full card, only the background, see ",[74,1947,1948],{"href":1948},"#avoid",[70,1950,1951],{},"This is a bit more complicated for images. I have not added attachments yet, so that will be a problem for later.",[942,1953,1955],{"id":1954},"dynamic-level-of-detail-lod","Dynamic Level of Detail (LOD)",[70,1957,1958,1959,1962],{},"At full zoom cards show their titles and a short summary. Both require text wrapping and truncation which is ",[103,1960,1961],{},"very"," expensive.",[70,1964,1965],{},"Past a certain zoom point cards become unreadable so thereâ€™s no point trying to render the text which is very expensive. We can just a simple skeleton, no text. And past that we have two options:",[85,1967,1968,1971],{},[88,1969,1970],{},"If the app has some other large features we can visualize (in this case cards exist bounding areas in \"structured\" mode), we can render those instead.",[88,1972,1973],{},"We can render a very small single color rectangle. Again, we can cache this. This is slower than rendering some larger feature, so avoid at all costs.",[70,1975,1976],{},"Using this strategy we can fit roughly 10,000 skeleton cards in view or 1000 full-view cards.",[70,1978,1979,1980,1983,1984,1987],{},"This with the full card zoom cut off point being ",[103,1981,1982],{},"past"," the point that I canâ€™t read it on a 4k screen (with the canvas resolution set to ",[254,1985,1986],{},"window.devicePixelRatio",") which is the worst case scenario.",[70,1989,1990],{},"So the cutoff could be increased. It wouldn't look as nice though because even when we can't read the text, we can still get a sense of which note is which. Another option is to only hide the summary initially and only later the text.",[70,1992,1993],{},"In all cases, I will be adding a show-on-hover feature so users can quickly read any card they're hovering over.",[942,1995,1997],{"id":1996},"using-bitmap-text","Using Bitmap Text",[70,1999,2000,2001,2007],{},"As Pixi themselves suggest, use BitmapText instead of Text. ",[103,2002,2003],{},[2004,2005,2006],"strong",{},"This is absolutely vital past around 50,000 cards."," It now supports word wrapping and it's easy to generate from a font, so it should suffice for most needs.",[70,2009,2010],{},"The only drawback is it's more expensive for languages with a lot of symbols (like chinese). I did a quick tests though and did not see much of a difference. Canvas still felt smooth enough and memory did not jump excessively. So good signs.",[942,2012,2014],{"id":2013},"loading-and-on-demand-text-generation","Loading and On-Demand Text Generation",[70,2016,2017],{},"If we tried to naively load and naively truncate (see below) the text of 100,000 cards on load it would take nearly 30 seconds with all optimizations.",[70,2019,2020],{},"Instead, on load, the card layout is created without any text. When the user zooms we generate the text on demand only when they need the full text LOD.",[70,2022,2023],{},"The generation is limited per so we donâ€™t attempt to create the text for 1000 cards all at once.",[70,2025,2026,2027,2030],{},"We check how much time we have left and hand that ms budge over to ",[254,2028,2029],{},"generateCardText"," which will handle not exceeding it.",[70,2032,2033,2034,2037],{},"Batching like this also helps give the user a visual indication that cards ",[103,2035,2036],{},"are"," getting loaded.",[70,2039,2040],{},"Full example combined with idle generation below.",[942,2042,2044],{"id":2043},"background-idle-generation","Background Idle Generation",[70,2046,2047,2048,2051],{},"The canvas loads zoomed out. This gives us some time, between load, and the user zooming/panning to where they want. We can use ",[254,2049,2050],{},"requestIdleCallback"," to start generating the card text regardless of visibility. This means for most users (less than \u003C 10000 cards which take 3 seconds to load) they probably wonâ€™t even see the text get generated, itâ€™ll just be there.",[70,2053,2054],{},"Here's the code combining the on demand generation with the idle generation.",[244,2056,2057],{},[247,2058,2060],{"className":249,"code":2059,"language":251,"meta":252,"style":252},"onMounted() {\n    // ... initial setup\n\n    // visibilityDirty and docsDirty are set by vue watchers\n\n    app.ticker.add(() => {\n\n        this.updateLodState() // calculates the lod state\n        const canGenerateText = !firstTick && this.lodState.value === \"full\" && this.pendingTextGeneration.size > 0\n        const start =  canGenerateText ? performance.now() : undefined\n\n        if (visibilityDirty) {\n            visibilityDirty = false\n            this.updateQueuesAndCulling()\n        }\n        if (docsDirty) {\n            docsDirty = false\n            this.updateTree()\n            this.initBackgroundQueue()\n            this.scheduleTextGeneration()\n        }\n\n        if (canGenerateText) {\n            const now = performance.now()\n            // budget is a little lower than the real 16ms just in case\n            const budget = 13 - (now - start!)\n            this.generateCardText(this.pendingTextGeneration, \"visible\", { startTime: now, budget })\n        }\n    })\n}\n\n\n// we combine these actions because they both happen together and need to both iterate through the same data\nupdateQueuesAndCulling() {\n    const { visibleNotes, visibleAreas } = this.visible.value\n\n    this.updateVisibleAreas(visibleAreas)\n\n    const showFullText = this.lodState.value === \"full\"\n    const cardLodVisible = this.lodState.value !== \"noCards\"\n\n    for (const [path, card] of this.noteSprites) {\n        const isVisible = visibleNotes.has(path)\n        const titleText = card.getChildByLabel(\"title-text\") as Text\n        const textAlreadyGenerated = titleText.text !== \"\"\n\n        card.visible = isVisible && cardLodVisible\n\n        if (!textAlreadyGenerated) {\n            if (isVisible && showFullText) {\n                this.backgroundPendingTextGeneration.delete(card)\n                this.pendingTextGeneration.add(card)\n            } else {\n                this.pendingTextGeneration.delete(card)\n                this.backgroundPendingTextGeneration.add(card)\n            }\n        } else {\n            this.pendingTextGeneration.delete(card)\n            this.backgroundPendingTextGeneration.delete(card)\n        }\n    }\n\n    const cards = visibleNotes.keys()\n        .map(path => this.noteSprites.get(path)!).filter(_ => !!_)\n    this.updateCardsLodState(cards)\n}\n\n\n// initially, queue up all cards that don't have text yet\ninitBackgroundQueue() {\n    for (const card of allNoteSprites) {\n        if (card.text === \"\") {\n            backgroundPendingTextGeneration.add(card);\n        }\n    }\n}\n\n// create the function that actually schedules the work\nscheduleTextGeneration() {\n    if (this.backgroundPendingTextGeneration.size > 0 && this.idleCallbackId === null) {\n        this.idleCallbackId = requestIdleCallback((deadline) => {\n            this.idleCallbackId = null\n            this.generateCardText(this.backgroundPendingTextGeneration, \"background\", { deadline })\n            this.scheduleTextGeneration()\n        })\n    } else if (this.backgroundPendingTextGeneration.size === 0) {\n        // generation finished\n    }\n}\n\n/** Generate text for cards from a pending queue with a deadline or a time budget. */\ngenerateCardText(\n    pending: Set\u003CContainer>,\n    type: \"visible\" | \"background\",\n    {\n        deadline,\n        budget,\n        startTime\n    }: {\n        deadline?: IdleDeadline\n        startTime?: number\n        budget?: number\n    } = {}\n) {\n    \n    if (pending.size === 0) return\n\n    // the 1 is the aproximate time the truncation takes\n    if (budget !== undefined && budget \u003C= 1) return\n\n    const isVisible = type === \"visible\"\n\n    const iterator = pending.values()\n    let generated = 0\n\n    while (pending.size > 0) {\n        if (budget !== undefined && isVisible && (performance.now() - startTime!) >= budget - 1) {\n            break\n        }\n        if (deadline && deadline.timeRemaining() \u003C= 1) {\n            break\n        }\n        const next = iterator.next()\n        if (next.done) break\n\n        const card = next.value as Container\n\n        pending.delete(card)\n\n        if (type === \"visible\") {\n            this.backgroundPendingTextGeneration.delete(card)\n            // skip if card became invisible or LOD changed\n            if (!card.visible || this.lodState.value !== \"full\") {\n                continue\n            }\n        } else if (type === \"background\" && this.pendingTextGeneration.has(card)) {\n            continue\n        }\n\n        const titleText = card.getChildByLabel(\"title-text\") as Text\n        // const summaryText = ...\n        const doc = this.getDoc(card.label)\n        // doc might have been deleted by the time we get here\n        if (!doc) continue\n\n        generated++\n\n        titleText.text = PixiCanvas.truncatePixiText( doc.title, /* ... */)\n        // summaryText.text = PixiCanvas.truncatePixiText( ... )\n\n        if (card.visible && this.lodState.value === \"full\") {\n            // set visibility of elements\n        }\n    }\n}\n",[254,2061,2062,2071,2076,2080,2085,2089,2110,2114,2126,2182,2212,2216,2229,2239,2249,2253,2266,2275,2284,2293,2302,2306,2310,2323,2341,2346,2373,2413,2417,2423,2427,2431,2435,2440,2448,2475,2479,2494,2499,2525,2553,2558,2592,2614,2648,2670,2675,2694,2699,2715,2733,2754,2771,2782,2799,2816,2821,2830,2847,2864,2869,2874,2879,2898,2949,2964,2969,2974,2979,2985,2994,3014,3036,3055,3060,3065,3070,3075,3081,3090,3126,3151,3163,3196,3205,3212,3240,3246,3251,3256,3261,3267,3274,3287,3310,3316,3324,3332,3338,3348,3359,3371,3380,3390,3397,3402,3425,3430,3436,3465,3470,3490,3495,3515,3528,3533,3555,3607,3613,3618,3647,3652,3657,3676,3695,3700,3721,3726,3742,3747,3769,3786,3792,3830,3836,3841,3880,3886,3891,3896,3925,3931,3957,3963,3980,3985,3994,3999,4035,4041,4046,4081,4087,4092,4097],{"__ignoreMap":252},[257,2063,2064,2067,2069],{"class":259,"line":260},[257,2065,2066],{"class":390},"onMounted",[257,2068,792],{"class":271},[257,2070,579],{"class":267},[257,2072,2073],{"class":259,"line":291},[257,2074,2075],{"class":490},"    // ... initial setup\n",[257,2077,2078],{"class":259,"line":297},[257,2079,294],{"emptyLinePlaceholder":60},[257,2081,2082],{"class":259,"line":316},[257,2083,2084],{"class":490},"    // visibilityDirty and docsDirty are set by vue watchers\n",[257,2086,2087],{"class":259,"line":333},[257,2088,294],{"emptyLinePlaceholder":60},[257,2090,2091,2094,2096,2098,2100,2102,2104,2106,2108],{"class":259,"line":346},[257,2092,2093],{"class":271},"    app",[257,2095,450],{"class":267},[257,2097,1070],{"class":271},[257,2099,450],{"class":267},[257,2101,1075],{"class":390},[257,2103,418],{"class":319},[257,2105,986],{"class":267},[257,2107,482],{"class":303},[257,2109,313],{"class":267},[257,2111,2112],{"class":259,"line":359},[257,2113,294],{"emptyLinePlaceholder":60},[257,2115,2116,2118,2121,2123],{"class":259,"line":370},[257,2117,1007],{"class":267},[257,2119,2120],{"class":390},"updateLodState",[257,2122,792],{"class":319},[257,2124,2125],{"class":490},"// calculates the lod state\n",[257,2127,2128,2131,2134,2136,2139,2142,2145,2147,2150,2152,2154,2157,2159,2162,2164,2166,2168,2171,2173,2176,2179],{"class":259,"line":376},[257,2129,2130],{"class":303},"        const",[257,2132,2133],{"class":271}," canGenerateText",[257,2135,444],{"class":267},[257,2137,2138],{"class":267}," !",[257,2140,2141],{"class":271},"firstTick",[257,2143,2144],{"class":267}," &&",[257,2146,1184],{"class":267},[257,2148,2149],{"class":271},"lodState",[257,2151,450],{"class":267},[257,2153,1450],{"class":271},[257,2155,2156],{"class":267}," ===",[257,2158,281],{"class":267},[257,2160,2161],{"class":284},"full",[257,2163,664],{"class":267},[257,2165,2144],{"class":267},[257,2167,1184],{"class":267},[257,2169,2170],{"class":271},"pendingTextGeneration",[257,2172,450],{"class":267},[257,2174,2175],{"class":271},"size",[257,2177,2178],{"class":267}," >",[257,2180,2181],{"class":326}," 0\n",[257,2183,2184,2186,2189,2191,2194,2197,2200,2202,2205,2207,2209],{"class":259,"line":407},[257,2185,2130],{"class":303},[257,2187,2188],{"class":271}," start",[257,2190,444],{"class":267},[257,2192,2193],{"class":271},"  canGenerateText",[257,2195,2196],{"class":267}," ?",[257,2198,2199],{"class":271}," performance",[257,2201,450],{"class":267},[257,2203,2204],{"class":390},"now",[257,2206,792],{"class":319},[257,2208,323],{"class":267},[257,2210,2211],{"class":267}," undefined\n",[257,2213,2214],{"class":259,"line":435},[257,2215,294],{"emptyLinePlaceholder":60},[257,2217,2218,2220,2222,2225,2227],{"class":259,"line":459},[257,2219,1137],{"class":263},[257,2221,560],{"class":319},[257,2223,2224],{"class":271},"visibilityDirty",[257,2226,1096],{"class":319},[257,2228,579],{"class":267},[257,2230,2231,2234,2236],{"class":259,"line":476},[257,2232,2233],{"class":271},"            visibilityDirty",[257,2235,444],{"class":267},[257,2237,2238],{"class":1001}," false\n",[257,2240,2241,2244,2247],{"class":259,"line":487},[257,2242,2243],{"class":267},"            this.",[257,2245,2246],{"class":390},"updateQueuesAndCulling",[257,2248,404],{"class":319},[257,2250,2251],{"class":259,"line":494},[257,2252,648],{"class":267},[257,2254,2255,2257,2259,2262,2264],{"class":259,"line":554},[257,2256,1137],{"class":263},[257,2258,560],{"class":319},[257,2260,2261],{"class":271},"docsDirty",[257,2263,1096],{"class":319},[257,2265,579],{"class":267},[257,2267,2268,2271,2273],{"class":259,"line":582},[257,2269,2270],{"class":271},"            docsDirty",[257,2272,444],{"class":267},[257,2274,2238],{"class":1001},[257,2276,2277,2279,2282],{"class":259,"line":630},[257,2278,2243],{"class":267},[257,2280,2281],{"class":390},"updateTree",[257,2283,404],{"class":319},[257,2285,2286,2288,2291],{"class":259,"line":636},[257,2287,2243],{"class":267},[257,2289,2290],{"class":390},"initBackgroundQueue",[257,2292,404],{"class":319},[257,2294,2295,2297,2300],{"class":259,"line":645},[257,2296,2243],{"class":267},[257,2298,2299],{"class":390},"scheduleTextGeneration",[257,2301,404],{"class":319},[257,2303,2304],{"class":259,"line":651},[257,2305,648],{"class":267},[257,2307,2308],{"class":259,"line":671},[257,2309,294],{"emptyLinePlaceholder":60},[257,2311,2312,2314,2316,2319,2321],{"class":259,"line":680},[257,2313,1137],{"class":263},[257,2315,560],{"class":319},[257,2317,2318],{"class":271},"canGenerateText",[257,2320,1096],{"class":319},[257,2322,579],{"class":267},[257,2324,2325,2328,2331,2333,2335,2337,2339],{"class":259,"line":685},[257,2326,2327],{"class":303},"            const",[257,2329,2330],{"class":271}," now",[257,2332,444],{"class":267},[257,2334,2199],{"class":271},[257,2336,450],{"class":267},[257,2338,2204],{"class":390},[257,2340,404],{"class":319},[257,2342,2343],{"class":259,"line":691},[257,2344,2345],{"class":490},"            // budget is a little lower than the real 16ms just in case\n",[257,2347,2348,2350,2353,2355,2358,2360,2362,2364,2366,2368,2371],{"class":259,"line":711},[257,2349,2327],{"class":303},[257,2351,2352],{"class":271}," budget",[257,2354,444],{"class":267},[257,2356,2357],{"class":326}," 13",[257,2359,1605],{"class":267},[257,2361,560],{"class":319},[257,2363,2204],{"class":271},[257,2365,1605],{"class":267},[257,2367,2188],{"class":271},[257,2369,2370],{"class":267},"!",[257,2372,551],{"class":319},[257,2374,2375,2377,2379,2381,2383,2385,2387,2389,2392,2394,2396,2398,2401,2403,2405,2407,2409,2411],{"class":259,"line":723},[257,2376,2243],{"class":267},[257,2378,2029],{"class":390},[257,2380,418],{"class":319},[257,2382,1025],{"class":267},[257,2384,2170],{"class":271},[257,2386,534],{"class":267},[257,2388,281],{"class":267},[257,2390,2391],{"class":284},"visible",[257,2393,664],{"class":267},[257,2395,534],{"class":267},[257,2397,268],{"class":267},[257,2399,2400],{"class":319}," startTime",[257,2402,323],{"class":267},[257,2404,2330],{"class":271},[257,2406,534],{"class":267},[257,2408,2352],{"class":271},[257,2410,275],{"class":267},[257,2412,551],{"class":319},[257,2414,2415],{"class":259,"line":728},[257,2416,648],{"class":267},[257,2418,2419,2421],{"class":259,"line":806},[257,2420,1799],{"class":267},[257,2422,551],{"class":319},[257,2424,2425],{"class":259,"line":812},[257,2426,373],{"class":267},[257,2428,2429],{"class":259,"line":835},[257,2430,294],{"emptyLinePlaceholder":60},[257,2432,2433],{"class":259,"line":880},[257,2434,294],{"emptyLinePlaceholder":60},[257,2436,2437],{"class":259,"line":912},[257,2438,2439],{"class":490},"// we combine these actions because they both happen together and need to both iterate through the same data\n",[257,2441,2442,2444,2446],{"class":259,"line":919},[257,2443,2246],{"class":390},[257,2445,792],{"class":271},[257,2447,579],{"class":267},[257,2449,2450,2452,2454,2457,2459,2462,2464,2466,2468,2470,2472],{"class":259,"line":1917},[257,2451,438],{"class":303},[257,2453,268],{"class":267},[257,2455,2456],{"class":271}," visibleNotes",[257,2458,534],{"class":267},[257,2460,2461],{"class":271}," visibleAreas",[257,2463,275],{"class":267},[257,2465,444],{"class":267},[257,2467,1184],{"class":267},[257,2469,2391],{"class":271},[257,2471,450],{"class":267},[257,2473,2474],{"class":271},"value\n",[257,2476,2477],{"class":259,"line":1923},[257,2478,294],{"emptyLinePlaceholder":60},[257,2480,2482,2484,2487,2489,2492],{"class":259,"line":2481},37,[257,2483,1700],{"class":267},[257,2485,2486],{"class":390},"updateVisibleAreas",[257,2488,418],{"class":319},[257,2490,2491],{"class":271},"visibleAreas",[257,2493,551],{"class":319},[257,2495,2497],{"class":259,"line":2496},38,[257,2498,294],{"emptyLinePlaceholder":60},[257,2500,2502,2504,2507,2509,2511,2513,2515,2517,2519,2521,2523],{"class":259,"line":2501},39,[257,2503,438],{"class":303},[257,2505,2506],{"class":271}," showFullText",[257,2508,444],{"class":267},[257,2510,1184],{"class":267},[257,2512,2149],{"class":271},[257,2514,450],{"class":267},[257,2516,1450],{"class":271},[257,2518,2156],{"class":267},[257,2520,281],{"class":267},[257,2522,2161],{"class":284},[257,2524,288],{"class":267},[257,2526,2528,2530,2533,2535,2537,2539,2541,2543,2546,2548,2551],{"class":259,"line":2527},40,[257,2529,438],{"class":303},[257,2531,2532],{"class":271}," cardLodVisible",[257,2534,444],{"class":267},[257,2536,1184],{"class":267},[257,2538,2149],{"class":271},[257,2540,450],{"class":267},[257,2542,1450],{"class":271},[257,2544,2545],{"class":267}," !==",[257,2547,281],{"class":267},[257,2549,2550],{"class":284},"noCards",[257,2552,288],{"class":267},[257,2554,2556],{"class":259,"line":2555},41,[257,2557,294],{"emptyLinePlaceholder":60},[257,2559,2561,2564,2566,2568,2570,2573,2575,2578,2581,2583,2585,2588,2590],{"class":259,"line":2560},42,[257,2562,2563],{"class":263},"    for",[257,2565,560],{"class":319},[257,2567,379],{"class":303},[257,2569,1507],{"class":267},[257,2571,2572],{"class":271},"path",[257,2574,534],{"class":267},[257,2576,2577],{"class":271}," card",[257,2579,2580],{"class":267},"]",[257,2582,1181],{"class":267},[257,2584,1184],{"class":267},[257,2586,2587],{"class":271},"noteSprites",[257,2589,1096],{"class":319},[257,2591,579],{"class":267},[257,2593,2595,2597,2600,2602,2604,2606,2608,2610,2612],{"class":259,"line":2594},43,[257,2596,2130],{"class":303},[257,2598,2599],{"class":271}," isVisible",[257,2601,444],{"class":267},[257,2603,2456],{"class":271},[257,2605,450],{"class":267},[257,2607,568],{"class":390},[257,2609,418],{"class":319},[257,2611,2572],{"class":271},[257,2613,551],{"class":319},[257,2615,2617,2619,2622,2624,2626,2628,2631,2633,2635,2638,2640,2642,2645],{"class":259,"line":2616},44,[257,2618,2130],{"class":303},[257,2620,2621],{"class":271}," titleText",[257,2623,444],{"class":267},[257,2625,2577],{"class":271},[257,2627,450],{"class":267},[257,2629,2630],{"class":390},"getChildByLabel",[257,2632,418],{"class":319},[257,2634,664],{"class":267},[257,2636,2637],{"class":284},"title-text",[257,2639,664],{"class":267},[257,2641,1096],{"class":319},[257,2643,2644],{"class":263},"as",[257,2646,2647],{"class":397}," Text\n",[257,2649,2651,2653,2656,2658,2660,2662,2665,2667],{"class":259,"line":2650},45,[257,2652,2130],{"class":303},[257,2654,2655],{"class":271}," textAlreadyGenerated",[257,2657,444],{"class":267},[257,2659,2621],{"class":271},[257,2661,450],{"class":267},[257,2663,2664],{"class":271},"text",[257,2666,2545],{"class":267},[257,2668,2669],{"class":267}," \"\"\n",[257,2671,2673],{"class":259,"line":2672},46,[257,2674,294],{"emptyLinePlaceholder":60},[257,2676,2678,2681,2683,2685,2687,2689,2691],{"class":259,"line":2677},47,[257,2679,2680],{"class":271},"        card",[257,2682,450],{"class":267},[257,2684,2391],{"class":271},[257,2686,444],{"class":267},[257,2688,2599],{"class":271},[257,2690,2144],{"class":267},[257,2692,2693],{"class":271}," cardLodVisible\n",[257,2695,2697],{"class":259,"line":2696},48,[257,2698,294],{"emptyLinePlaceholder":60},[257,2700,2702,2704,2706,2708,2711,2713],{"class":259,"line":2701},49,[257,2703,1137],{"class":263},[257,2705,560],{"class":319},[257,2707,2370],{"class":267},[257,2709,2710],{"class":271},"textAlreadyGenerated",[257,2712,1096],{"class":319},[257,2714,579],{"class":267},[257,2716,2718,2720,2722,2725,2727,2729,2731],{"class":259,"line":2717},50,[257,2719,1088],{"class":263},[257,2721,560],{"class":319},[257,2723,2724],{"class":271},"isVisible",[257,2726,2144],{"class":267},[257,2728,2506],{"class":271},[257,2730,1096],{"class":319},[257,2732,579],{"class":267},[257,2734,2736,2739,2742,2744,2747,2749,2752],{"class":259,"line":2735},51,[257,2737,2738],{"class":267},"                this.",[257,2740,2741],{"class":271},"backgroundPendingTextGeneration",[257,2743,450],{"class":267},[257,2745,2746],{"class":390},"delete",[257,2748,418],{"class":319},[257,2750,2751],{"class":271},"card",[257,2753,551],{"class":319},[257,2755,2757,2759,2761,2763,2765,2767,2769],{"class":259,"line":2756},52,[257,2758,2738],{"class":267},[257,2760,2170],{"class":271},[257,2762,450],{"class":267},[257,2764,1075],{"class":390},[257,2766,418],{"class":319},[257,2768,2751],{"class":271},[257,2770,551],{"class":319},[257,2772,2774,2777,2780],{"class":259,"line":2773},53,[257,2775,2776],{"class":267},"            }",[257,2778,2779],{"class":263}," else",[257,2781,313],{"class":267},[257,2783,2785,2787,2789,2791,2793,2795,2797],{"class":259,"line":2784},54,[257,2786,2738],{"class":267},[257,2788,2170],{"class":271},[257,2790,450],{"class":267},[257,2792,2746],{"class":390},[257,2794,418],{"class":319},[257,2796,2751],{"class":271},[257,2798,551],{"class":319},[257,2800,2802,2804,2806,2808,2810,2812,2814],{"class":259,"line":2801},55,[257,2803,2738],{"class":267},[257,2805,2741],{"class":271},[257,2807,450],{"class":267},[257,2809,1075],{"class":390},[257,2811,418],{"class":319},[257,2813,2751],{"class":271},[257,2815,551],{"class":319},[257,2817,2819],{"class":259,"line":2818},56,[257,2820,633],{"class":267},[257,2822,2824,2826,2828],{"class":259,"line":2823},57,[257,2825,1051],{"class":267},[257,2827,2779],{"class":263},[257,2829,313],{"class":267},[257,2831,2833,2835,2837,2839,2841,2843,2845],{"class":259,"line":2832},58,[257,2834,2243],{"class":267},[257,2836,2170],{"class":271},[257,2838,450],{"class":267},[257,2840,2746],{"class":390},[257,2842,418],{"class":319},[257,2844,2751],{"class":271},[257,2846,551],{"class":319},[257,2848,2850,2852,2854,2856,2858,2860,2862],{"class":259,"line":2849},59,[257,2851,2243],{"class":267},[257,2853,2741],{"class":271},[257,2855,450],{"class":267},[257,2857,2746],{"class":390},[257,2859,418],{"class":319},[257,2861,2751],{"class":271},[257,2863,551],{"class":319},[257,2865,2867],{"class":259,"line":2866},60,[257,2868,648],{"class":267},[257,2870,2872],{"class":259,"line":2871},61,[257,2873,1118],{"class":267},[257,2875,2877],{"class":259,"line":2876},62,[257,2878,294],{"emptyLinePlaceholder":60},[257,2880,2882,2884,2887,2889,2891,2893,2896],{"class":259,"line":2881},63,[257,2883,438],{"class":303},[257,2885,2886],{"class":271}," cards",[257,2888,444],{"class":267},[257,2890,2456],{"class":271},[257,2892,450],{"class":267},[257,2894,2895],{"class":390},"keys",[257,2897,404],{"class":319},[257,2899,2901,2903,2905,2907,2909,2911,2913,2915,2917,2920,2922,2924,2926,2928,2930,2932,2935,2937,2940,2942,2945,2947],{"class":259,"line":2900},64,[257,2902,1374],{"class":267},[257,2904,766],{"class":390},[257,2906,418],{"class":319},[257,2908,2572],{"class":421},[257,2910,482],{"class":303},[257,2912,1184],{"class":267},[257,2914,2587],{"class":271},[257,2916,450],{"class":267},[257,2918,2919],{"class":390},"get",[257,2921,418],{"class":319},[257,2923,2572],{"class":271},[257,2925,430],{"class":319},[257,2927,2370],{"class":267},[257,2929,430],{"class":319},[257,2931,450],{"class":267},[257,2933,2934],{"class":390},"filter",[257,2936,418],{"class":319},[257,2938,2939],{"class":421},"_",[257,2941,482],{"class":303},[257,2943,2944],{"class":267}," !!",[257,2946,2939],{"class":271},[257,2948,551],{"class":319},[257,2950,2952,2954,2957,2959,2962],{"class":259,"line":2951},65,[257,2953,1700],{"class":267},[257,2955,2956],{"class":390},"updateCardsLodState",[257,2958,418],{"class":319},[257,2960,2961],{"class":271},"cards",[257,2963,551],{"class":319},[257,2965,2967],{"class":259,"line":2966},66,[257,2968,373],{"class":267},[257,2970,2972],{"class":259,"line":2971},67,[257,2973,294],{"emptyLinePlaceholder":60},[257,2975,2977],{"class":259,"line":2976},68,[257,2978,294],{"emptyLinePlaceholder":60},[257,2980,2982],{"class":259,"line":2981},69,[257,2983,2984],{"class":490},"// initially, queue up all cards that don't have text yet\n",[257,2986,2988,2990,2992],{"class":259,"line":2987},70,[257,2989,2290],{"class":390},[257,2991,792],{"class":271},[257,2993,579],{"class":267},[257,2995,2997,2999,3001,3003,3005,3007,3010,3012],{"class":259,"line":2996},71,[257,2998,2563],{"class":263},[257,3000,560],{"class":319},[257,3002,379],{"class":303},[257,3004,2577],{"class":271},[257,3006,1181],{"class":267},[257,3008,3009],{"class":271}," allNoteSprites",[257,3011,1096],{"class":319},[257,3013,579],{"class":267},[257,3015,3017,3019,3021,3023,3025,3027,3029,3032,3034],{"class":259,"line":3016},72,[257,3018,1137],{"class":263},[257,3020,560],{"class":319},[257,3022,2751],{"class":271},[257,3024,450],{"class":267},[257,3026,2664],{"class":271},[257,3028,2156],{"class":267},[257,3030,3031],{"class":267}," \"\"",[257,3033,1096],{"class":319},[257,3035,579],{"class":267},[257,3037,3039,3042,3044,3046,3048,3050,3052],{"class":259,"line":3038},73,[257,3040,3041],{"class":271},"            backgroundPendingTextGeneration",[257,3043,450],{"class":267},[257,3045,1075],{"class":390},[257,3047,418],{"class":319},[257,3049,2751],{"class":271},[257,3051,430],{"class":319},[257,3053,3054],{"class":267},";\n",[257,3056,3058],{"class":259,"line":3057},74,[257,3059,648],{"class":267},[257,3061,3063],{"class":259,"line":3062},75,[257,3064,1118],{"class":267},[257,3066,3068],{"class":259,"line":3067},76,[257,3069,373],{"class":267},[257,3071,3073],{"class":259,"line":3072},77,[257,3074,294],{"emptyLinePlaceholder":60},[257,3076,3078],{"class":259,"line":3077},78,[257,3079,3080],{"class":490},"// create the function that actually schedules the work\n",[257,3082,3084,3086,3088],{"class":259,"line":3083},79,[257,3085,2299],{"class":390},[257,3087,792],{"class":271},[257,3089,579],{"class":267},[257,3091,3093,3096,3098,3100,3102,3104,3106,3108,3110,3112,3114,3117,3119,3122,3124],{"class":259,"line":3092},80,[257,3094,3095],{"class":263},"    if",[257,3097,560],{"class":319},[257,3099,1025],{"class":267},[257,3101,2741],{"class":271},[257,3103,450],{"class":267},[257,3105,2175],{"class":271},[257,3107,2178],{"class":267},[257,3109,1756],{"class":326},[257,3111,2144],{"class":267},[257,3113,1184],{"class":267},[257,3115,3116],{"class":271},"idleCallbackId",[257,3118,2156],{"class":267},[257,3120,3121],{"class":267}," null",[257,3123,1096],{"class":319},[257,3125,579],{"class":267},[257,3127,3129,3131,3133,3135,3138,3140,3142,3145,3147,3149],{"class":259,"line":3128},81,[257,3130,1007],{"class":267},[257,3132,3116],{"class":271},[257,3134,444],{"class":267},[257,3136,3137],{"class":390}," requestIdleCallback",[257,3139,418],{"class":319},[257,3141,418],{"class":267},[257,3143,3144],{"class":421},"deadline",[257,3146,430],{"class":267},[257,3148,482],{"class":303},[257,3150,313],{"class":267},[257,3152,3154,3156,3158,3160],{"class":259,"line":3153},82,[257,3155,2243],{"class":267},[257,3157,3116],{"class":271},[257,3159,444],{"class":267},[257,3161,3162],{"class":267}," null\n",[257,3164,3166,3168,3170,3172,3174,3176,3178,3180,3183,3185,3187,3189,3192,3194],{"class":259,"line":3165},83,[257,3167,2243],{"class":267},[257,3169,2029],{"class":390},[257,3171,418],{"class":319},[257,3173,1025],{"class":267},[257,3175,2741],{"class":271},[257,3177,534],{"class":267},[257,3179,281],{"class":267},[257,3181,3182],{"class":284},"background",[257,3184,664],{"class":267},[257,3186,534],{"class":267},[257,3188,268],{"class":267},[257,3190,3191],{"class":271}," deadline",[257,3193,275],{"class":267},[257,3195,551],{"class":319},[257,3197,3199,3201,3203],{"class":259,"line":3198},84,[257,3200,2243],{"class":267},[257,3202,2299],{"class":390},[257,3204,404],{"class":319},[257,3206,3208,3210],{"class":259,"line":3207},85,[257,3209,1051],{"class":267},[257,3211,551],{"class":319},[257,3213,3215,3217,3219,3222,3224,3226,3228,3230,3232,3234,3236,3238],{"class":259,"line":3214},86,[257,3216,1799],{"class":267},[257,3218,2779],{"class":263},[257,3220,3221],{"class":263}," if",[257,3223,560],{"class":319},[257,3225,1025],{"class":267},[257,3227,2741],{"class":271},[257,3229,450],{"class":267},[257,3231,2175],{"class":271},[257,3233,2156],{"class":267},[257,3235,1756],{"class":326},[257,3237,1096],{"class":319},[257,3239,579],{"class":267},[257,3241,3243],{"class":259,"line":3242},87,[257,3244,3245],{"class":490},"        // generation finished\n",[257,3247,3249],{"class":259,"line":3248},88,[257,3250,1118],{"class":267},[257,3252,3254],{"class":259,"line":3253},89,[257,3255,373],{"class":267},[257,3257,3259],{"class":259,"line":3258},90,[257,3260,294],{"emptyLinePlaceholder":60},[257,3262,3264],{"class":259,"line":3263},91,[257,3265,3266],{"class":490},"/** Generate text for cards from a pending queue with a deadline or a time budget. */\n",[257,3268,3270,3272],{"class":259,"line":3269},92,[257,3271,2029],{"class":390},[257,3273,456],{"class":271},[257,3275,3277,3280,3282,3284],{"class":259,"line":3276},93,[257,3278,3279],{"class":271},"    pending: Set",[257,3281,394],{"class":267},[257,3283,1275],{"class":271},[257,3285,3286],{"class":267},">,\n",[257,3288,3290,3293,3295,3297,3299,3302,3304,3306,3308],{"class":259,"line":3289},94,[257,3291,3292],{"class":271},"    type: ",[257,3294,664],{"class":267},[257,3296,2391],{"class":284},[257,3298,664],{"class":267},[257,3300,3301],{"class":267}," |",[257,3303,281],{"class":267},[257,3305,3182],{"class":284},[257,3307,664],{"class":267},[257,3309,330],{"class":267},[257,3311,3313],{"class":259,"line":3312},95,[257,3314,3315],{"class":267},"    {\n",[257,3317,3319,3322],{"class":259,"line":3318},96,[257,3320,3321],{"class":271},"        deadline",[257,3323,330],{"class":267},[257,3325,3327,3330],{"class":259,"line":3326},97,[257,3328,3329],{"class":271},"        budget",[257,3331,330],{"class":267},[257,3333,3335],{"class":259,"line":3334},98,[257,3336,3337],{"class":271},"        startTime\n",[257,3339,3341,3343,3346],{"class":259,"line":3340},99,[257,3342,1799],{"class":267},[257,3344,3345],{"class":271},": ",[257,3347,579],{"class":267},[257,3349,3351,3354,3356],{"class":259,"line":3350},100,[257,3352,3353],{"class":271},"        deadline?",[257,3355,323],{"class":267},[257,3357,3358],{"class":271}," IdleDeadline\n",[257,3360,3362,3365,3368],{"class":259,"line":3361},101,[257,3363,3364],{"class":271},"        startTime",[257,3366,3367],{"class":267},"?:",[257,3369,3370],{"class":271}," number\n",[257,3372,3374,3376,3378],{"class":259,"line":3373},102,[257,3375,3329],{"class":271},[257,3377,3367],{"class":267},[257,3379,3370],{"class":271},[257,3381,3383,3385,3387],{"class":259,"line":3382},103,[257,3384,1799],{"class":267},[257,3386,444],{"class":267},[257,3388,3389],{"class":267}," {}\n",[257,3391,3393,3395],{"class":259,"line":3392},104,[257,3394,1096],{"class":271},[257,3396,579],{"class":267},[257,3398,3400],{"class":259,"line":3399},105,[257,3401,1123],{"class":319},[257,3403,3405,3407,3409,3412,3414,3416,3418,3420,3422],{"class":259,"line":3404},106,[257,3406,3095],{"class":263},[257,3408,560],{"class":319},[257,3410,3411],{"class":271},"pending",[257,3413,450],{"class":267},[257,3415,2175],{"class":271},[257,3417,2156],{"class":267},[257,3419,1756],{"class":326},[257,3421,1096],{"class":319},[257,3423,3424],{"class":263},"return\n",[257,3426,3428],{"class":259,"line":3427},107,[257,3429,294],{"emptyLinePlaceholder":60},[257,3431,3433],{"class":259,"line":3432},108,[257,3434,3435],{"class":490},"    // the 1 is the aproximate time the truncation takes\n",[257,3437,3439,3441,3443,3446,3448,3451,3453,3455,3458,3461,3463],{"class":259,"line":3438},109,[257,3440,3095],{"class":263},[257,3442,560],{"class":319},[257,3444,3445],{"class":271},"budget",[257,3447,2545],{"class":267},[257,3449,3450],{"class":267}," undefined",[257,3452,2144],{"class":267},[257,3454,2352],{"class":271},[257,3456,3457],{"class":267}," \u003C=",[257,3459,3460],{"class":326}," 1",[257,3462,1096],{"class":319},[257,3464,3424],{"class":263},[257,3466,3468],{"class":259,"line":3467},110,[257,3469,294],{"emptyLinePlaceholder":60},[257,3471,3473,3475,3477,3479,3482,3484,3486,3488],{"class":259,"line":3472},111,[257,3474,438],{"class":303},[257,3476,2599],{"class":271},[257,3478,444],{"class":267},[257,3480,3481],{"class":271}," type",[257,3483,2156],{"class":267},[257,3485,281],{"class":267},[257,3487,2391],{"class":284},[257,3489,288],{"class":267},[257,3491,3493],{"class":259,"line":3492},112,[257,3494,294],{"emptyLinePlaceholder":60},[257,3496,3498,3500,3503,3505,3508,3510,3513],{"class":259,"line":3497},113,[257,3499,438],{"class":303},[257,3501,3502],{"class":271}," iterator",[257,3504,444],{"class":267},[257,3506,3507],{"class":271}," pending",[257,3509,450],{"class":267},[257,3511,3512],{"class":390},"values",[257,3514,404],{"class":319},[257,3516,3518,3521,3524,3526],{"class":259,"line":3517},114,[257,3519,3520],{"class":303},"    let",[257,3522,3523],{"class":271}," generated",[257,3525,444],{"class":267},[257,3527,2181],{"class":326},[257,3529,3531],{"class":259,"line":3530},115,[257,3532,294],{"emptyLinePlaceholder":60},[257,3534,3536,3539,3541,3543,3545,3547,3549,3551,3553],{"class":259,"line":3535},116,[257,3537,3538],{"class":263},"    while",[257,3540,560],{"class":319},[257,3542,3411],{"class":271},[257,3544,450],{"class":267},[257,3546,2175],{"class":271},[257,3548,2178],{"class":267},[257,3550,1756],{"class":326},[257,3552,1096],{"class":319},[257,3554,579],{"class":267},[257,3556,3558,3560,3562,3564,3566,3568,3570,3572,3574,3576,3579,3581,3583,3585,3588,3590,3592,3594,3597,3599,3601,3603,3605],{"class":259,"line":3557},117,[257,3559,1137],{"class":263},[257,3561,560],{"class":319},[257,3563,3445],{"class":271},[257,3565,2545],{"class":267},[257,3567,3450],{"class":267},[257,3569,2144],{"class":267},[257,3571,2599],{"class":271},[257,3573,2144],{"class":267},[257,3575,560],{"class":319},[257,3577,3578],{"class":271},"performance",[257,3580,450],{"class":267},[257,3582,2204],{"class":390},[257,3584,792],{"class":319},[257,3586,3587],{"class":267},"-",[257,3589,2400],{"class":271},[257,3591,2370],{"class":267},[257,3593,1096],{"class":319},[257,3595,3596],{"class":267},">=",[257,3598,2352],{"class":271},[257,3600,1605],{"class":267},[257,3602,3460],{"class":326},[257,3604,1096],{"class":319},[257,3606,579],{"class":267},[257,3608,3610],{"class":259,"line":3609},118,[257,3611,3612],{"class":263},"            break\n",[257,3614,3616],{"class":259,"line":3615},119,[257,3617,648],{"class":267},[257,3619,3621,3623,3625,3627,3629,3631,3633,3636,3638,3641,3643,3645],{"class":259,"line":3620},120,[257,3622,1137],{"class":263},[257,3624,560],{"class":319},[257,3626,3144],{"class":271},[257,3628,2144],{"class":267},[257,3630,3191],{"class":271},[257,3632,450],{"class":267},[257,3634,3635],{"class":390},"timeRemaining",[257,3637,792],{"class":319},[257,3639,3640],{"class":267},"\u003C=",[257,3642,3460],{"class":326},[257,3644,1096],{"class":319},[257,3646,579],{"class":267},[257,3648,3650],{"class":259,"line":3649},121,[257,3651,3612],{"class":263},[257,3653,3655],{"class":259,"line":3654},122,[257,3656,648],{"class":267},[257,3658,3660,3662,3665,3667,3669,3671,3674],{"class":259,"line":3659},123,[257,3661,2130],{"class":303},[257,3663,3664],{"class":271}," next",[257,3666,444],{"class":267},[257,3668,3502],{"class":271},[257,3670,450],{"class":267},[257,3672,3673],{"class":390},"next",[257,3675,404],{"class":319},[257,3677,3679,3681,3683,3685,3687,3690,3692],{"class":259,"line":3678},124,[257,3680,1137],{"class":263},[257,3682,560],{"class":319},[257,3684,3673],{"class":271},[257,3686,450],{"class":267},[257,3688,3689],{"class":271},"done",[257,3691,1096],{"class":319},[257,3693,3694],{"class":263},"break\n",[257,3696,3698],{"class":259,"line":3697},125,[257,3699,294],{"emptyLinePlaceholder":60},[257,3701,3703,3705,3707,3709,3711,3713,3715,3718],{"class":259,"line":3702},126,[257,3704,2130],{"class":303},[257,3706,2577],{"class":271},[257,3708,444],{"class":267},[257,3710,3664],{"class":271},[257,3712,450],{"class":267},[257,3714,1450],{"class":271},[257,3716,3717],{"class":263}," as",[257,3719,3720],{"class":397}," Container\n",[257,3722,3724],{"class":259,"line":3723},127,[257,3725,294],{"emptyLinePlaceholder":60},[257,3727,3729,3732,3734,3736,3738,3740],{"class":259,"line":3728},128,[257,3730,3731],{"class":271},"        pending",[257,3733,450],{"class":267},[257,3735,2746],{"class":390},[257,3737,418],{"class":319},[257,3739,2751],{"class":271},[257,3741,551],{"class":319},[257,3743,3745],{"class":259,"line":3744},129,[257,3746,294],{"emptyLinePlaceholder":60},[257,3748,3750,3752,3754,3757,3759,3761,3763,3765,3767],{"class":259,"line":3749},130,[257,3751,1137],{"class":263},[257,3753,560],{"class":319},[257,3755,3756],{"class":271},"type",[257,3758,2156],{"class":267},[257,3760,281],{"class":267},[257,3762,2391],{"class":284},[257,3764,664],{"class":267},[257,3766,1096],{"class":319},[257,3768,579],{"class":267},[257,3770,3772,3774,3776,3778,3780,3782,3784],{"class":259,"line":3771},131,[257,3773,2243],{"class":267},[257,3775,2741],{"class":271},[257,3777,450],{"class":267},[257,3779,2746],{"class":390},[257,3781,418],{"class":319},[257,3783,2751],{"class":271},[257,3785,551],{"class":319},[257,3787,3789],{"class":259,"line":3788},132,[257,3790,3791],{"class":490},"            // skip if card became invisible or LOD changed\n",[257,3793,3795,3797,3799,3801,3803,3805,3807,3810,3812,3814,3816,3818,3820,3822,3824,3826,3828],{"class":259,"line":3794},133,[257,3796,1088],{"class":263},[257,3798,560],{"class":319},[257,3800,2370],{"class":267},[257,3802,2751],{"class":271},[257,3804,450],{"class":267},[257,3806,2391],{"class":271},[257,3808,3809],{"class":267}," ||",[257,3811,1184],{"class":267},[257,3813,2149],{"class":271},[257,3815,450],{"class":267},[257,3817,1450],{"class":271},[257,3819,2545],{"class":267},[257,3821,281],{"class":267},[257,3823,2161],{"class":284},[257,3825,664],{"class":267},[257,3827,1096],{"class":319},[257,3829,579],{"class":267},[257,3831,3833],{"class":259,"line":3832},134,[257,3834,3835],{"class":263},"                continue\n",[257,3837,3839],{"class":259,"line":3838},135,[257,3840,633],{"class":267},[257,3842,3844,3846,3848,3850,3852,3854,3856,3858,3860,3862,3864,3866,3868,3870,3872,3874,3876,3878],{"class":259,"line":3843},136,[257,3845,1051],{"class":267},[257,3847,2779],{"class":263},[257,3849,3221],{"class":263},[257,3851,560],{"class":319},[257,3853,3756],{"class":271},[257,3855,2156],{"class":267},[257,3857,281],{"class":267},[257,3859,3182],{"class":284},[257,3861,664],{"class":267},[257,3863,2144],{"class":267},[257,3865,1184],{"class":267},[257,3867,2170],{"class":271},[257,3869,450],{"class":267},[257,3871,568],{"class":390},[257,3873,418],{"class":319},[257,3875,2751],{"class":271},[257,3877,576],{"class":319},[257,3879,579],{"class":267},[257,3881,3883],{"class":259,"line":3882},137,[257,3884,3885],{"class":263},"            continue\n",[257,3887,3889],{"class":259,"line":3888},138,[257,3890,648],{"class":267},[257,3892,3894],{"class":259,"line":3893},139,[257,3895,294],{"emptyLinePlaceholder":60},[257,3897,3899,3901,3903,3905,3907,3909,3911,3913,3915,3917,3919,3921,3923],{"class":259,"line":3898},140,[257,3900,2130],{"class":303},[257,3902,2621],{"class":271},[257,3904,444],{"class":267},[257,3906,2577],{"class":271},[257,3908,450],{"class":267},[257,3910,2630],{"class":390},[257,3912,418],{"class":319},[257,3914,664],{"class":267},[257,3916,2637],{"class":284},[257,3918,664],{"class":267},[257,3920,1096],{"class":319},[257,3922,2644],{"class":263},[257,3924,2647],{"class":397},[257,3926,3928],{"class":259,"line":3927},141,[257,3929,3930],{"class":490},"        // const summaryText = ...\n",[257,3932,3934,3936,3939,3941,3943,3946,3948,3950,3952,3955],{"class":259,"line":3933},142,[257,3935,2130],{"class":303},[257,3937,3938],{"class":271}," doc",[257,3940,444],{"class":267},[257,3942,1184],{"class":267},[257,3944,3945],{"class":390},"getDoc",[257,3947,418],{"class":319},[257,3949,2751],{"class":271},[257,3951,450],{"class":267},[257,3953,3954],{"class":271},"label",[257,3956,551],{"class":319},[257,3958,3960],{"class":259,"line":3959},143,[257,3961,3962],{"class":490},"        // doc might have been deleted by the time we get here\n",[257,3964,3966,3968,3970,3972,3975,3977],{"class":259,"line":3965},144,[257,3967,1137],{"class":263},[257,3969,560],{"class":319},[257,3971,2370],{"class":267},[257,3973,3974],{"class":271},"doc",[257,3976,1096],{"class":319},[257,3978,3979],{"class":263},"continue\n",[257,3981,3983],{"class":259,"line":3982},145,[257,3984,294],{"emptyLinePlaceholder":60},[257,3986,3988,3991],{"class":259,"line":3987},146,[257,3989,3990],{"class":271},"        generated",[257,3992,3993],{"class":267},"++\n",[257,3995,3997],{"class":259,"line":3996},147,[257,3998,294],{"emptyLinePlaceholder":60},[257,4000,4002,4005,4007,4009,4011,4013,4015,4018,4021,4023,4025,4028,4030,4033],{"class":259,"line":4001},148,[257,4003,4004],{"class":271},"        titleText",[257,4006,450],{"class":267},[257,4008,2664],{"class":271},[257,4010,444],{"class":267},[257,4012,966],{"class":271},[257,4014,450],{"class":267},[257,4016,4017],{"class":390},"truncatePixiText",[257,4019,4020],{"class":319},"( ",[257,4022,3974],{"class":271},[257,4024,450],{"class":267},[257,4026,4027],{"class":271},"title",[257,4029,534],{"class":267},[257,4031,4032],{"class":490}," /* ... */",[257,4034,551],{"class":319},[257,4036,4038],{"class":259,"line":4037},149,[257,4039,4040],{"class":490},"        // summaryText.text = PixiCanvas.truncatePixiText( ... )\n",[257,4042,4044],{"class":259,"line":4043},150,[257,4045,294],{"emptyLinePlaceholder":60},[257,4047,4049,4051,4053,4055,4057,4059,4061,4063,4065,4067,4069,4071,4073,4075,4077,4079],{"class":259,"line":4048},151,[257,4050,1137],{"class":263},[257,4052,560],{"class":319},[257,4054,2751],{"class":271},[257,4056,450],{"class":267},[257,4058,2391],{"class":271},[257,4060,2144],{"class":267},[257,4062,1184],{"class":267},[257,4064,2149],{"class":271},[257,4066,450],{"class":267},[257,4068,1450],{"class":271},[257,4070,2156],{"class":267},[257,4072,281],{"class":267},[257,4074,2161],{"class":284},[257,4076,664],{"class":267},[257,4078,1096],{"class":319},[257,4080,579],{"class":267},[257,4082,4084],{"class":259,"line":4083},152,[257,4085,4086],{"class":490},"            // set visibility of elements\n",[257,4088,4090],{"class":259,"line":4089},153,[257,4091,648],{"class":267},[257,4093,4095],{"class":259,"line":4094},154,[257,4096,1118],{"class":267},[257,4098,4100],{"class":259,"line":4099},155,[257,4101,373],{"class":267},[942,4103,4105],{"id":4104},"faster-text-truncation","Faster Text Truncation",[70,4107,4108,4109,4114],{},"Initially I just looked up how to do text truncation and found this snippet on the ",[74,4110,4113],{"href":4111,"rel":4112},"https://github.com/pixijs/pixijs/issues/3449#issuecomment-428648004",[78],"repo"," which you'll probably come across if searching for how to do this. Hereâ€™s the modified version I initially used:",[244,4116,4117],{},[247,4118,4120],{"className":249,"code":4119,"language":251,"meta":252,"style":252},"/** Truncates text to a specific number of lines using PixiJS TextMetrics */\nstatic truncatePixiText(\n    /** The raw string to truncate */\n    text: string,\n    /** PixiJS TextStyle object or configuration */\n    style: TextStyle,\n    /** Maximum number of lines allowed before truncation */\n    maxLines: number\n): string {\n    if (maxLines === Infinity) {\n        return text\n    }\n\n    const wordWrapWidth = style.wordWrapWidth\n    const { lines } = CanvasTextMetrics.measureText(text, style)\n\n    if (lines.length \u003C= maxLines) {\n        return text\n    }\n\n    const truncatedLines = lines.slice(0, maxLines)\n    const lastLine = truncatedLines[truncatedLines.length - 1]\n\n    const chars = Array.from(lastLine)\n\n    // measure the ellipsis and each character individually\n    const charMetrics = CanvasTextMetrics.measureText(`...\\n${chars.join(\"\\n\")}`, style)\n    const [dotsLength, ...charLengths] = charMetrics.lineWidths\n\n    let newLastLine = \"\";\n    let currentLength = dotsLength;\n\n    for (let i = 0; i \u003C charLengths.length; i++) {\n        const charLength = charLengths[i];\n\n        if (currentLength + charLength >= wordWrapWidth) {\n            break; \n        }\n\n        newLastLine += chars[i];\n        currentLength += charLength;\n    }\n\n    truncatedLines[truncatedLines.length - 1] = `${newLastLine}...`\n    return truncatedLines.join(\"\\n\")\n}\n",[254,4121,4122,4127,4136,4141,4148,4153,4160,4165,4170,4177,4195,4203,4207,4211,4228,4259,4263,4285,4291,4295,4299,4324,4351,4355,4377,4381,4386,4441,4469,4473,4486,4500,4504,4546,4565,4569,4591,4601,4605,4609,4627,4638,4642,4646,4681,4701],{"__ignoreMap":252},[257,4123,4124],{"class":259,"line":260},[257,4125,4126],{"class":490},"/** Truncates text to a specific number of lines using PixiJS TextMetrics */\n",[257,4128,4129,4132,4134],{"class":259,"line":291},[257,4130,4131],{"class":271},"static ",[257,4133,4017],{"class":390},[257,4135,456],{"class":271},[257,4137,4138],{"class":259,"line":297},[257,4139,4140],{"class":490},"    /** The raw string to truncate */\n",[257,4142,4143,4146],{"class":259,"line":316},[257,4144,4145],{"class":271},"    text: string",[257,4147,330],{"class":267},[257,4149,4150],{"class":259,"line":333},[257,4151,4152],{"class":490},"    /** PixiJS TextStyle object or configuration */\n",[257,4154,4155,4158],{"class":259,"line":346},[257,4156,4157],{"class":271},"    style: TextStyle",[257,4159,330],{"class":267},[257,4161,4162],{"class":259,"line":359},[257,4163,4164],{"class":490},"    /** Maximum number of lines allowed before truncation */\n",[257,4166,4167],{"class":259,"line":370},[257,4168,4169],{"class":271},"    maxLines: number\n",[257,4171,4172,4175],{"class":259,"line":376},[257,4173,4174],{"class":271},"): string ",[257,4176,579],{"class":267},[257,4178,4179,4181,4183,4186,4188,4191,4193],{"class":259,"line":407},[257,4180,3095],{"class":263},[257,4182,560],{"class":319},[257,4184,4185],{"class":271},"maxLines",[257,4187,2156],{"class":267},[257,4189,4190],{"class":267}," Infinity",[257,4192,1096],{"class":319},[257,4194,579],{"class":267},[257,4196,4197,4200],{"class":259,"line":435},[257,4198,4199],{"class":263},"        return",[257,4201,4202],{"class":271}," text\n",[257,4204,4205],{"class":259,"line":459},[257,4206,1118],{"class":267},[257,4208,4209],{"class":259,"line":476},[257,4210,294],{"emptyLinePlaceholder":60},[257,4212,4213,4215,4218,4220,4223,4225],{"class":259,"line":487},[257,4214,438],{"class":303},[257,4216,4217],{"class":271}," wordWrapWidth",[257,4219,444],{"class":267},[257,4221,4222],{"class":271}," style",[257,4224,450],{"class":267},[257,4226,4227],{"class":271},"wordWrapWidth\n",[257,4229,4230,4232,4234,4237,4239,4241,4244,4246,4249,4251,4253,4255,4257],{"class":259,"line":494},[257,4231,438],{"class":303},[257,4233,268],{"class":267},[257,4235,4236],{"class":271}," lines",[257,4238,275],{"class":267},[257,4240,444],{"class":267},[257,4242,4243],{"class":271}," CanvasTextMetrics",[257,4245,450],{"class":267},[257,4247,4248],{"class":390},"measureText",[257,4250,418],{"class":319},[257,4252,2664],{"class":271},[257,4254,534],{"class":267},[257,4256,4222],{"class":271},[257,4258,551],{"class":319},[257,4260,4261],{"class":259,"line":554},[257,4262,294],{"emptyLinePlaceholder":60},[257,4264,4265,4267,4269,4272,4274,4276,4278,4281,4283],{"class":259,"line":582},[257,4266,3095],{"class":263},[257,4268,560],{"class":319},[257,4270,4271],{"class":271},"lines",[257,4273,450],{"class":267},[257,4275,874],{"class":271},[257,4277,3457],{"class":267},[257,4279,4280],{"class":271}," maxLines",[257,4282,1096],{"class":319},[257,4284,579],{"class":267},[257,4286,4287,4289],{"class":259,"line":630},[257,4288,4199],{"class":263},[257,4290,4202],{"class":271},[257,4292,4293],{"class":259,"line":636},[257,4294,1118],{"class":267},[257,4296,4297],{"class":259,"line":645},[257,4298,294],{"emptyLinePlaceholder":60},[257,4300,4301,4303,4306,4308,4310,4312,4314,4316,4318,4320,4322],{"class":259,"line":651},[257,4302,438],{"class":303},[257,4304,4305],{"class":271}," truncatedLines",[257,4307,444],{"class":267},[257,4309,4236],{"class":271},[257,4311,450],{"class":267},[257,4313,893],{"class":390},[257,4315,418],{"class":319},[257,4317,1751],{"class":326},[257,4319,534],{"class":267},[257,4321,4280],{"class":271},[257,4323,551],{"class":319},[257,4325,4326,4328,4331,4333,4335,4337,4340,4342,4344,4346,4348],{"class":259,"line":671},[257,4327,438],{"class":303},[257,4329,4330],{"class":271}," lastLine",[257,4332,444],{"class":267},[257,4334,4305],{"class":271},[257,4336,848],{"class":319},[257,4338,4339],{"class":271},"truncatedLines",[257,4341,450],{"class":267},[257,4343,874],{"class":271},[257,4345,1605],{"class":267},[257,4347,3460],{"class":326},[257,4349,4350],{"class":319},"]\n",[257,4352,4353],{"class":259,"line":680},[257,4354,294],{"emptyLinePlaceholder":60},[257,4356,4357,4359,4362,4364,4366,4368,4370,4372,4375],{"class":259,"line":685},[257,4358,438],{"class":303},[257,4360,4361],{"class":271}," chars",[257,4363,444],{"class":267},[257,4365,447],{"class":271},[257,4367,450],{"class":267},[257,4369,453],{"class":390},[257,4371,418],{"class":319},[257,4373,4374],{"class":271},"lastLine",[257,4376,551],{"class":319},[257,4378,4379],{"class":259,"line":691},[257,4380,294],{"emptyLinePlaceholder":60},[257,4382,4383],{"class":259,"line":711},[257,4384,4385],{"class":490},"    // measure the ellipsis and each character individually\n",[257,4387,4388,4390,4393,4395,4397,4399,4401,4403,4406,4409,4412,4415,4418,4420,4422,4424,4426,4428,4430,4432,4435,4437,4439],{"class":259,"line":723},[257,4389,438],{"class":303},[257,4391,4392],{"class":271}," charMetrics",[257,4394,444],{"class":267},[257,4396,4243],{"class":271},[257,4398,450],{"class":267},[257,4400,4248],{"class":390},[257,4402,418],{"class":319},[257,4404,4405],{"class":267},"`",[257,4407,4408],{"class":284},"...",[257,4410,4411],{"class":271},"\\n",[257,4413,4414],{"class":267},"${",[257,4416,4417],{"class":271},"chars",[257,4419,450],{"class":267},[257,4421,659],{"class":390},[257,4423,418],{"class":271},[257,4425,664],{"class":267},[257,4427,4411],{"class":271},[257,4429,664],{"class":267},[257,4431,430],{"class":271},[257,4433,4434],{"class":267},"}`",[257,4436,534],{"class":267},[257,4438,4222],{"class":271},[257,4440,551],{"class":319},[257,4442,4443,4445,4447,4450,4452,4455,4458,4460,4462,4464,4466],{"class":259,"line":728},[257,4444,438],{"class":303},[257,4446,1507],{"class":267},[257,4448,4449],{"class":271},"dotsLength",[257,4451,534],{"class":267},[257,4453,4454],{"class":267}," ...",[257,4456,4457],{"class":271},"charLengths",[257,4459,2580],{"class":267},[257,4461,444],{"class":267},[257,4463,4392],{"class":271},[257,4465,450],{"class":267},[257,4467,4468],{"class":271},"lineWidths\n",[257,4470,4471],{"class":259,"line":806},[257,4472,294],{"emptyLinePlaceholder":60},[257,4474,4475,4477,4480,4482,4484],{"class":259,"line":812},[257,4476,3520],{"class":303},[257,4478,4479],{"class":271}," newLastLine",[257,4481,444],{"class":267},[257,4483,3031],{"class":267},[257,4485,3054],{"class":267},[257,4487,4488,4490,4493,4495,4498],{"class":259,"line":835},[257,4489,3520],{"class":303},[257,4491,4492],{"class":271}," currentLength",[257,4494,444],{"class":267},[257,4496,4497],{"class":271}," dotsLength",[257,4499,3054],{"class":267},[257,4501,4502],{"class":259,"line":880},[257,4503,294],{"emptyLinePlaceholder":60},[257,4505,4506,4508,4510,4513,4516,4518,4520,4523,4525,4528,4531,4533,4535,4537,4539,4542,4544],{"class":259,"line":912},[257,4507,2563],{"class":263},[257,4509,560],{"class":319},[257,4511,4512],{"class":303},"let",[257,4514,4515],{"class":271}," i",[257,4517,444],{"class":267},[257,4519,1756],{"class":326},[257,4521,4522],{"class":267},";",[257,4524,4515],{"class":271},[257,4526,4527],{"class":267}," \u003C",[257,4529,4530],{"class":271}," charLengths",[257,4532,450],{"class":267},[257,4534,874],{"class":271},[257,4536,4522],{"class":267},[257,4538,4515],{"class":271},[257,4540,4541],{"class":267},"++",[257,4543,1096],{"class":319},[257,4545,579],{"class":267},[257,4547,4548,4550,4553,4555,4557,4559,4561,4563],{"class":259,"line":919},[257,4549,2130],{"class":303},[257,4551,4552],{"class":271}," charLength",[257,4554,444],{"class":267},[257,4556,4530],{"class":271},[257,4558,848],{"class":319},[257,4560,771],{"class":271},[257,4562,2580],{"class":319},[257,4564,3054],{"class":267},[257,4566,4567],{"class":259,"line":1917},[257,4568,294],{"emptyLinePlaceholder":60},[257,4570,4571,4573,4575,4578,4580,4582,4585,4587,4589],{"class":259,"line":1923},[257,4572,1137],{"class":263},[257,4574,560],{"class":319},[257,4576,4577],{"class":271},"currentLength",[257,4579,905],{"class":267},[257,4581,4552],{"class":271},[257,4583,4584],{"class":267}," >=",[257,4586,4217],{"class":271},[257,4588,1096],{"class":319},[257,4590,579],{"class":267},[257,4592,4593,4596,4598],{"class":259,"line":2481},[257,4594,4595],{"class":263},"            break",[257,4597,4522],{"class":267},[257,4599,4600],{"class":319}," \n",[257,4602,4603],{"class":259,"line":2496},[257,4604,648],{"class":267},[257,4606,4607],{"class":259,"line":2501},[257,4608,294],{"emptyLinePlaceholder":60},[257,4610,4611,4614,4617,4619,4621,4623,4625],{"class":259,"line":2527},[257,4612,4613],{"class":271},"        newLastLine",[257,4615,4616],{"class":267}," +=",[257,4618,4361],{"class":271},[257,4620,848],{"class":319},[257,4622,771],{"class":271},[257,4624,2580],{"class":319},[257,4626,3054],{"class":267},[257,4628,4629,4632,4634,4636],{"class":259,"line":2555},[257,4630,4631],{"class":271},"        currentLength",[257,4633,4616],{"class":267},[257,4635,4552],{"class":271},[257,4637,3054],{"class":267},[257,4639,4640],{"class":259,"line":2560},[257,4641,1118],{"class":267},[257,4643,4644],{"class":259,"line":2594},[257,4645,294],{"emptyLinePlaceholder":60},[257,4647,4648,4651,4653,4655,4657,4659,4661,4663,4666,4668,4671,4674,4676,4678],{"class":259,"line":2616},[257,4649,4650],{"class":271},"    truncatedLines",[257,4652,848],{"class":319},[257,4654,4339],{"class":271},[257,4656,450],{"class":267},[257,4658,874],{"class":271},[257,4660,1605],{"class":267},[257,4662,3460],{"class":326},[257,4664,4665],{"class":319},"] ",[257,4667,310],{"class":267},[257,4669,4670],{"class":267}," `${",[257,4672,4673],{"class":271},"newLastLine",[257,4675,759],{"class":267},[257,4677,4408],{"class":284},[257,4679,4680],{"class":267},"`\n",[257,4682,4683,4685,4687,4689,4691,4693,4695,4697,4699],{"class":259,"line":2650},[257,4684,674],{"class":263},[257,4686,4305],{"class":271},[257,4688,450],{"class":267},[257,4690,659],{"class":390},[257,4692,418],{"class":319},[257,4694,664],{"class":267},[257,4696,4411],{"class":271},[257,4698,664],{"class":267},[257,4700,551],{"class":319},[257,4702,4703],{"class":259,"line":2672},[257,4704,373],{"class":267},[70,4706,4707],{},"As you can see this text truncation function requires two measurements. First, based on the text style, it measures how many lines the wrapped text produces. Then, it takes the line and measure character by character to see where to cut it (the original measured by word, I wanted by character, both are slow).",[70,4709,4710,4711,4714],{},"Pixi does tons of caching internally, but it's just a slow thing to calculate. It's also specially slow with regular ",[254,4712,4713],{},"Text"," (which I was using at the beginning).",[70,4716,4717,4718,4721],{},"So how to speed this up (apart from using ",[254,4719,4720],{},"BitmapText",")? See if you can spot it before reading on. The biggest performance gain feels a bit obvious once you see it.",[70,4723,4724],{},"Some low hanging fruit first, if you have long note summaries that aren't already truncated, it's measuring all that text which won't be visible.",[1237,4726,4728],{"id":4727},"optimization-1-limiting-text-length","Optimization 1 - Limiting Text Length",[70,4730,4731],{},"I measured the smallest character (usually a space) and calculated how many we could fit in a card.",[70,4733,4734],{},"We can then use this to limit how much text we even try to truncate. This should also done as soon as we can after we receive the data to avoid keeping the full summary in memory.",[1237,4736,4738],{"id":4737},"optimization-2-avoiding-the-second-measurement","Optimization 2 - Avoiding the Second Measurement",[70,4740,4741],{},"We want to avoid the second measurement of the characters at all costs.",[70,4743,4744],{},"I tried caching the measurements of individual characters to calculate the aproximate width of the last line myself. Pixi is already technically doing this but it doesn't keep the cache around between calls. That was faster, but still slow.",[70,4746,4747],{},"I considered using a monospace font even though I didn't like the idea of being restricted to monospace fonts.",[70,4749,4750],{},"I asked the LLMs. They added a third measurement call just to rage bait me, and I went back to thinking.",[70,4752,4753],{},"And then I saw it.",[70,4755,4756],{},"When pixi does the first measurement, it also chops up the line, and we know what text is on which line and how long it is already! ğŸ¤¦",[70,4758,4759,4760,4762],{},"Now, ",[254,4761,450],{}," is usually the shortest character in a font (and if not, we should pick a font where it is).",[70,4764,4765,4766,4769],{},"So when a line needs an ellipsis ",[2004,4767,4768],{},"all"," the last characters we need to chop off are wider than a period. When we replace them, the line is always guaranteed to be shorter.",[70,4771,4772],{},"For example, say we want max 2 lines:",[247,4774,4776],{"className":249,"code":4775,"language":251,"meta":252,"style":252},"         cutoff â”€â”\n                 ğŸ­­ \nSome long text we want to truncate\n            \n// pixi will wrap it to:\n                 ğŸ­­ \nSome long text\nwe want to truncate\n\n// and we want:\n                 ğŸ­­ \nSome long text\nwe want to trun...\n",[254,4777,4778,4783,4788,4793,4798,4803,4807,4812,4817,4821,4826,4830,4834],{"__ignoreMap":252},[257,4779,4780],{"class":259,"line":260},[257,4781,4782],{"class":271},"         cutoff â”€â”\n",[257,4784,4785],{"class":259,"line":291},[257,4786,4787],{"class":271},"                 ğŸ­­ \n",[257,4789,4790],{"class":259,"line":297},[257,4791,4792],{"class":271},"Some long text we want to truncate\n",[257,4794,4795],{"class":259,"line":316},[257,4796,4797],{"class":271},"            \n",[257,4799,4800],{"class":259,"line":333},[257,4801,4802],{"class":490},"// pixi will wrap it to:\n",[257,4804,4805],{"class":259,"line":346},[257,4806,4787],{"class":271},[257,4808,4809],{"class":259,"line":359},[257,4810,4811],{"class":271},"Some long text\n",[257,4813,4814],{"class":259,"line":370},[257,4815,4816],{"class":271},"we want to truncate\n",[257,4818,4819],{"class":259,"line":376},[257,4820,294],{"emptyLinePlaceholder":60},[257,4822,4823],{"class":259,"line":407},[257,4824,4825],{"class":490},"// and we want:\n",[257,4827,4828],{"class":259,"line":435},[257,4829,4787],{"class":271},[257,4831,4832],{"class":259,"line":459},[257,4833,4811],{"class":271},[257,4835,4836,4839],{"class":259,"line":476},[257,4837,4838],{"class":271},"we want to trun",[257,4840,4841],{"class":267},"...\n",[70,4843,4844],{},"With a non-monospace font, here's how they compare:",[4846,4847,4848,4851],"blockquote",{},[70,4849,4850],{},"we want to truncate",[70,4852,4853],{},"we want to trun...",[70,4855,4856],{},"The truncated line is always shorter.",[70,4858,4859],{},"If we want truncation at the word level, we can just find the first space that's at least 3 characters in.",[70,4861,4862],{},"Here's the final code which takes about 20% less time.",[70,4864,4865],{},"This version supports both Text and BitmapText. As mentioned above bitmap support is crucial as otherwise regular text is still too slow even with this speedup.",[244,4867,4868],{},[247,4869,4871],{"className":249,"code":4870,"language":251,"meta":252,"style":252},"/**\n* Truncates text to a specific number of lines using PixiJS TextMetrics.\n*\n* Uses lots of optimizations and caching to make this as fast as possible.\n*\n* IMPORTANT: Be sure to pre-slice the text if it can get very long.\n*/\nstatic truncatePixiText(\n    /** The raw string to truncate */\n    text: string,\n    /** PixiJS TextStyle object or configuration */\n    style: TextStyle,\n    /** Whether to use the bitmap text measuring method or the canvas text measuring method. Words will NOT wrap right if you use the wrong one. */\n    isBitmapFont: boolean = true,\n    /** Maximum number of lines allowed before truncation */\n    maxLines: number,\n    /** Since we recommend slicing the text, we can't be sure if there are more lines or not and whether to add an ellipsis to the last line.\n    * @default false\n    */\n    containsMoreLines: boolean = false,\n    /** Pass a cached width. */\n    ellipsisWidth?: number\n): string {\n    if (maxLines === Infinity) {\n        return text\n    }\n\n    const wordWrapWidth = style.wordWrapWidth\n\n    let lineWidths = []\n    let lines = []\n    if (isBitmapFont) {\n        const measure = BitmapFontManager.getLayout(text, style, true)\n\n        for (let i = 0; i \u003C measure.lines.length && i \u003C maxLines; i++) {\n                const line = measure.lines[i]\n                const chars = line.chars.join(\"\")\n                if (chars.length === 0 && i === measure.lines.length - 1) {\n                    // last line is always empty, idk why\n                    break\n                }\n                lineWidths.push(line.width * measure.scale)\n                lines.push(line.chars.join(\"\"))\n        }\n    } else {\n        const measure = CanvasTextMetrics.measureText(text, style)\n        lineWidths = measure.lineWidths\n        lines = measure.lines.slice(0, maxLines)\n    }\n    if (lines.length \u003C maxLines) {\n        return text\n    }\n    const lastLine = lines[lines.length - 1]\n\n    if (ellipsisWidth === undefined) {\n        if (isBitmapFont) {\n                const measure = BitmapFontManager.getLayout(\"...\", style, true)\n                ellipsisWidth = measure.width * measure.scale\n        } else {\n                ellipsisWidth = CanvasTextMetrics.measureText(\"...\", style).width\n        }\n    }\n    const ellipsisDontFit = ellipsisWidth > wordWrapWidth\n    if (ellipsisDontFit) {\n        lines[lines.length - 1] = \"\"\n        return lines.join(\"\")\n    }\n\n    // this is a stylistic choice\n    const shouldAddEllipsis = (containsMoreLines || lines.length > lines.length) && !lastLine.endsWith(\".\")\n\n    if (lineWidths[lineWidths.length - 1] + ellipsisWidth \u003C wordWrapWidth && !shouldAddEllipsis) {\n        return lines.join(\"\")\n    }\n\n    if (style.breakWords) {\n        // dots happen to be the shortest width character in most fonts\n        // so we can just cut off the last 3 characters and add the ellipsis\n        lines[lines.length - 1] = `${lastLine.slice(0, lastLine.length - 3)}...`\n    } else {\n        // for words, we just have to find the last space that is at least 3 characters in\n        const lastIndex = lastLine.lastIndexOf(\" \", lastLine.length - 3)\n        if (lastIndex === -1) lines[lines.length - 1] = `...`\n        else lines[lines.length - 1] = `${lastLine.slice(0, lastIndex)}...`\n    }\n    return lines.join(\"\")\n}\n",[254,4872,4873,4878,4883,4888,4893,4897,4902,4907,4915,4919,4925,4929,4935,4940,4952,4956,4963,4968,4982,4987,4999,5004,5013,5019,5035,5041,5045,5049,5063,5067,5078,5088,5101,5132,5136,5184,5206,5231,5272,5277,5282,5287,5316,5344,5348,5356,5380,5393,5420,5424,5444,5450,5454,5478,5482,5499,5511,5543,5565,5573,5604,5608,5612,5629,5642,5664,5680,5684,5688,5693,5747,5751,5794,5810,5814,5818,5836,5841,5846,5899,5907,5912,5948,5991,6037,6041,6057],{"__ignoreMap":252},[257,4874,4875],{"class":259,"line":260},[257,4876,4877],{"class":490},"/**\n",[257,4879,4880],{"class":259,"line":291},[257,4881,4882],{"class":490},"* Truncates text to a specific number of lines using PixiJS TextMetrics.\n",[257,4884,4885],{"class":259,"line":297},[257,4886,4887],{"class":490},"*\n",[257,4889,4890],{"class":259,"line":316},[257,4891,4892],{"class":490},"* Uses lots of optimizations and caching to make this as fast as possible.\n",[257,4894,4895],{"class":259,"line":333},[257,4896,4887],{"class":490},[257,4898,4899],{"class":259,"line":346},[257,4900,4901],{"class":490},"* IMPORTANT: Be sure to pre-slice the text if it can get very long.\n",[257,4903,4904],{"class":259,"line":359},[257,4905,4906],{"class":490},"*/\n",[257,4908,4909,4911,4913],{"class":259,"line":370},[257,4910,4131],{"class":271},[257,4912,4017],{"class":390},[257,4914,456],{"class":271},[257,4916,4917],{"class":259,"line":376},[257,4918,4140],{"class":490},[257,4920,4921,4923],{"class":259,"line":407},[257,4922,4145],{"class":271},[257,4924,330],{"class":267},[257,4926,4927],{"class":259,"line":435},[257,4928,4152],{"class":490},[257,4930,4931,4933],{"class":259,"line":459},[257,4932,4157],{"class":271},[257,4934,330],{"class":267},[257,4936,4937],{"class":259,"line":476},[257,4938,4939],{"class":490},"    /** Whether to use the bitmap text measuring method or the canvas text measuring method. Words will NOT wrap right if you use the wrong one. */\n",[257,4941,4942,4945,4947,4950],{"class":259,"line":487},[257,4943,4944],{"class":271},"    isBitmapFont: boolean ",[257,4946,310],{"class":267},[257,4948,4949],{"class":1001}," true",[257,4951,330],{"class":267},[257,4953,4954],{"class":259,"line":494},[257,4955,4164],{"class":490},[257,4957,4958,4961],{"class":259,"line":554},[257,4959,4960],{"class":271},"    maxLines: number",[257,4962,330],{"class":267},[257,4964,4965],{"class":259,"line":582},[257,4966,4967],{"class":490},"    /** Since we recommend slicing the text, we can't be sure if there are more lines or not and whether to add an ellipsis to the last line.\n",[257,4969,4970,4973,4976,4980],{"class":259,"line":630},[257,4971,4972],{"class":490},"    * ",[257,4974,4975],{"class":263},"@",[257,4977,4979],{"class":4978},"s6hCs","default",[257,4981,2238],{"class":421},[257,4983,4984],{"class":259,"line":636},[257,4985,4986],{"class":490},"    */\n",[257,4988,4989,4992,4994,4997],{"class":259,"line":645},[257,4990,4991],{"class":271},"    containsMoreLines: boolean ",[257,4993,310],{"class":267},[257,4995,4996],{"class":1001}," false",[257,4998,330],{"class":267},[257,5000,5001],{"class":259,"line":651},[257,5002,5003],{"class":490},"    /** Pass a cached width. */\n",[257,5005,5006,5009,5011],{"class":259,"line":671},[257,5007,5008],{"class":271},"    ellipsisWidth",[257,5010,3367],{"class":267},[257,5012,3370],{"class":271},[257,5014,5015,5017],{"class":259,"line":680},[257,5016,4174],{"class":271},[257,5018,579],{"class":267},[257,5020,5021,5023,5025,5027,5029,5031,5033],{"class":259,"line":685},[257,5022,3095],{"class":263},[257,5024,560],{"class":319},[257,5026,4185],{"class":271},[257,5028,2156],{"class":267},[257,5030,4190],{"class":267},[257,5032,1096],{"class":319},[257,5034,579],{"class":267},[257,5036,5037,5039],{"class":259,"line":691},[257,5038,4199],{"class":263},[257,5040,4202],{"class":271},[257,5042,5043],{"class":259,"line":711},[257,5044,1118],{"class":267},[257,5046,5047],{"class":259,"line":723},[257,5048,294],{"emptyLinePlaceholder":60},[257,5050,5051,5053,5055,5057,5059,5061],{"class":259,"line":728},[257,5052,438],{"class":303},[257,5054,4217],{"class":271},[257,5056,444],{"class":267},[257,5058,4222],{"class":271},[257,5060,450],{"class":267},[257,5062,4227],{"class":271},[257,5064,5065],{"class":259,"line":806},[257,5066,294],{"emptyLinePlaceholder":60},[257,5068,5069,5071,5074,5076],{"class":259,"line":812},[257,5070,3520],{"class":303},[257,5072,5073],{"class":271}," lineWidths",[257,5075,444],{"class":267},[257,5077,978],{"class":319},[257,5079,5080,5082,5084,5086],{"class":259,"line":835},[257,5081,3520],{"class":303},[257,5083,4236],{"class":271},[257,5085,444],{"class":267},[257,5087,978],{"class":319},[257,5089,5090,5092,5094,5097,5099],{"class":259,"line":880},[257,5091,3095],{"class":263},[257,5093,560],{"class":319},[257,5095,5096],{"class":271},"isBitmapFont",[257,5098,1096],{"class":319},[257,5100,579],{"class":267},[257,5102,5103,5105,5108,5110,5113,5115,5118,5120,5122,5124,5126,5128,5130],{"class":259,"line":912},[257,5104,2130],{"class":303},[257,5106,5107],{"class":271}," measure",[257,5109,444],{"class":267},[257,5111,5112],{"class":271}," BitmapFontManager",[257,5114,450],{"class":267},[257,5116,5117],{"class":390},"getLayout",[257,5119,418],{"class":319},[257,5121,2664],{"class":271},[257,5123,534],{"class":267},[257,5125,4222],{"class":271},[257,5127,534],{"class":267},[257,5129,4949],{"class":1001},[257,5131,551],{"class":319},[257,5133,5134],{"class":259,"line":919},[257,5135,294],{"emptyLinePlaceholder":60},[257,5137,5138,5140,5142,5144,5146,5148,5150,5152,5154,5156,5158,5160,5162,5164,5166,5168,5170,5172,5174,5176,5178,5180,5182],{"class":259,"line":1917},[257,5139,1171],{"class":263},[257,5141,560],{"class":319},[257,5143,4512],{"class":303},[257,5145,4515],{"class":271},[257,5147,444],{"class":267},[257,5149,1756],{"class":326},[257,5151,4522],{"class":267},[257,5153,4515],{"class":271},[257,5155,4527],{"class":267},[257,5157,5107],{"class":271},[257,5159,450],{"class":267},[257,5161,4271],{"class":271},[257,5163,450],{"class":267},[257,5165,874],{"class":271},[257,5167,2144],{"class":267},[257,5169,4515],{"class":271},[257,5171,4527],{"class":267},[257,5173,4280],{"class":271},[257,5175,4522],{"class":267},[257,5177,4515],{"class":271},[257,5179,4541],{"class":267},[257,5181,1096],{"class":319},[257,5183,579],{"class":267},[257,5185,5186,5189,5192,5194,5196,5198,5200,5202,5204],{"class":259,"line":1923},[257,5187,5188],{"class":303},"                const",[257,5190,5191],{"class":271}," line",[257,5193,444],{"class":267},[257,5195,5107],{"class":271},[257,5197,450],{"class":267},[257,5199,4271],{"class":271},[257,5201,848],{"class":319},[257,5203,771],{"class":271},[257,5205,4350],{"class":319},[257,5207,5208,5210,5212,5214,5216,5218,5220,5222,5224,5226,5229],{"class":259,"line":2481},[257,5209,5188],{"class":303},[257,5211,4361],{"class":271},[257,5213,444],{"class":267},[257,5215,5191],{"class":271},[257,5217,450],{"class":267},[257,5219,4417],{"class":271},[257,5221,450],{"class":267},[257,5223,659],{"class":390},[257,5225,418],{"class":319},[257,5227,5228],{"class":267},"\"\"",[257,5230,551],{"class":319},[257,5232,5233,5236,5238,5240,5242,5244,5246,5248,5250,5252,5254,5256,5258,5260,5262,5264,5266,5268,5270],{"class":259,"line":2496},[257,5234,5235],{"class":263},"                if",[257,5237,560],{"class":319},[257,5239,4417],{"class":271},[257,5241,450],{"class":267},[257,5243,874],{"class":271},[257,5245,2156],{"class":267},[257,5247,1756],{"class":326},[257,5249,2144],{"class":267},[257,5251,4515],{"class":271},[257,5253,2156],{"class":267},[257,5255,5107],{"class":271},[257,5257,450],{"class":267},[257,5259,4271],{"class":271},[257,5261,450],{"class":267},[257,5263,874],{"class":271},[257,5265,1605],{"class":267},[257,5267,3460],{"class":326},[257,5269,1096],{"class":319},[257,5271,579],{"class":267},[257,5273,5274],{"class":259,"line":2501},[257,5275,5276],{"class":490},"                    // last line is always empty, idk why\n",[257,5278,5279],{"class":259,"line":2527},[257,5280,5281],{"class":263},"                    break\n",[257,5283,5284],{"class":259,"line":2555},[257,5285,5286],{"class":267},"                }\n",[257,5288,5289,5292,5294,5296,5298,5300,5302,5305,5307,5309,5311,5314],{"class":259,"line":2560},[257,5290,5291],{"class":271},"                lineWidths",[257,5293,450],{"class":267},[257,5295,1015],{"class":390},[257,5297,418],{"class":319},[257,5299,259],{"class":271},[257,5301,450],{"class":267},[257,5303,5304],{"class":271},"width",[257,5306,1330],{"class":267},[257,5308,5107],{"class":271},[257,5310,450],{"class":267},[257,5312,5313],{"class":271},"scale",[257,5315,551],{"class":319},[257,5317,5318,5321,5323,5325,5327,5329,5331,5333,5335,5337,5339,5341],{"class":259,"line":2594},[257,5319,5320],{"class":271},"                lines",[257,5322,450],{"class":267},[257,5324,1015],{"class":390},[257,5326,418],{"class":319},[257,5328,259],{"class":271},[257,5330,450],{"class":267},[257,5332,4417],{"class":271},[257,5334,450],{"class":267},[257,5336,659],{"class":390},[257,5338,418],{"class":319},[257,5340,5228],{"class":267},[257,5342,5343],{"class":319},"))\n",[257,5345,5346],{"class":259,"line":2616},[257,5347,648],{"class":267},[257,5349,5350,5352,5354],{"class":259,"line":2650},[257,5351,1799],{"class":267},[257,5353,2779],{"class":263},[257,5355,313],{"class":267},[257,5357,5358,5360,5362,5364,5366,5368,5370,5372,5374,5376,5378],{"class":259,"line":2672},[257,5359,2130],{"class":303},[257,5361,5107],{"class":271},[257,5363,444],{"class":267},[257,5365,4243],{"class":271},[257,5367,450],{"class":267},[257,5369,4248],{"class":390},[257,5371,418],{"class":319},[257,5373,2664],{"class":271},[257,5375,534],{"class":267},[257,5377,4222],{"class":271},[257,5379,551],{"class":319},[257,5381,5382,5385,5387,5389,5391],{"class":259,"line":2677},[257,5383,5384],{"class":271},"        lineWidths",[257,5386,444],{"class":267},[257,5388,5107],{"class":271},[257,5390,450],{"class":267},[257,5392,4468],{"class":271},[257,5394,5395,5398,5400,5402,5404,5406,5408,5410,5412,5414,5416,5418],{"class":259,"line":2696},[257,5396,5397],{"class":271},"        lines",[257,5399,444],{"class":267},[257,5401,5107],{"class":271},[257,5403,450],{"class":267},[257,5405,4271],{"class":271},[257,5407,450],{"class":267},[257,5409,893],{"class":390},[257,5411,418],{"class":319},[257,5413,1751],{"class":326},[257,5415,534],{"class":267},[257,5417,4280],{"class":271},[257,5419,551],{"class":319},[257,5421,5422],{"class":259,"line":2701},[257,5423,1118],{"class":267},[257,5425,5426,5428,5430,5432,5434,5436,5438,5440,5442],{"class":259,"line":2717},[257,5427,3095],{"class":263},[257,5429,560],{"class":319},[257,5431,4271],{"class":271},[257,5433,450],{"class":267},[257,5435,874],{"class":271},[257,5437,4527],{"class":267},[257,5439,4280],{"class":271},[257,5441,1096],{"class":319},[257,5443,579],{"class":267},[257,5445,5446,5448],{"class":259,"line":2735},[257,5447,4199],{"class":263},[257,5449,4202],{"class":271},[257,5451,5452],{"class":259,"line":2756},[257,5453,1118],{"class":267},[257,5455,5456,5458,5460,5462,5464,5466,5468,5470,5472,5474,5476],{"class":259,"line":2773},[257,5457,438],{"class":303},[257,5459,4330],{"class":271},[257,5461,444],{"class":267},[257,5463,4236],{"class":271},[257,5465,848],{"class":319},[257,5467,4271],{"class":271},[257,5469,450],{"class":267},[257,5471,874],{"class":271},[257,5473,1605],{"class":267},[257,5475,3460],{"class":326},[257,5477,4350],{"class":319},[257,5479,5480],{"class":259,"line":2784},[257,5481,294],{"emptyLinePlaceholder":60},[257,5483,5484,5486,5488,5491,5493,5495,5497],{"class":259,"line":2801},[257,5485,3095],{"class":263},[257,5487,560],{"class":319},[257,5489,5490],{"class":271},"ellipsisWidth",[257,5492,2156],{"class":267},[257,5494,3450],{"class":267},[257,5496,1096],{"class":319},[257,5498,579],{"class":267},[257,5500,5501,5503,5505,5507,5509],{"class":259,"line":2818},[257,5502,1137],{"class":263},[257,5504,560],{"class":319},[257,5506,5096],{"class":271},[257,5508,1096],{"class":319},[257,5510,579],{"class":267},[257,5512,5513,5515,5517,5519,5521,5523,5525,5527,5529,5531,5533,5535,5537,5539,5541],{"class":259,"line":2823},[257,5514,5188],{"class":303},[257,5516,5107],{"class":271},[257,5518,444],{"class":267},[257,5520,5112],{"class":271},[257,5522,450],{"class":267},[257,5524,5117],{"class":390},[257,5526,418],{"class":319},[257,5528,664],{"class":267},[257,5530,4408],{"class":284},[257,5532,664],{"class":267},[257,5534,534],{"class":267},[257,5536,4222],{"class":271},[257,5538,534],{"class":267},[257,5540,4949],{"class":1001},[257,5542,551],{"class":319},[257,5544,5545,5548,5550,5552,5554,5556,5558,5560,5562],{"class":259,"line":2832},[257,5546,5547],{"class":271},"                ellipsisWidth",[257,5549,444],{"class":267},[257,5551,5107],{"class":271},[257,5553,450],{"class":267},[257,5555,5304],{"class":271},[257,5557,1330],{"class":267},[257,5559,5107],{"class":271},[257,5561,450],{"class":267},[257,5563,5564],{"class":271},"scale\n",[257,5566,5567,5569,5571],{"class":259,"line":2849},[257,5568,1051],{"class":267},[257,5570,2779],{"class":263},[257,5572,313],{"class":267},[257,5574,5575,5577,5579,5581,5583,5585,5587,5589,5591,5593,5595,5597,5599,5601],{"class":259,"line":2866},[257,5576,5547],{"class":271},[257,5578,444],{"class":267},[257,5580,4243],{"class":271},[257,5582,450],{"class":267},[257,5584,4248],{"class":390},[257,5586,418],{"class":319},[257,5588,664],{"class":267},[257,5590,4408],{"class":284},[257,5592,664],{"class":267},[257,5594,534],{"class":267},[257,5596,4222],{"class":271},[257,5598,430],{"class":319},[257,5600,450],{"class":267},[257,5602,5603],{"class":271},"width\n",[257,5605,5606],{"class":259,"line":2871},[257,5607,648],{"class":267},[257,5609,5610],{"class":259,"line":2876},[257,5611,1118],{"class":267},[257,5613,5614,5616,5619,5621,5624,5626],{"class":259,"line":2881},[257,5615,438],{"class":303},[257,5617,5618],{"class":271}," ellipsisDontFit",[257,5620,444],{"class":267},[257,5622,5623],{"class":271}," ellipsisWidth",[257,5625,2178],{"class":267},[257,5627,5628],{"class":271}," wordWrapWidth\n",[257,5630,5631,5633,5635,5638,5640],{"class":259,"line":2900},[257,5632,3095],{"class":263},[257,5634,560],{"class":319},[257,5636,5637],{"class":271},"ellipsisDontFit",[257,5639,1096],{"class":319},[257,5641,579],{"class":267},[257,5643,5644,5646,5648,5650,5652,5654,5656,5658,5660,5662],{"class":259,"line":2951},[257,5645,5397],{"class":271},[257,5647,848],{"class":319},[257,5649,4271],{"class":271},[257,5651,450],{"class":267},[257,5653,874],{"class":271},[257,5655,1605],{"class":267},[257,5657,3460],{"class":326},[257,5659,4665],{"class":319},[257,5661,310],{"class":267},[257,5663,2669],{"class":267},[257,5665,5666,5668,5670,5672,5674,5676,5678],{"class":259,"line":2966},[257,5667,4199],{"class":263},[257,5669,4236],{"class":271},[257,5671,450],{"class":267},[257,5673,659],{"class":390},[257,5675,418],{"class":319},[257,5677,5228],{"class":267},[257,5679,551],{"class":319},[257,5681,5682],{"class":259,"line":2971},[257,5683,1118],{"class":267},[257,5685,5686],{"class":259,"line":2976},[257,5687,294],{"emptyLinePlaceholder":60},[257,5689,5690],{"class":259,"line":2981},[257,5691,5692],{"class":490},"    // this is a stylistic choice\n",[257,5694,5695,5697,5700,5702,5704,5707,5709,5711,5713,5715,5717,5719,5721,5723,5725,5728,5730,5732,5734,5737,5739,5741,5743,5745],{"class":259,"line":2987},[257,5696,438],{"class":303},[257,5698,5699],{"class":271}," shouldAddEllipsis",[257,5701,444],{"class":267},[257,5703,560],{"class":319},[257,5705,5706],{"class":271},"containsMoreLines",[257,5708,3809],{"class":267},[257,5710,4236],{"class":271},[257,5712,450],{"class":267},[257,5714,874],{"class":271},[257,5716,2178],{"class":267},[257,5718,4236],{"class":271},[257,5720,450],{"class":267},[257,5722,874],{"class":271},[257,5724,1096],{"class":319},[257,5726,5727],{"class":267},"&&",[257,5729,2138],{"class":267},[257,5731,4374],{"class":271},[257,5733,450],{"class":267},[257,5735,5736],{"class":390},"endsWith",[257,5738,418],{"class":319},[257,5740,664],{"class":267},[257,5742,450],{"class":284},[257,5744,664],{"class":267},[257,5746,551],{"class":319},[257,5748,5749],{"class":259,"line":2996},[257,5750,294],{"emptyLinePlaceholder":60},[257,5752,5753,5755,5757,5760,5762,5764,5766,5768,5770,5772,5774,5777,5779,5781,5783,5785,5787,5790,5792],{"class":259,"line":3016},[257,5754,3095],{"class":263},[257,5756,560],{"class":319},[257,5758,5759],{"class":271},"lineWidths",[257,5761,848],{"class":319},[257,5763,5759],{"class":271},[257,5765,450],{"class":267},[257,5767,874],{"class":271},[257,5769,1605],{"class":267},[257,5771,3460],{"class":326},[257,5773,4665],{"class":319},[257,5775,5776],{"class":267},"+",[257,5778,5623],{"class":271},[257,5780,4527],{"class":267},[257,5782,4217],{"class":271},[257,5784,2144],{"class":267},[257,5786,2138],{"class":267},[257,5788,5789],{"class":271},"shouldAddEllipsis",[257,5791,1096],{"class":319},[257,5793,579],{"class":267},[257,5795,5796,5798,5800,5802,5804,5806,5808],{"class":259,"line":3038},[257,5797,4199],{"class":263},[257,5799,4236],{"class":271},[257,5801,450],{"class":267},[257,5803,659],{"class":390},[257,5805,418],{"class":319},[257,5807,5228],{"class":267},[257,5809,551],{"class":319},[257,5811,5812],{"class":259,"line":3057},[257,5813,1118],{"class":267},[257,5815,5816],{"class":259,"line":3062},[257,5817,294],{"emptyLinePlaceholder":60},[257,5819,5820,5822,5824,5827,5829,5832,5834],{"class":259,"line":3067},[257,5821,3095],{"class":263},[257,5823,560],{"class":319},[257,5825,5826],{"class":271},"style",[257,5828,450],{"class":267},[257,5830,5831],{"class":271},"breakWords",[257,5833,1096],{"class":319},[257,5835,579],{"class":267},[257,5837,5838],{"class":259,"line":3072},[257,5839,5840],{"class":490},"        // dots happen to be the shortest width character in most fonts\n",[257,5842,5843],{"class":259,"line":3077},[257,5844,5845],{"class":490},"        // so we can just cut off the last 3 characters and add the ellipsis\n",[257,5847,5848,5850,5852,5854,5856,5858,5860,5862,5864,5866,5868,5870,5872,5874,5876,5878,5880,5882,5884,5887,5889,5891,5893,5895,5897],{"class":259,"line":3083},[257,5849,5397],{"class":271},[257,5851,848],{"class":319},[257,5853,4271],{"class":271},[257,5855,450],{"class":267},[257,5857,874],{"class":271},[257,5859,1605],{"class":267},[257,5861,3460],{"class":326},[257,5863,4665],{"class":319},[257,5865,310],{"class":267},[257,5867,4670],{"class":267},[257,5869,4374],{"class":271},[257,5871,450],{"class":267},[257,5873,893],{"class":390},[257,5875,418],{"class":271},[257,5877,1751],{"class":326},[257,5879,534],{"class":267},[257,5881,4330],{"class":271},[257,5883,450],{"class":267},[257,5885,5886],{"class":271},"length ",[257,5888,3587],{"class":267},[257,5890,327],{"class":326},[257,5892,430],{"class":271},[257,5894,759],{"class":267},[257,5896,4408],{"class":284},[257,5898,4680],{"class":267},[257,5900,5901,5903,5905],{"class":259,"line":3092},[257,5902,1799],{"class":267},[257,5904,2779],{"class":263},[257,5906,313],{"class":267},[257,5908,5909],{"class":259,"line":3128},[257,5910,5911],{"class":490},"        // for words, we just have to find the last space that is at least 3 characters in\n",[257,5913,5914,5916,5919,5921,5923,5925,5928,5930,5932,5934,5936,5938,5940,5942,5944,5946],{"class":259,"line":3153},[257,5915,2130],{"class":303},[257,5917,5918],{"class":271}," lastIndex",[257,5920,444],{"class":267},[257,5922,4330],{"class":271},[257,5924,450],{"class":267},[257,5926,5927],{"class":390},"lastIndexOf",[257,5929,418],{"class":319},[257,5931,664],{"class":267},[257,5933,281],{"class":267},[257,5935,534],{"class":267},[257,5937,4330],{"class":271},[257,5939,450],{"class":267},[257,5941,874],{"class":271},[257,5943,1605],{"class":267},[257,5945,327],{"class":326},[257,5947,551],{"class":319},[257,5949,5950,5952,5954,5957,5959,5961,5964,5966,5968,5970,5972,5974,5976,5978,5980,5982,5984,5987,5989],{"class":259,"line":3165},[257,5951,1137],{"class":263},[257,5953,560],{"class":319},[257,5955,5956],{"class":271},"lastIndex",[257,5958,2156],{"class":267},[257,5960,1605],{"class":267},[257,5962,5963],{"class":326},"1",[257,5965,1096],{"class":319},[257,5967,4271],{"class":271},[257,5969,848],{"class":319},[257,5971,4271],{"class":271},[257,5973,450],{"class":267},[257,5975,874],{"class":271},[257,5977,1605],{"class":267},[257,5979,3460],{"class":326},[257,5981,4665],{"class":319},[257,5983,310],{"class":267},[257,5985,5986],{"class":267}," `",[257,5988,4408],{"class":284},[257,5990,4680],{"class":267},[257,5992,5993,5996,5998,6000,6002,6004,6006,6008,6010,6012,6014,6016,6018,6020,6022,6024,6026,6028,6031,6033,6035],{"class":259,"line":3198},[257,5994,5995],{"class":263},"        else",[257,5997,4236],{"class":271},[257,5999,848],{"class":319},[257,6001,4271],{"class":271},[257,6003,450],{"class":267},[257,6005,874],{"class":271},[257,6007,1605],{"class":267},[257,6009,3460],{"class":326},[257,6011,4665],{"class":319},[257,6013,310],{"class":267},[257,6015,4670],{"class":267},[257,6017,4374],{"class":271},[257,6019,450],{"class":267},[257,6021,893],{"class":390},[257,6023,418],{"class":271},[257,6025,1751],{"class":326},[257,6027,534],{"class":267},[257,6029,6030],{"class":271}," lastIndex)",[257,6032,759],{"class":267},[257,6034,4408],{"class":284},[257,6036,4680],{"class":267},[257,6038,6039],{"class":259,"line":3207},[257,6040,1118],{"class":267},[257,6042,6043,6045,6047,6049,6051,6053,6055],{"class":259,"line":3214},[257,6044,674],{"class":263},[257,6046,4236],{"class":271},[257,6048,450],{"class":267},[257,6050,659],{"class":390},[257,6052,418],{"class":319},[257,6054,5228],{"class":267},[257,6056,551],{"class":319},[257,6058,6059],{"class":259,"line":3242},[257,6060,373],{"class":267},[95,6062,6064],{"id":6063},"further-potential-optimizations","Further Potential Optimizations",[942,6066,6068],{"id":6067},"pooling","Pooling",[70,6070,6071],{},"This is probably the next biggest optimization I could make and is something Pixi.js recommends for handling a lot of objects.",[70,6073,6074],{},"If we cache the text wrapping and truncation, we could re-use the same ~1000-2000 text objects and just overlay them over the visible cards. This, I think will give the most additional performance boost, but complicates things a lot. Even just keeping the existing structure and adding/removing the child text objects gets complicated. I have a rough draft and it is hard to read.",[942,6076,6078],{"id":6077},"others","Others",[85,6080,6081,6084,6087,6090],{},[88,6082,6083],{},"As mentioned at the start, all those optimizations that I avoided can be allowed to happen for a speedup.",[88,6085,6086],{},"I structured the app so we can potentially hook into document changes. That way instead of searching all notes for changes on updates, we can do surgically precise updates.",[88,6088,6089],{},"The wrapping indexes + truncation index could be saved with the document and/or view. Once saved, we can just pass a pre-split line to Pixi.js and avoid text wrapping entirely.",[88,6091,6092],{},"Due to how the app works, users can open multiple panes with the infinite canvas view. I will have to reduce the lod for unfocused instances past a certain note count to allow the focused / last focused canvas to stay performant.",[942,6094,6096],{"id":6095},"usability-improvements-future-features","Usability Improvements + Future Features",[85,6098,6099,6102,6105,6108],{},[88,6100,6101],{},"For \u003C 1000 we can probably just disable the different lod states.",[88,6103,6104],{},"To help with navigation, as mentioned, hovering over any note will show it in the corner - we can use a single object and just change it's text.",[88,6106,6107],{},"Selection of notes - this can be done via sprite tinting.",[88,6109,6110],{},"Movement - initially I had used a flat list because that would have made it easier to move notes but because we are now using a tree, this will require: hiding the note, creating a temporary copy that's on top of everything, then moving that.",[942,6112,6114],{"id":6113},"avoid","AVOID",[85,6116,6117],{},[88,6118,6119,6120,6123,6124,6127,6128,6131],{},"Do NOT use ",[254,6121,6122],{},"cacheAsTexture"," for the card with text. You're creating dozens of tiny textures which is pointless and worsens performance. If your notes are contained within some parant container of ",[103,6125,6126],{},"known"," size that is not too big (less than 4096x4096 pixels) it ",[103,6129,6130],{},"might"," help.",[5826,6133,6134],{},"html pre.shiki code .s7zQu, html code.shiki .s7zQu{--shiki-light:#39ADB5;--shiki-light-font-style:italic;--shiki-default:#89DDFF;--shiki-default-font-style:italic;--shiki-dark:#89DDFF;--shiki-dark-font-style:italic}html pre.shiki code .sMK4o, html code.shiki .sMK4o{--shiki-light:#39ADB5;--shiki-default:#89DDFF;--shiki-dark:#89DDFF}html pre.shiki code .sTEyZ, html code.shiki .sTEyZ{--shiki-light:#90A4AE;--shiki-default:#EEFFFF;--shiki-dark:#BABED8}html pre.shiki code .sfazB, html code.shiki .sfazB{--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D}html pre.shiki code .spNyl, html code.shiki .spNyl{--shiki-light:#9C3EDA;--shiki-default:#C792EA;--shiki-dark:#C792EA}html pre.shiki code .swJcz, html code.shiki .swJcz{--shiki-light:#E53935;--shiki-default:#F07178;--shiki-dark:#F07178}html pre.shiki code .sbssI, html code.shiki .sbssI{--shiki-light:#F76D47;--shiki-default:#F78C6C;--shiki-dark:#F78C6C}html pre.shiki code .s2Zo4, html code.shiki .s2Zo4{--shiki-light:#6182B8;--shiki-default:#82AAFF;--shiki-dark:#82AAFF}html pre.shiki code .sBMFI, html code.shiki .sBMFI{--shiki-light:#E2931D;--shiki-default:#FFCB6B;--shiki-dark:#FFCB6B}html pre.shiki code .sHdIc, html code.shiki .sHdIc{--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-default:#EEFFFF;--shiki-default-font-style:italic;--shiki-dark:#BABED8;--shiki-dark-font-style:italic}html pre.shiki code .sHwdD, html code.shiki .sHwdD{--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-default:#546E7A;--shiki-default-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic}html .light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html.light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html pre.shiki code .sfNiH, html code.shiki .sfNiH{--shiki-light:#FF5370;--shiki-default:#FF9CAC;--shiki-dark:#FF9CAC}html pre.shiki code .s6hCs, html code.shiki .s6hCs{--shiki-light:#9C3EDA;--shiki-light-font-style:italic;--shiki-default:#C792EA;--shiki-default-font-style:italic;--shiki-dark:#C792EA;--shiki-dark-font-style:italic}",{"title":252,"searchDepth":291,"depth":291,"links":6136},[6137,6138,6139,6140,6141,6142,6152],{"id":97,"depth":291,"text":98},{"id":147,"depth":291,"text":148},{"id":166,"depth":291,"text":167},{"id":182,"depth":291,"text":183},{"id":215,"depth":291,"text":216},{"id":939,"depth":291,"text":940,"children":6143},[6144,6145,6146,6147,6148,6149,6150,6151],{"id":944,"depth":297,"text":945},{"id":1231,"depth":297,"text":1232},{"id":1268,"depth":297,"text":1269},{"id":1954,"depth":297,"text":1955},{"id":1996,"depth":297,"text":1997},{"id":2013,"depth":297,"text":2014},{"id":2043,"depth":297,"text":2044},{"id":4104,"depth":297,"text":4105},{"id":6063,"depth":291,"text":6064,"children":6153},[6154,6155,6156,6157],{"id":6067,"depth":297,"text":6068},{"id":6077,"depth":297,"text":6078},{"id":6095,"depth":297,"text":6096},{"id":6113,"depth":297,"text":6114},"2026-02-02T00:00:00.000Z","A deep dive into the engineering behind Pyramid's infinite canvas and how to handle high-density layouts without sacrificing responsiveness â€” it covers texture baking, custom culling, background idle generation, efficient text handling, text truncation, and the dynamic LOD states required for massive datasets.","md","/thumbs/infinite-canvas-thumb.gif",[6163,6164,6165],"typescript","javascript","vue",{},"---\ntitle: Handling Thousands Cards on an Infinite Canvas\ndate: 2026-02-02T00:00:00.000Z\ndescription: A deep dive into the engineering behind Pyramid's infinite canvas and how to handle high-density layouts without sacrificing responsiveness â€” it covers texture baking, custom culling, background idle generation, efficient text handling, text truncation, and the dynamic LOD states required for massive datasets.\nimage: /thumbs/infinite-canvas-thumb.gif\nlangs:\n  - typescript\n  - javascript\n  - vue\npublished: true\nstatic_image: /thumbs/infinite-canvas-thumb.png\ntags:\n  - pyramid-app\n  - programming\n  - pixi.js\n  - performance\nvideo_image: /thumbs/infinite-canvas-thumb.mp4\n---\n\nI'm working on an app, [Pyramid Notes](https://pyramidnotes.com), which will have an infinite canvas.\n\nIt will have two modes mainly:\n\n- freeform mode - users can drop and place cards everywhere.\n- \"structured\" mode - with a preset layout. In this initial version, the layout will is a visualization of note tags (they function more like folders).\n\n## Initial DOM Based Attempt\n\nI had initially planned to create an HTML based infinite canvas as it's just easier to get started with, but the DOM approach has a lot of lag, *especially* when zooming, which was a deal breaker. I *needed* really fast zoom in/out performance.\n\nThe html version *was* a bit naively coded, but the same approach with pixi.js (webgl canvas lib) was 10x more performant. Properly optimized HTML starts lagging at around 1000 notes, my initial quick canvas implementation started lagging at around 10,000.\n\nHere is a link to [1000 notes on tldraw](https://www.tldraw.com/f/cTRjZahSxPYiXwM6Ws3yH?d=v10977.-651.19434.9393.page) (and the [blank version](https://www.tldraw.com/f/mEG6km2LEfSaAn7TD-JOO?d=v16327.1343.6034.3497.page)) which seems well optimized so you can see it's not me with a bad implementation.\n\n:video{autoplay controls muted src=\"/posts/infinite-canvas-tldraw-comparison.mp4\"}\n\nThere's just like a very sluggish feeling, especially zooming. I suspect the culprit might be shadows because they seem to get turned on/off at the point zoom feels sluggish, but I don't think there's any way around that. The blank version is clearly faster so some of it is the text itself rendering when very zoomed out, but I tried different lod levels in DOM, and the zoom range where they change *feels* slow. Sometimes canvas also skips a frame at that point but it doesn't feel nearly as bad.\n\n## Switching to Pixi.js\n\nOnce I switched to [pixi.js](https://pixijs.com/8.x/guides/getting-started/introduction), I was way too tempted to properly test the limits and see how many notes I could get to render.\n\nI setup some basic culling + lod states, and changed the layout structure (from flat to a tree) and got to around 50,000 notes before serious lagging, but I wanted to find the real limit. In part out of curiosity, in part to not attempt to load so many (users can limit what they load with a search filter).\n\nMind you, the 50,000 at that point was a bit of a lie because the notes weren't unique. I also made this mistake when I initially tweeted about reaching 100,000. See below for more details.\n\n## Actual Usage Expectations\n\nFrom what I've researched and from the number of notes I have myself, I expect the average user to probably have \\~1000-10,000 notes. As a maximum I can see maybe some power users will have 20-50,000.\n\nI don't expect >50,000 notes, but it is possible, depending on how they organize them, that they might need to render more since notes can appear more than once in the structured tree.\n\nI do not expect freeform mode to get nearly as big as notes must be added by hand.\n\n::md-emphasis-block\n## Limits Reached\n\nI ended up reaching about 60,000 unique cards before there started to be some minor lag (still snappier than the DOM approach), and 90,000 unique cards before it started to feel too sluggish. I reached 100,000 a few times, but past 95,000 the page would occasionally crash as it finished generating all the text.\n\nOne can sacrifice a bit of LOD to reach smoother 100,000, but I didn't like it. I think it's best to just warn the user to use a filter past 60,000. If they want to risk it they can (on chrome the crashes sometimes required I restart the entire browser ğŸ’€).\n\nHere's what 100,000 feels like, you can see it's starting to struggle:\n\n:video{autoplay controls muted src=\"/posts/inifite-canvas-100000.mp4\"}\n\nHere's 50,000 which feels super snappy (this was the thumb). 60,000 starts to occasionally skip a frame on zoom but still feels fast:\n\n:video{autoplay controls muted src=\"/posts/infinite-canvas-50000.mp4\"}\n\nI'm actually sure we could go *further* (see [#pooling](#pooling)) but I don't think the increase in code complexity is worth it.\n::\n\n## Avoiding Accidental Optimizations\n\nIt's easy to accidentally get performance speedups from how one sets up the test scenario.\n\nIn this case initially I only had 1000 unique notes and initially they were just repeated to get 50,000/100,000. I started like this because generating 50,000 real random documents is currently still super slow, I can only do about 300 docs max at a time. This is because generating a note requires generating a random prosemirror document and this was tricky to even get working.\n\nNow Pixi.js does caching internally to speed up scenerios with duplicate cards like this so I had to make adjustments to avoid all unreasonably performance optimizations and find the real number of *unique* notes I could render.\n\nI say unreasonable because some repitition is expected in every day use. To control the uniqueness and take more *reasonable* advantage of pixi's internal caches (it has per word (temporary), and per text), I generated 170,000 unique \"words\" (they're just random characters/symbols) and replaced the card text with random slices from those words.\n\nWhy 170,000? This is about how many words are actively in use in the english language. They are distributed randomly here, unlike a realistic distribution where some words appear way more than others, but that just means real usage will be slightly faster.\n\nHere's the code I used:\n\n::md-details\n```ts\nimport { faker } from \"@faker-js/faker\"\n\nexport const perfUtilsConfig = {\n    minWordLength: 3,\n    maxWordLength: 10,\n    uniqueWords: 170000,\n    uniqueNoteCount: 90000\n}\nconst seenWords = new Set\u003Cstring>()\nexport function createWords(count: number) {\n    const res = Array.from(\n        { length: count },\n        () => {\n            // i know faker has word generation, but I want random symbols included\n            let word = faker.string.sample({ min: perfUtilsConfig.minWordLength, max: perfUtilsConfig.maxWordLength })\n            while (seenWords.has(word)) {\n                word = faker.string.sample({ min: perfUtilsConfig.minWordLength, max: perfUtilsConfig.maxWordLength })\n            }\n            return word\n        }\n    ).join(\" \")\n    return res\n}\n// estimated number of english words in active use\nconst additionalText = createWords(perfUtilsConfig.uniqueWords)\nseenWords.clear()\n\nconst noteSlicePoints = Array.from({ length: perfUtilsConfig.uniqueNoteCount }).map(i => Math.floor(Math.random() * additionalText.length))\n// slice random bits from the text\nexport function generateText(max: number) {\n    const cut = noteSlicePoints[Math.floor(Math.random() * noteSlicePoints.length)]\n    const res = additionalText.slice(cut, cut + max)\n    return res\n}\n\n```\n::\n\nYou will see in the top right of videos, in the debug details it sayse `Uniqueness: [count]`, this is the number of unique cards generated. `Card Count` is the number of cards in the full tree. `In View` will show how many cards are actually in view.\n\n## Optimizations\n\n### Decoupled Reactive Lifecycle\n\nThe rendering loop is decoupled from vueâ€™s reactivity. Instead of immediately reacting to every state change, we set dirty flags and do the appropriate action on the next tick.\n\nI used a class (I did not have a good experience trying to figure out pixi-vue unfortunately) so watchers created here must be properly cleaned up (vue is not automatically aware of them like it is in SFCs).\n\n::md-details\n```ts\nclass PixiCanvas {\n\ttoDestroy = []\n\tonMounted() {\n\t\tlet layoutDirty = true\n\t\tthis.toDestroy.push(watch(this.layout, () => {\n\t\t\tlayoutDirty = true\n\t\t}).stop)\n\t\tapp.ticker.add(() => {\n\t\t\tif (layoutDirty) {\n\t\t\t\t// ...\n\t\t\t}\n\t\t})\n\t}\n\t\n\tdestroy() {\n\t\tif (!this.initialized) throw new Error(\"Pixi not initialized, cannot destroy.\")\n\t\tfor (const item of this.toDestroy) {\n\t\t\titem()\n\t\t}\n\t\t// textures should also be destroyed here\n\t\tthis.app.destroy()\n\t}\n}\n```\n::\n\n### Culling\n\nNaive culling is not enough, checking thousands of notes is too expensive.\n\n#### Take Advantage of Existing Structure\n\nIf your data is structured in any form of tree, take advantage of that even if it makes it harder to traverse/update the tree.\n\nIf a parent container is not visible, all children will be skipped making things way faster.\n\nFor the freeform mode, I plan to place them inside invisible containers/buckets to simulate this. The freeform layout will be saveable and we can cache the notes each bucket contains and we would only need to update this if a user moves a note.\n\n#### Use a Custom Algorithm If Needed\n\nI used a custom algorithm for two reasons:\n\nI already know how big the viewport will be before pixi loads. I can do the culling beforehand.\n\nI know the constraints of my layout. Nested areas are always contained within their parent, and notes are always contained by their areas. We can make optimizations based on this. For example, if the viewport is inside an area, only that area needs to be checked. All other areas can be immediately skipped.\n\nPixi does not do this internally because children can exist outside of their parent bounds.\n\n### Manual Texture Baking\n\nThis example demonstrates how to manually instruct the renderer to bake any display object (like a `Container` or `Graphics` object) into a reusable texture. This is highly efficient as the complex object is drawn only once.\n\n::md-details\n```ts\n// example for the full LOD card background\n\n// this is called once, then only again if the theme ref changes\ncreateTextures() {\n    // careful to give enough space if using shadows\n    const shadowPadding = 4 * 4\n    const container = new Container()\n\n    const shadowGraphic = new Graphics()\n        .roundRect(shadowPadding, shadowPadding, this.config.cardWidth, this.config.cardHeight, this.config.cardRounding)\n        .fill({\n            color: this.theme.value.note.shadow,\n            alpha: this.theme.value.note.shadowAlpha\n        })\n    shadowGraphic.filters = [new BlurFilter({ strength: 4, quality: 3, resolution: window.devicePixelRatio })]\n    container.addChild(shadowGraphic)\n\n    const cardGraphic = new Graphics()\n        .roundRect(shadowPadding, shadowPadding - 2, this.config.cardWidth, this.config.cardHeight, this.config.cardRounding)\n        .fill({ color: this.theme.value.note.bg })\n    container.addChild(cardGraphic)\n\n    this.cardFullTexture = this.app.renderer.generateTexture({\n        target: container,\n        frame: new Rectangle(0, 0, this.config.cardWidth + shadowPadding * 2, this.config.cardHeight + shadowPadding * 2)\n    })\n\n    // save the texture for later use\n    this.cardFullTexture = this.app.renderer.generateTexture({\n        target: container,\n        frame: new Rectangle(0, 0, this.config.cardWidth + shadowPadding * 2, this.config.cardHeight + shadowPadding * 2)\n    })\n}\n\n// later during the actual card creation:\nconst cardSprite = new Sprite(this.cardFullTexture)\n```\n::\n\nDo NOT attempt to cache the full card, only the background, see [#avoid](#avoid).\n\nThis is a bit more complicated for images. I have not added attachments yet, so that will be a problem for later.\n\n### Dynamic Level of Detail (LOD)\n\nAt full zoom cards show their titles and a short summary. Both require text wrapping and truncation which is *very* expensive.\n\nPast a certain zoom point cards become unreadable so thereâ€™s no point trying to render the text which is very expensive. We can just a simple skeleton, no text. And past that we have two options:\n\n- If the app has some other large features we can visualize (in this case cards exist bounding areas in \"structured\" mode), we can render those instead.\n- We can render a very small single color rectangle. Again, we can cache this. This is slower than rendering some larger feature, so avoid at all costs.\n\nUsing this strategy we can fit roughly 10,000 skeleton cards in view or 1000 full-view cards.\n\nThis with the full card zoom cut off point being *past* the point that I canâ€™t read it on a 4k screen (with the canvas resolution set to `window.devicePixelRatio`) which is the worst case scenario.\n\nSo the cutoff could be increased. It wouldn't look as nice though because even when we can't read the text, we can still get a sense of which note is which. Another option is to only hide the summary initially and only later the text.\n\nIn all cases, I will be adding a show-on-hover feature so users can quickly read any card they're hovering over.\n\n### Using Bitmap Text\n\nAs Pixi themselves suggest, use BitmapText instead of Text. ***This is absolutely vital past around 50,000 cards.*** It now supports word wrapping and it's easy to generate from a font, so it should suffice for most needs.\n\nThe only drawback is it's more expensive for languages with a lot of symbols (like chinese). I did a quick tests though and did not see much of a difference. Canvas still felt smooth enough and memory did not jump excessively. So good signs.\n\n### Loading and On-Demand Text Generation\n\nIf we tried to naively load and naively truncate (see below) the text of 100,000 cards on load it would take nearly 30 seconds with all optimizations.\n\nInstead, on load, the card layout is created without any text. When the user zooms we generate the text on demand only when they need the full text LOD.\n\nThe generation is limited per so we donâ€™t attempt to create the text for 1000 cards all at once.\n\nWe check how much time we have left and hand that ms budge over to `generateCardText` which will handle not exceeding it.\n\nBatching like this also helps give the user a visual indication that cards *are* getting loaded.\n\nFull example combined with idle generation below.\n\n### Background Idle Generation\n\nThe canvas loads zoomed out. This gives us some time, between load, and the user zooming/panning to where they want. We can use `requestIdleCallback` to start generating the card text regardless of visibility. This means for most users (less than \u003C 10000 cards which take 3 seconds to load) they probably wonâ€™t even see the text get generated, itâ€™ll just be there.\n\nHere's the code combining the on demand generation with the idle generation.\n\n::md-details\n```ts\nonMounted() {\n    // ... initial setup\n\n    // visibilityDirty and docsDirty are set by vue watchers\n\n    app.ticker.add(() => {\n\n        this.updateLodState() // calculates the lod state\n        const canGenerateText = !firstTick && this.lodState.value === \"full\" && this.pendingTextGeneration.size > 0\n        const start =  canGenerateText ? performance.now() : undefined\n\n        if (visibilityDirty) {\n            visibilityDirty = false\n            this.updateQueuesAndCulling()\n        }\n        if (docsDirty) {\n            docsDirty = false\n            this.updateTree()\n            this.initBackgroundQueue()\n            this.scheduleTextGeneration()\n        }\n\n        if (canGenerateText) {\n            const now = performance.now()\n            // budget is a little lower than the real 16ms just in case\n            const budget = 13 - (now - start!)\n            this.generateCardText(this.pendingTextGeneration, \"visible\", { startTime: now, budget })\n        }\n    })\n}\n\n\n// we combine these actions because they both happen together and need to both iterate through the same data\nupdateQueuesAndCulling() {\n    const { visibleNotes, visibleAreas } = this.visible.value\n\n    this.updateVisibleAreas(visibleAreas)\n\n    const showFullText = this.lodState.value === \"full\"\n    const cardLodVisible = this.lodState.value !== \"noCards\"\n\n    for (const [path, card] of this.noteSprites) {\n        const isVisible = visibleNotes.has(path)\n        const titleText = card.getChildByLabel(\"title-text\") as Text\n        const textAlreadyGenerated = titleText.text !== \"\"\n\n        card.visible = isVisible && cardLodVisible\n\n        if (!textAlreadyGenerated) {\n            if (isVisible && showFullText) {\n                this.backgroundPendingTextGeneration.delete(card)\n                this.pendingTextGeneration.add(card)\n            } else {\n                this.pendingTextGeneration.delete(card)\n                this.backgroundPendingTextGeneration.add(card)\n            }\n        } else {\n            this.pendingTextGeneration.delete(card)\n            this.backgroundPendingTextGeneration.delete(card)\n        }\n    }\n\n    const cards = visibleNotes.keys()\n        .map(path => this.noteSprites.get(path)!).filter(_ => !!_)\n    this.updateCardsLodState(cards)\n}\n\n\n// initially, queue up all cards that don't have text yet\ninitBackgroundQueue() {\n    for (const card of allNoteSprites) {\n        if (card.text === \"\") {\n            backgroundPendingTextGeneration.add(card);\n        }\n    }\n}\n\n// create the function that actually schedules the work\nscheduleTextGeneration() {\n    if (this.backgroundPendingTextGeneration.size > 0 && this.idleCallbackId === null) {\n        this.idleCallbackId = requestIdleCallback((deadline) => {\n            this.idleCallbackId = null\n            this.generateCardText(this.backgroundPendingTextGeneration, \"background\", { deadline })\n            this.scheduleTextGeneration()\n        })\n    } else if (this.backgroundPendingTextGeneration.size === 0) {\n        // generation finished\n    }\n}\n\n/** Generate text for cards from a pending queue with a deadline or a time budget. */\ngenerateCardText(\n    pending: Set\u003CContainer>,\n    type: \"visible\" | \"background\",\n    {\n        deadline,\n        budget,\n        startTime\n    }: {\n        deadline?: IdleDeadline\n        startTime?: number\n        budget?: number\n    } = {}\n) {\n    \n    if (pending.size === 0) return\n\n    // the 1 is the aproximate time the truncation takes\n    if (budget !== undefined && budget \u003C= 1) return\n\n    const isVisible = type === \"visible\"\n\n    const iterator = pending.values()\n    let generated = 0\n\n    while (pending.size > 0) {\n        if (budget !== undefined && isVisible && (performance.now() - startTime!) >= budget - 1) {\n            break\n        }\n        if (deadline && deadline.timeRemaining() \u003C= 1) {\n            break\n        }\n        const next = iterator.next()\n        if (next.done) break\n\n        const card = next.value as Container\n\n        pending.delete(card)\n\n        if (type === \"visible\") {\n            this.backgroundPendingTextGeneration.delete(card)\n            // skip if card became invisible or LOD changed\n            if (!card.visible || this.lodState.value !== \"full\") {\n                continue\n            }\n        } else if (type === \"background\" && this.pendingTextGeneration.has(card)) {\n            continue\n        }\n\n        const titleText = card.getChildByLabel(\"title-text\") as Text\n        // const summaryText = ...\n        const doc = this.getDoc(card.label)\n        // doc might have been deleted by the time we get here\n        if (!doc) continue\n\n        generated++\n\n        titleText.text = PixiCanvas.truncatePixiText( doc.title, /* ... */)\n        // summaryText.text = PixiCanvas.truncatePixiText( ... )\n\n        if (card.visible && this.lodState.value === \"full\") {\n            // set visibility of elements\n        }\n    }\n}\n```\n::\n\n### Faster Text Truncation\n\nInitially I just looked up how to do text truncation and found this snippet on the [repo](https://github.com/pixijs/pixijs/issues/3449#issuecomment-428648004) which you'll probably come across if searching for how to do this. Hereâ€™s the modified version I initially used:\n\n::md-details\n```ts\n/** Truncates text to a specific number of lines using PixiJS TextMetrics */\nstatic truncatePixiText(\n    /** The raw string to truncate */\n    text: string,\n    /** PixiJS TextStyle object or configuration */\n    style: TextStyle,\n    /** Maximum number of lines allowed before truncation */\n    maxLines: number\n): string {\n    if (maxLines === Infinity) {\n        return text\n    }\n\n    const wordWrapWidth = style.wordWrapWidth\n    const { lines } = CanvasTextMetrics.measureText(text, style)\n\n    if (lines.length \u003C= maxLines) {\n        return text\n    }\n\n    const truncatedLines = lines.slice(0, maxLines)\n    const lastLine = truncatedLines[truncatedLines.length - 1]\n\n    const chars = Array.from(lastLine)\n\n    // measure the ellipsis and each character individually\n    const charMetrics = CanvasTextMetrics.measureText(`...\\n${chars.join(\"\\n\")}`, style)\n    const [dotsLength, ...charLengths] = charMetrics.lineWidths\n\n    let newLastLine = \"\";\n    let currentLength = dotsLength;\n\n    for (let i = 0; i \u003C charLengths.length; i++) {\n        const charLength = charLengths[i];\n\n        if (currentLength + charLength >= wordWrapWidth) {\n            break; \n        }\n\n        newLastLine += chars[i];\n        currentLength += charLength;\n    }\n\n    truncatedLines[truncatedLines.length - 1] = `${newLastLine}...`\n    return truncatedLines.join(\"\\n\")\n}\n```\n::\n\nAs you can see this text truncation function requires two measurements. First, based on the text style, it measures how many lines the wrapped text produces. Then, it takes the line and measure character by character to see where to cut it (the original measured by word, I wanted by character, both are slow).\n\nPixi does tons of caching internally, but it's just a slow thing to calculate. It's also specially slow with regular `Text` (which I was using at the beginning).\n\nSo how to speed this up (apart from using `BitmapText`)? See if you can spot it before reading on. The biggest performance gain feels a bit obvious once you see it.\n\nSome low hanging fruit first, if you have long note summaries that aren't already truncated, it's measuring all that text which won't be visible.\n\n#### Optimization 1 - Limiting Text Length\n\nI measured the smallest character (usually a space) and calculated how many we could fit in a card.\n\nWe can then use this to limit how much text we even try to truncate. This should also done as soon as we can after we receive the data to avoid keeping the full summary in memory.\n\n#### Optimization 2 - Avoiding the Second Measurement\n\nWe want to avoid the second measurement of the characters at all costs.\n\nI tried caching the measurements of individual characters to calculate the aproximate width of the last line myself. Pixi is already technically doing this but it doesn't keep the cache around between calls. That was faster, but still slow.\n\nI considered using a monospace font even though I didn't like the idea of being restricted to monospace fonts.\n\nI asked the LLMs. They added a third measurement call just to rage bait me, and I went back to thinking.\n\nAnd then I saw it.\n\nWhen pixi does the first measurement, it also chops up the line, and we know what text is on which line and how long it is already! ğŸ¤¦\n\nNow, `.` is usually the shortest character in a font (and if not, we should pick a font where it is).\n\nSo when a line needs an ellipsis **all** the last characters we need to chop off are wider than a period. When we replace them, the line is always guaranteed to be shorter.\n\nFor example, say we want max 2 lines:\n\n```ts\n         cutoff â”€â”\n                 ğŸ­­ \nSome long text we want to truncate\n            \n// pixi will wrap it to:\n                 ğŸ­­ \nSome long text\nwe want to truncate\n\n// and we want:\n                 ğŸ­­ \nSome long text\nwe want to trun...\n```\n\nWith a non-monospace font, here's how they compare:\n\n> we want to truncate\n>\n> we want to trun...\n\nThe truncated line is always shorter.\n\nIf we want truncation at the word level, we can just find the first space that's at least 3 characters in.\n\nHere's the final code which takes about 20% less time.\n\nThis version supports both Text and BitmapText. As mentioned above bitmap support is crucial as otherwise regular text is still too slow even with this speedup.\n\n::md-details\n```ts\n/**\n* Truncates text to a specific number of lines using PixiJS TextMetrics.\n*\n* Uses lots of optimizations and caching to make this as fast as possible.\n*\n* IMPORTANT: Be sure to pre-slice the text if it can get very long.\n*/\nstatic truncatePixiText(\n    /** The raw string to truncate */\n    text: string,\n    /** PixiJS TextStyle object or configuration */\n    style: TextStyle,\n    /** Whether to use the bitmap text measuring method or the canvas text measuring method. Words will NOT wrap right if you use the wrong one. */\n    isBitmapFont: boolean = true,\n    /** Maximum number of lines allowed before truncation */\n    maxLines: number,\n    /** Since we recommend slicing the text, we can't be sure if there are more lines or not and whether to add an ellipsis to the last line.\n    * @default false\n    */\n    containsMoreLines: boolean = false,\n    /** Pass a cached width. */\n    ellipsisWidth?: number\n): string {\n    if (maxLines === Infinity) {\n        return text\n    }\n\n    const wordWrapWidth = style.wordWrapWidth\n\n    let lineWidths = []\n    let lines = []\n    if (isBitmapFont) {\n        const measure = BitmapFontManager.getLayout(text, style, true)\n\n        for (let i = 0; i \u003C measure.lines.length && i \u003C maxLines; i++) {\n                const line = measure.lines[i]\n                const chars = line.chars.join(\"\")\n                if (chars.length === 0 && i === measure.lines.length - 1) {\n                    // last line is always empty, idk why\n                    break\n                }\n                lineWidths.push(line.width * measure.scale)\n                lines.push(line.chars.join(\"\"))\n        }\n    } else {\n        const measure = CanvasTextMetrics.measureText(text, style)\n        lineWidths = measure.lineWidths\n        lines = measure.lines.slice(0, maxLines)\n    }\n    if (lines.length \u003C maxLines) {\n        return text\n    }\n    const lastLine = lines[lines.length - 1]\n\n    if (ellipsisWidth === undefined) {\n        if (isBitmapFont) {\n                const measure = BitmapFontManager.getLayout(\"...\", style, true)\n                ellipsisWidth = measure.width * measure.scale\n        } else {\n                ellipsisWidth = CanvasTextMetrics.measureText(\"...\", style).width\n        }\n    }\n    const ellipsisDontFit = ellipsisWidth > wordWrapWidth\n    if (ellipsisDontFit) {\n        lines[lines.length - 1] = \"\"\n        return lines.join(\"\")\n    }\n\n    // this is a stylistic choice\n    const shouldAddEllipsis = (containsMoreLines || lines.length > lines.length) && !lastLine.endsWith(\".\")\n\n    if (lineWidths[lineWidths.length - 1] + ellipsisWidth \u003C wordWrapWidth && !shouldAddEllipsis) {\n        return lines.join(\"\")\n    }\n\n    if (style.breakWords) {\n        // dots happen to be the shortest width character in most fonts\n        // so we can just cut off the last 3 characters and add the ellipsis\n        lines[lines.length - 1] = `${lastLine.slice(0, lastLine.length - 3)}...`\n    } else {\n        // for words, we just have to find the last space that is at least 3 characters in\n        const lastIndex = lastLine.lastIndexOf(\" \", lastLine.length - 3)\n        if (lastIndex === -1) lines[lines.length - 1] = `...`\n        else lines[lines.length - 1] = `${lastLine.slice(0, lastIndex)}...`\n    }\n    return lines.join(\"\")\n}\n```\n::\n\n## Further Potential Optimizations\n\n### Pooling\n\nThis is probably the next biggest optimization I could make and is something Pixi.js recommends for handling a lot of objects.\n\nIf we cache the text wrapping and truncation, we could re-use the same \\~1000-2000 text objects and just overlay them over the visible cards. This, I think will give the most additional performance boost, but complicates things a lot. Even just keeping the existing structure and adding/removing the child text objects gets complicated. I have a rough draft and it is hard to read.\n\n### Others\n\n- As mentioned at the start, all those optimizations that I avoided can be allowed to happen for a speedup.\n- I structured the app so we can potentially hook into document changes. That way instead of searching all notes for changes on updates, we can do surgically precise updates.\n- The wrapping indexes + truncation index could be saved with the document and/or view. Once saved, we can just pass a pre-split line to Pixi.js and avoid text wrapping entirely.\n- Due to how the app works, users can open multiple panes with the infinite canvas view. I will have to reduce the lod for unfocused instances past a certain note count to allow the focused / last focused canvas to stay performant.\n\n### Usability Improvements + Future Features\n\n- For \u003C 1000 we can probably just disable the different lod states.\n- To help with navigation, as mentioned, hovering over any note will show it in the corner - we can use a single object and just change it's text.\n- Selection of notes - this can be done via sprite tinting.\n- Movement - initially I had used a flat list because that would have made it easier to move notes but because we are now using a tree, this will require: hiding the note, creating a temporary copy that's on top of everything, then moving that.\n\n### AVOID\n\n- Do NOT use `cacheAsTexture` for the card with text. You're creating dozens of tiny textures which is pointless and worsens performance. If your notes are contained within some parant container of *known* size that is not too big (less than 4096x4096 pixels) it *might* help.\n",{"title":34,"description":6159},"/thumbs/infinite-canvas-thumb.png",[6171,6172,156,3578],"pyramid-app","programming","/thumbs/infinite-canvas-thumb.mp4","xOdJCikSwATp-vhmoEXeKsvrkSrPp1NpZpYxYhdpRDM",{"id":6176,"title":50,"body":6177,"date":6479,"description":252,"extension":6160,"image":57,"langs":6480,"meta":6481,"navigation":60,"path":51,"published":60,"rawbody":6482,"seo":6483,"static_image":57,"stem":52,"tags":6484,"video_image":57,"__hash__":6486},"blog/blog/zig-testing.md",{"type":67,"value":6178,"toc":6475},[6179,6188,6198,6204,6207,6214,6217,6221,6231,6237,6263,6267,6270,6362,6370,6379,6466,6472],[70,6180,6181,6182,6187],{},"I have been dabbling with ",[74,6183,6186],{"href":6184,"rel":6185},"https://ziglang.org/",[78],"Zig"," lately, and I wanted to add some tests to my tiny project, but this was a bit harder than I thought and the docs on this are sparse. so I thought I'd properly document it.",[70,6189,6190,6191,6194,6195,450],{},"First, you probably want ",[254,6192,6193],{},"zig build test"," where test is the build step. Not ",[254,6196,6197],{},"zig test",[70,6199,6200,6201,6203],{},"Still, even if you have a test step and you ran ",[254,6202,6193],{},", you might have been puzzled that no tests were running.",[70,6205,6206],{},"And if you were using dependencies, you might have gotten an error like this:",[247,6208,6212],{"className":6209,"code":6211,"language":2664},[6210],"language-text","no module named '...' available within module root\n",[254,6213,6211],{"__ignoreMap":252},[70,6215,6216],{},"Several things are going on here.",[95,6218,6220],{"id":6219},"adding-all-tests","Adding ALL Tests",[70,6222,6223,6224,6226,6227,6230],{},"If you run ",[254,6225,6193],{}," it will only run tests in the given ",[254,6228,6229],{},"root_source_file",", so if you have no tests in main, they won't run.",[70,6232,6233,6234,323],{},"You can get around this with the following magical incantation in ",[254,6235,6236],{},"src/main.zig",[247,6238,6242],{"className":6239,"code":6240,"language":6241,"meta":252,"style":252},"language-zig shiki shiki-themes material-theme-lighter material-theme material-theme-palenight","test {\n    // include all tests in imported modules, recursively\n    @import(\"std\").testing.refAllDeclsRecursive(@This());\n}\n","zig",[254,6243,6244,6249,6254,6259],{"__ignoreMap":252},[257,6245,6246],{"class":259,"line":260},[257,6247,6248],{},"test {\n",[257,6250,6251],{"class":259,"line":291},[257,6252,6253],{},"    // include all tests in imported modules, recursively\n",[257,6255,6256],{"class":259,"line":297},[257,6257,6258],{},"    @import(\"std\").testing.refAllDeclsRecursive(@This());\n",[257,6260,6261],{"class":259,"line":316},[257,6262,373],{},[95,6264,6266],{"id":6265},"sharing-modules-with-the-build-step","Sharing Modules with the Build Step",[70,6268,6269],{},"The other error is because when you do this:",[247,6271,6273],{"className":6239,"code":6272,"language":6241,"meta":252,"style":252},"const exe = b.addExecutable(.{\n    .name = \"foot\",\n    .root_source_file = b.path(\"src/main.zig\"),\n    .target = target,\n    .optimize = optimize,\n});\n\nexe.root_module.addImport(...); \n\n// ... \n\nconst tests = b.addTest(.{\n    .root_source_file = b.path(\"src/main.zig\"),\n    .target = target,\n    .optimize = optimize,\n});\n\nconst test_step = b.step(\"test\", \"Run tests.\");\ntest_step.dependOn(&b.addRunArtifact(tests).step);\n",[254,6274,6275,6280,6285,6290,6295,6300,6305,6309,6314,6318,6323,6327,6332,6336,6340,6344,6348,6352,6357],{"__ignoreMap":252},[257,6276,6277],{"class":259,"line":260},[257,6278,6279],{},"const exe = b.addExecutable(.{\n",[257,6281,6282],{"class":259,"line":291},[257,6283,6284],{},"    .name = \"foot\",\n",[257,6286,6287],{"class":259,"line":297},[257,6288,6289],{},"    .root_source_file = b.path(\"src/main.zig\"),\n",[257,6291,6292],{"class":259,"line":316},[257,6293,6294],{},"    .target = target,\n",[257,6296,6297],{"class":259,"line":333},[257,6298,6299],{},"    .optimize = optimize,\n",[257,6301,6302],{"class":259,"line":346},[257,6303,6304],{},"});\n",[257,6306,6307],{"class":259,"line":359},[257,6308,294],{"emptyLinePlaceholder":60},[257,6310,6311],{"class":259,"line":370},[257,6312,6313],{},"exe.root_module.addImport(...); \n",[257,6315,6316],{"class":259,"line":376},[257,6317,294],{"emptyLinePlaceholder":60},[257,6319,6320],{"class":259,"line":407},[257,6321,6322],{},"// ... \n",[257,6324,6325],{"class":259,"line":435},[257,6326,294],{"emptyLinePlaceholder":60},[257,6328,6329],{"class":259,"line":459},[257,6330,6331],{},"const tests = b.addTest(.{\n",[257,6333,6334],{"class":259,"line":476},[257,6335,6289],{},[257,6337,6338],{"class":259,"line":487},[257,6339,6294],{},[257,6341,6342],{"class":259,"line":494},[257,6343,6299],{},[257,6345,6346],{"class":259,"line":554},[257,6347,6304],{},[257,6349,6350],{"class":259,"line":582},[257,6351,294],{"emptyLinePlaceholder":60},[257,6353,6354],{"class":259,"line":630},[257,6355,6356],{},"const test_step = b.step(\"test\", \"Run tests.\");\n",[257,6358,6359],{"class":259,"line":636},[257,6360,6361],{},"test_step.dependOn(&b.addRunArtifact(tests).step);\n",[70,6363,6364,6367,6368,450],{},[254,6365,6366],{},"tests.root_module"," has no imports added, so it can't find them. You would have to also add them all to ",[254,6369,6366],{},[70,6371,6372,6373,6378],{},"The good news is zig 0.14.0 added the following feature to avoid this duplication, see ",[74,6374,6377],{"href":6375,"rel":6376},"https://github.com/ziglang/zig/pull/20388",[78],"#20388",". Now you can create a module and pass it both to the exe and to tests:",[247,6380,6382],{"className":6239,"code":6381,"language":6241,"meta":252,"style":252},"const main_module = b.createModule(.{\n    .root_source_file = b.path(\"src/main.zig\"),\n    .target = target,\n    .optimize = optimize,\n});\n\nconst exe = b.addExecutable(.{\n    .name = \"foot\",\n    .root_module = main_module,\n});\n\nexe.root_module.addImport(...); \n\n// ... \nconst tests = b.addTest(.{\n    .root_module = main_module,\n});\n\nconst test_step = b.step(\"test\", \"Run tests.\");\ntest_step.dependOn(&b.addRunArtifact(tests).step);\n",[254,6383,6384,6389,6393,6397,6401,6405,6409,6413,6417,6422,6426,6430,6434,6438,6442,6446,6450,6454,6458,6462],{"__ignoreMap":252},[257,6385,6386],{"class":259,"line":260},[257,6387,6388],{},"const main_module = b.createModule(.{\n",[257,6390,6391],{"class":259,"line":291},[257,6392,6289],{},[257,6394,6395],{"class":259,"line":297},[257,6396,6294],{},[257,6398,6399],{"class":259,"line":316},[257,6400,6299],{},[257,6402,6403],{"class":259,"line":333},[257,6404,6304],{},[257,6406,6407],{"class":259,"line":346},[257,6408,294],{"emptyLinePlaceholder":60},[257,6410,6411],{"class":259,"line":359},[257,6412,6279],{},[257,6414,6415],{"class":259,"line":370},[257,6416,6284],{},[257,6418,6419],{"class":259,"line":376},[257,6420,6421],{},"    .root_module = main_module,\n",[257,6423,6424],{"class":259,"line":407},[257,6425,6304],{},[257,6427,6428],{"class":259,"line":435},[257,6429,294],{"emptyLinePlaceholder":60},[257,6431,6432],{"class":259,"line":459},[257,6433,6313],{},[257,6435,6436],{"class":259,"line":476},[257,6437,294],{"emptyLinePlaceholder":60},[257,6439,6440],{"class":259,"line":487},[257,6441,6322],{},[257,6443,6444],{"class":259,"line":494},[257,6445,6331],{},[257,6447,6448],{"class":259,"line":554},[257,6449,6421],{},[257,6451,6452],{"class":259,"line":582},[257,6453,6304],{},[257,6455,6456],{"class":259,"line":630},[257,6457,294],{"emptyLinePlaceholder":60},[257,6459,6460],{"class":259,"line":636},[257,6461,6356],{},[257,6463,6464],{"class":259,"line":645},[257,6465,6361],{},[70,6467,6468,6469,6471],{},"Now ",[254,6470,6193],{}," should run all tests and give no missing module errors.",[5826,6473,6474],{},"html .light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html.light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}",{"title":252,"searchDepth":291,"depth":291,"links":6476},[6477,6478],{"id":6219,"depth":291,"text":6220},{"id":6265,"depth":291,"text":6266},"2025-02-15T00:00:00.000Z",[6241],{},"---\ntitle: \"How To Add Tests To A Zig Project\"\ndate: \"2025-02-15\"\npublished: true\ntags: [\"testing\"]\nlangs: [\"zig\"]\ndescription: \"\"\n---\n\n\nI have been dabbling with [Zig](https://ziglang.org/) lately, and I wanted to add some tests to my tiny project, but this was a bit harder than I thought and the docs on this are sparse. so I thought I'd properly document it.\n\nFirst, you probably want `zig build test` where test is the build step. Not `zig test`.\n\nStill, even if you have a test step and you ran `zig build test`, you might have been puzzled that no tests were running.\n\nAnd if you were using dependencies, you might have gotten an error like this:\n\n```\nno module named '...' available within module root\n```\n\nSeveral things are going on here.\n\n## Adding ALL Tests\n\nIf you run `zig build test` it will only run tests in the given `root_source_file`, so if you have no tests in main, they won't run.\n\nYou can get around this with the following magical incantation in `src/main.zig`:\n\n```zig\ntest {\n    // include all tests in imported modules, recursively\n    @import(\"std\").testing.refAllDeclsRecursive(@This());\n}\n```\n\n## Sharing Modules with the Build Step\n\nThe other error is because when you do this:\n\n```zig\nconst exe = b.addExecutable(.{\n\t.name = \"foot\",\n\t.root_source_file = b.path(\"src/main.zig\"),\n\t.target = target,\n\t.optimize = optimize,\n});\n\nexe.root_module.addImport(...); \n\n// ... \n\nconst tests = b.addTest(.{\n\t.root_source_file = b.path(\"src/main.zig\"),\n\t.target = target,\n\t.optimize = optimize,\n});\n\nconst test_step = b.step(\"test\", \"Run tests.\");\ntest_step.dependOn(&b.addRunArtifact(tests).step);\n```\n\n`tests.root_module` has no imports added, so it can't find them. You would have to also add them all to `tests.root_module`.\n\n\nThe good news is zig 0.14.0 added the following feature to avoid this duplication, see [#20388](https://github.com/ziglang/zig/pull/20388). Now you can create a module and pass it both to the exe and to tests:\n\n```zig\nconst main_module = b.createModule(.{\n\t.root_source_file = b.path(\"src/main.zig\"),\n\t.target = target,\n\t.optimize = optimize,\n});\n\nconst exe = b.addExecutable(.{\n\t.name = \"foot\",\n\t.root_module = main_module,\n});\n\nexe.root_module.addImport(...); \n\n// ... \nconst tests = b.addTest(.{\n\t.root_module = main_module,\n});\n\nconst test_step = b.step(\"test\", \"Run tests.\");\ntest_step.dependOn(&b.addRunArtifact(tests).step);\n```\n\nNow `zig build test` should run all tests and give no missing module errors.\n",{"title":50,"description":252},[6485],"testing","h7NrxtGRc_JZC_tpRorguyS7DnRgdjjrFNreeZF89RM",{"id":6488,"title":22,"body":6489,"date":6672,"description":6673,"extension":6160,"image":57,"langs":6674,"meta":6676,"navigation":60,"path":23,"published":60,"rawbody":6677,"seo":6678,"static_image":57,"stem":24,"tags":6679,"video_image":57,"__hash__":6682},"blog/blog/dynamic-tailwind.md",{"type":67,"value":6490,"toc":6670},[6491,6502,6505,6508,6511,6517,6569,6580,6590,6642,6658,6664,6667],[70,6492,6493,6494,6497,6498,6501],{},"Have you ever wanted to do ",[254,6495,6496],{},"p-[${someDynamicValue}]"," in tailwind? Or maybe the more complicated ",[254,6499,6500],{},"after:content-[${someDynamicValue}]","? Here's a better solution than resorting to a style tag.",[6503,6504],"hr",{},[70,6506,6507],{},"Tailwind cannot have dynamic values in it's classes because the stylesheets are compiled at build time, neither the class name nor the value can be made up of dynamic variables for this to work.",[70,6509,6510],{},"This can be a bit of a pain in certain situations. One obvious solution is to move back to a style tag, but this means now the styles aren't all in one place, the main selling point of tailwind.",[70,6512,6513,6514,6516],{},"For certain situations, like ",[254,6515,6496],{}," we can fallback to the style property:",[247,6518,6521],{"className":6519,"code":6520,"language":6165,"meta":252,"style":252},"language-vue shiki shiki-themes material-theme-lighter material-theme material-theme-palenight","\u003C!-- I'm using vue here, but all frameworks have a way to do this. -->\n\u003Cdiv\n    :style=\"`padding:${someDynamicValue}`\"\n>\u003C/div>\n",[254,6522,6523,6528,6535,6558],{"__ignoreMap":252},[257,6524,6525],{"class":259,"line":260},[257,6526,6527],{"class":490},"\u003C!-- I'm using vue here, but all frameworks have a way to do this. -->\n",[257,6529,6530,6532],{"class":259,"line":291},[257,6531,394],{"class":267},[257,6533,6534],{"class":319},"div\n",[257,6536,6537,6540,6542,6544,6547,6550,6552,6555],{"class":259,"line":297},[257,6538,6539],{"class":267},"    :",[257,6541,5826],{"class":303},[257,6543,310],{"class":267},[257,6545,6546],{"class":267},"\"`",[257,6548,6549],{"class":284},"padding:",[257,6551,4414],{"class":267},[257,6553,6554],{"class":271},"someDynamicValue",[257,6556,6557],{"class":267},"}`\"\n",[257,6559,6560,6563,6566],{"class":259,"line":316},[257,6561,6562],{"class":267},">\u003C/",[257,6564,6565],{"class":319},"div",[257,6567,6568],{"class":267},">\n",[70,6570,6571,6572,6575,6576,6579],{},"But this is not always the case. Take ",[254,6573,6574],{},"after:content[${someDynamicValue}]",". ",[2004,6577,6578],{},"Style tags cannot target psuedo-elements",", we have to resort to a style tag, or do we?",[70,6581,6582,6589],{},[2004,6583,6584,6585,6588],{},"Style tags ",[103,6586,6587],{},"can"," have inline css variables."," So we can actually do this:",[247,6591,6593],{"className":6519,"code":6592,"language":6165,"meta":252,"style":252},"\u003Cdiv\n    class=\"after:p-[var(--customPadding)]\"\n    :style=\"`--customPadding:${someDynamicValue}`\"\n>\u003C/div>\n",[254,6594,6595,6601,6615,6634],{"__ignoreMap":252},[257,6596,6597,6599],{"class":259,"line":260},[257,6598,394],{"class":267},[257,6600,6534],{"class":319},[257,6602,6603,6606,6608,6610,6613],{"class":259,"line":291},[257,6604,6605],{"class":303},"    class",[257,6607,310],{"class":267},[257,6609,664],{"class":267},[257,6611,6612],{"class":284},"after:p-[var(--customPadding)]",[257,6614,288],{"class":267},[257,6616,6617,6619,6621,6623,6625,6628,6630,6632],{"class":259,"line":297},[257,6618,6539],{"class":267},[257,6620,5826],{"class":303},[257,6622,310],{"class":267},[257,6624,6546],{"class":267},[257,6626,6627],{"class":284},"--customPadding:",[257,6629,4414],{"class":267},[257,6631,6554],{"class":271},[257,6633,6557],{"class":267},[257,6635,6636,6638,6640],{"class":259,"line":316},[257,6637,6562],{"class":267},[257,6639,6565],{"class":319},[257,6641,6568],{"class":267},[70,6643,6644,6645,6648,6649,6652,6653,450],{},"Tailwind can now happily compile the class, it's name is no longer dynamic, it's ",[254,6646,6647],{},".after\\:p-\\[var\\(--customPadding\\)\\]"," and it's value is no longer dynamic, it's ",[254,6650,6651],{},"var(--customPadding)",". The part of the outputted css that we care about looks like this, here's a link to a ",[74,6654,6657],{"href":6655,"rel":6656},"https://play.tailwindcss.com/RcEotAgwA9?file=css",[78],"demo on the playground",[247,6659,6662],{"className":6660,"code":6661,"language":2664},[6210],".after\\:p-\\[var\\(--customPadding\\)\\]::after {\n    padding: var(--customPadding)\n    //...\n}\n",[254,6663,6661],{"__ignoreMap":252},[70,6665,6666],{},"And we can change the css variable to whatever we need. It's also very easy to find where the custom value was declared.",[5826,6668,6669],{},"html pre.shiki code .sHwdD, html code.shiki .sHwdD{--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-default:#546E7A;--shiki-default-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic}html pre.shiki code .sMK4o, html code.shiki .sMK4o{--shiki-light:#39ADB5;--shiki-default:#89DDFF;--shiki-dark:#89DDFF}html pre.shiki code .swJcz, html code.shiki .swJcz{--shiki-light:#E53935;--shiki-default:#F07178;--shiki-dark:#F07178}html pre.shiki code .spNyl, html code.shiki .spNyl{--shiki-light:#9C3EDA;--shiki-default:#C792EA;--shiki-dark:#C792EA}html pre.shiki code .sfazB, html code.shiki .sfazB{--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D}html pre.shiki code .sTEyZ, html code.shiki .sTEyZ{--shiki-light:#90A4AE;--shiki-default:#EEFFFF;--shiki-dark:#BABED8}html .light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html.light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}",{"title":252,"searchDepth":291,"depth":291,"links":6671},[],"2023-10-08T00:00:00.000Z","Have you ever wanted to do `p-[${someDynamicValue}]` in tailwind? Or maybe the more complicated `after:content-[${someDynamicValue}]`? Here's a better solution than resorting to a style tag.",[6675,6165],"css",{},"---\ntitle: \"How to use Dynamic Variables with Tailwind\"\ndate: \"2023-10-08\"\npublished: true\ntags: [\"tip\", \"tailwind\"]\nlangs: [\"css\", \"vue\"]\ndescription: \"Have you ever wanted to do `p-[${someDynamicValue}]` in tailwind? Or maybe the more complicated `after:content-[${someDynamicValue}]`? Here's a better solution than resorting to a style tag.\"\n---\nHave you ever wanted to do `p-[${someDynamicValue}]` in tailwind? Or maybe the more complicated `after:content-[${someDynamicValue}]`? Here's a better solution than resorting to a style tag.\n\n---\n\nTailwind cannot have dynamic values in it's classes because the stylesheets are compiled at build time, neither the class name nor the value can be made up of dynamic variables for this to work.\n\nThis can be a bit of a pain in certain situations. One obvious solution is to move back to a style tag, but this means now the styles aren't all in one place, the main selling point of tailwind.\n\nFor certain situations, like `p-[${someDynamicValue}]` we can fallback to the style property:\n\n```vue\n\u003C!-- I'm using vue here, but all frameworks have a way to do this. -->\n\u003Cdiv\n\t:style=\"`padding:${someDynamicValue}`\"\n>\u003C/div>\n```\n\n\nBut this is not always the case. Take `after:content[${someDynamicValue}]`. **Style tags cannot target psuedo-elements**, we have to resort to a style tag, or do we?\n\n**Style tags *can* have inline css variables.** So we can actually do this:\n\n```vue\n\u003Cdiv\n\tclass=\"after:p-[var(--customPadding)]\"\n\t:style=\"`--customPadding:${someDynamicValue}`\"\n>\u003C/div>\n```\n\nTailwind can now happily compile the class, it's name is no longer dynamic, it's `.after\\:p-\\[var\\(--customPadding\\)\\]` and it's value is no longer dynamic, it's `var(--customPadding)`. The part of the outputted css that we care about looks like this, here's a link to a [demo on the playground](https://play.tailwindcss.com/RcEotAgwA9?file=css). \n\n```\n.after\\:p-\\[var\\(--customPadding\\)\\]::after {\n\tpadding: var(--customPadding)\n\t//...\n}\n```\n\nAnd we can change the css variable to whatever we need. It's also very easy to find where the custom value was declared.\n",{"title":22,"description":6673},[6680,6681],"tip","tailwind","lBueOukL5RGjeHbl6EDPRSTVZIGclrKxTzcje5z2DSg",{"id":6684,"title":46,"body":6685,"date":8245,"description":8246,"extension":6160,"image":8247,"langs":8248,"meta":8249,"navigation":60,"path":47,"published":60,"rawbody":8250,"seo":8251,"static_image":57,"stem":48,"tags":8252,"video_image":57,"__hash__":8254},"blog/blog/tailwind-rocks.md",{"type":67,"value":6686,"toc":8234},[6687,6690,6693,6696,6704,6707,6710,6728,6737,6740,6743,6759,7059,7062,7124,7130,7200,7203,7206,7349,7352,7355,7358,7361,7364,7373,7384,7387,7398,7404,7407,7469,7473,7476,7479,7530,7533,7536,7599,7602,7611,7622,7697,7700,7759,7762,7829,7832,7851,7854,8009,8013,8016,8020,8043,8061,8065,8073,8076,8086,8090,8097,8132,8139,8143,8146,8191,8195,8198,8231],[70,6688,6689],{},"My first impression of tailwind was ğŸ¤®, css in html, not this again. What about seperation of concerns! When I looked at examples they just looked like some sort of class soup. The first example has to be scrolled because the lines are so long! Utility functions are a nice idea I'd been toying with adopting, but surely this went to far?",[70,6691,6692],{},"I had looked into other css frameworks but it was easier to just roll my own than customize a utility framework so I didn't. I'd been toying with a theme management system / variable generator for apps, so using someone else's variables did not make sense. For a while I just used css with the variables my package produced to keep a consistent design.",[70,6694,6695],{},"Tailwind just seemed like another utility based css library that wouldn't benefit me very much.",[70,6697,6698,6699],{},"But after seeing it praised again and again, I had to try it. ",[74,6700,6703],{"href":6701,"rel":6702},"https://tailwindcss.com/docs/utility-first#:~:text=you%20have%20to%20actually%20try%20it",[78],"The docs are not wrong about this.",[70,6705,6706],{},"I tried it on a complicated component library to really battle test it and I finally understood what all the praise was about.",[70,6708,6709],{},"It's not just the points you hear all the time. There were also some things that aren't obvious on first glance that I really liked:",[85,6711,6712,6715,6722,6725],{},[88,6713,6714],{},"It's very easy to customize and make custom plugins.",[88,6716,6717,6718,6721],{},"You can quickly use custom values when you need them (e.g. ",[254,6719,6720],{},"border-[calc(...)]",").",[88,6723,6724],{},"Many utility functions do more than one thing and make it easy to do common things that tend to bloat css.",[88,6726,6727],{},"Predictable application and overriding of styles (assuming the use of something like tailwind-merge).",[70,6729,6730,6731,6736],{},"It's hard to believe, but these all add up to make the class soup actually far exceed my previous scss in simplicity, readability, and maintainability. The ",[74,6732,6735],{"href":6733,"rel":6734},"https://tailwindcss.com/docs/utility-first",[78],"link above"," shows this to some extent but I did not even see this until I actually decided to try tailwind. It really should be one of the first things you see.",[70,6738,6739],{},"Also you don't have to put it all in one line! Why is it like that in so many examples, ğŸ˜­?",[70,6741,6742],{},"You can still write very readable styles if you want. And once you get a hang for the basic utility classes (this does not take as long as you'd think), the intent of the styles is far far clearer.",[70,6744,6745,6746,6748,6749,6758],{},"Here's my own example. Where before in a my component library might have css that looked something like this (and yes, I know the ",[103,6747,6675],{}," could be simplified, but in exchange for verbosity elsewhere",[6750,6751,6752],"sup",{},[74,6753,5963],{"href":6754,"ariaDescribedBy":6755,"dataFootnoteRef":252,"id":6757},"#user-content-fn-1",[6756],"footnote-label","user-content-fnref-1","):",[247,6760,6764],{"className":6761,"code":6762,"language":6763,"meta":252,"style":252},"language-scss shiki shiki-themes material-theme-lighter material-theme material-theme-palenight",".component {\n    padding: 0 var(--padding-s);\n    background: var(--color-bg-el) ;\n    &.border {\n        border: var(--border-width) solid var(--color-border);\n        &:focus { border-color: var(--color-border-focus) ;}\n    }\n    &:focus { color: var(--color-text-focus) ; }\n    &.disabled { background: var(--color-bg-disabled); }\n    &.disabled:focus { color: var(--color-text-disabled);}\n    &.border.disabled:focus { border-color: var(--color-border-focus) ;}\n}\n.wraper {\n    .component.disabled.border & {\n        text-decoration-line: line-through;\n    }\n}\n","scss",[254,6765,6766,6775,6796,6815,6827,6856,6885,6889,6918,6946,6974,7006,7010,7019,7039,7051,7055],{"__ignoreMap":252},[257,6767,6768,6770,6773],{"class":259,"line":260},[257,6769,450],{"class":267},[257,6771,6772],{"class":397},"component",[257,6774,313],{"class":267},[257,6776,6777,6781,6783,6785,6788,6790,6793],{"class":259,"line":291},[257,6778,6780],{"class":6779},"sqsOY","    padding",[257,6782,323],{"class":267},[257,6784,1756],{"class":326},[257,6786,6787],{"class":390}," var",[257,6789,418],{"class":267},[257,6791,6792],{"class":271},"--padding-s",[257,6794,6795],{"class":267},");\n",[257,6797,6798,6801,6803,6805,6807,6810,6812],{"class":259,"line":297},[257,6799,6800],{"class":6779},"    background",[257,6802,323],{"class":267},[257,6804,6787],{"class":390},[257,6806,418],{"class":267},[257,6808,6809],{"class":271},"--color-bg-el",[257,6811,430],{"class":267},[257,6813,6814],{"class":267}," ;\n",[257,6816,6817,6820,6822,6825],{"class":259,"line":316},[257,6818,6819],{"class":397},"    &",[257,6821,450],{"class":267},[257,6823,6824],{"class":397},"border",[257,6826,313],{"class":267},[257,6828,6829,6832,6834,6836,6838,6841,6843,6846,6849,6851,6854],{"class":259,"line":333},[257,6830,6831],{"class":6779},"        border",[257,6833,323],{"class":267},[257,6835,6787],{"class":390},[257,6837,418],{"class":267},[257,6839,6840],{"class":271},"--border-width",[257,6842,430],{"class":267},[257,6844,6845],{"class":271}," solid ",[257,6847,6848],{"class":390},"var",[257,6850,418],{"class":267},[257,6852,6853],{"class":271},"--color-border",[257,6855,6795],{"class":267},[257,6857,6858,6861,6863,6866,6868,6871,6873,6875,6877,6880,6882],{"class":259,"line":346},[257,6859,6860],{"class":397},"        &",[257,6862,323],{"class":267},[257,6864,6865],{"class":303},"focus",[257,6867,268],{"class":267},[257,6869,6870],{"class":6779}," border-color",[257,6872,323],{"class":267},[257,6874,6787],{"class":390},[257,6876,418],{"class":267},[257,6878,6879],{"class":271},"--color-border-focus",[257,6881,430],{"class":267},[257,6883,6884],{"class":267}," ;}\n",[257,6886,6887],{"class":259,"line":359},[257,6888,1118],{"class":267},[257,6890,6891,6893,6895,6897,6899,6901,6903,6905,6907,6910,6912,6915],{"class":259,"line":370},[257,6892,6819],{"class":397},[257,6894,323],{"class":267},[257,6896,6865],{"class":303},[257,6898,268],{"class":267},[257,6900,1653],{"class":6779},[257,6902,323],{"class":267},[257,6904,6787],{"class":390},[257,6906,418],{"class":267},[257,6908,6909],{"class":271},"--color-text-focus",[257,6911,430],{"class":267},[257,6913,6914],{"class":267}," ;",[257,6916,6917],{"class":267}," }\n",[257,6919,6920,6922,6924,6927,6929,6932,6934,6936,6938,6941,6944],{"class":259,"line":376},[257,6921,6819],{"class":397},[257,6923,450],{"class":267},[257,6925,6926],{"class":397},"disabled",[257,6928,268],{"class":267},[257,6930,6931],{"class":6779}," background",[257,6933,323],{"class":267},[257,6935,6787],{"class":390},[257,6937,418],{"class":267},[257,6939,6940],{"class":271},"--color-bg-disabled",[257,6942,6943],{"class":267},");",[257,6945,6917],{"class":267},[257,6947,6948,6950,6952,6954,6956,6958,6960,6962,6964,6966,6968,6971],{"class":259,"line":407},[257,6949,6819],{"class":397},[257,6951,450],{"class":267},[257,6953,6926],{"class":397},[257,6955,323],{"class":267},[257,6957,6865],{"class":303},[257,6959,268],{"class":267},[257,6961,1653],{"class":6779},[257,6963,323],{"class":267},[257,6965,6787],{"class":390},[257,6967,418],{"class":267},[257,6969,6970],{"class":271},"--color-text-disabled",[257,6972,6973],{"class":267},");}\n",[257,6975,6976,6978,6980,6982,6984,6986,6988,6990,6992,6994,6996,6998,7000,7002,7004],{"class":259,"line":435},[257,6977,6819],{"class":397},[257,6979,450],{"class":267},[257,6981,6824],{"class":397},[257,6983,450],{"class":267},[257,6985,6926],{"class":397},[257,6987,323],{"class":267},[257,6989,6865],{"class":303},[257,6991,268],{"class":267},[257,6993,6870],{"class":6779},[257,6995,323],{"class":267},[257,6997,6787],{"class":390},[257,6999,418],{"class":267},[257,7001,6879],{"class":271},[257,7003,430],{"class":267},[257,7005,6884],{"class":267},[257,7007,7008],{"class":259,"line":459},[257,7009,373],{"class":267},[257,7011,7012,7014,7017],{"class":259,"line":476},[257,7013,450],{"class":267},[257,7015,7016],{"class":397},"wraper",[257,7018,313],{"class":267},[257,7020,7021,7024,7026,7028,7030,7032,7034,7037],{"class":259,"line":487},[257,7022,7023],{"class":267},"    .",[257,7025,6772],{"class":397},[257,7027,450],{"class":267},[257,7029,6926],{"class":397},[257,7031,450],{"class":267},[257,7033,6824],{"class":397},[257,7035,7036],{"class":397}," &",[257,7038,313],{"class":267},[257,7040,7041,7044,7046,7049],{"class":259,"line":494},[257,7042,7043],{"class":6779},"        text-decoration-line",[257,7045,323],{"class":267},[257,7047,7048],{"class":271}," line-through",[257,7050,3054],{"class":267},[257,7052,7053],{"class":259,"line":554},[257,7054,1118],{"class":267},[257,7056,7057],{"class":259,"line":582},[257,7058,373],{"class":267},[70,7060,7061],{},"with html (vue) that looked like this:",[247,7063,7067],{"className":7064,"code":7065,"language":7066,"meta":252,"style":252},"language-vue-html shiki shiki-themes material-theme-lighter material-theme material-theme-palenight","\u003Cdiv\n    :class=\"classes\"\n>\n    \u003Cdiv class=\"wrapper\"/>\n\u003C/div>\n","vue-html",[254,7068,7069,7075,7089,7093,7115],{"__ignoreMap":252},[257,7070,7071,7073],{"class":259,"line":260},[257,7072,394],{"class":267},[257,7074,6534],{"class":319},[257,7076,7077,7080,7082,7084,7087],{"class":259,"line":291},[257,7078,7079],{"class":303},"    :class",[257,7081,310],{"class":267},[257,7083,664],{"class":267},[257,7085,7086],{"class":284},"classes",[257,7088,288],{"class":267},[257,7090,7091],{"class":259,"line":297},[257,7092,6568],{"class":267},[257,7094,7095,7098,7100,7103,7105,7107,7110,7112],{"class":259,"line":316},[257,7096,7097],{"class":267},"    \u003C",[257,7099,6565],{"class":319},[257,7101,7102],{"class":303}," class",[257,7104,310],{"class":267},[257,7106,664],{"class":267},[257,7108,7109],{"class":284},"wrapper",[257,7111,664],{"class":267},[257,7113,7114],{"class":267},"/>\n",[257,7116,7117,7120,7122],{"class":259,"line":333},[257,7118,7119],{"class":267},"\u003C/",[257,7121,6565],{"class":319},[257,7123,6568],{"class":267},[70,7125,7126,7127,7129],{},"Where ",[254,7128,7086],{}," was a computed red in setup, often abstracted away to a function for common states:",[247,7131,7135],{"className":7132,"code":7133,"language":7134,"meta":252,"style":252},"language-js shiki shiki-themes material-theme-lighter material-theme material-theme-palenight","const classes = computed(() => ({\n    disabled: props.disabled,\n    border: props.border\n    ...\n}))\n","js",[254,7136,7137,7159,7175,7189,7194],{"__ignoreMap":252},[257,7138,7139,7141,7144,7146,7149,7151,7153,7155,7157],{"class":259,"line":260},[257,7140,379],{"class":303},[257,7142,7143],{"class":271}," classes ",[257,7145,310],{"class":267},[257,7147,7148],{"class":390}," computed",[257,7150,418],{"class":271},[257,7152,986],{"class":267},[257,7154,482],{"class":303},[257,7156,560],{"class":271},[257,7158,579],{"class":267},[257,7160,7161,7164,7166,7169,7171,7173],{"class":259,"line":291},[257,7162,7163],{"class":319},"    disabled",[257,7165,323],{"class":267},[257,7167,7168],{"class":271}," props",[257,7170,450],{"class":267},[257,7172,6926],{"class":271},[257,7174,330],{"class":267},[257,7176,7177,7180,7182,7184,7186],{"class":259,"line":297},[257,7178,7179],{"class":319},"    border",[257,7181,323],{"class":267},[257,7183,7168],{"class":271},[257,7185,450],{"class":267},[257,7187,7188],{"class":271},"border\n",[257,7190,7191],{"class":259,"line":316},[257,7192,7193],{"class":267},"    ...\n",[257,7195,7196,7198],{"class":259,"line":333},[257,7197,759],{"class":267},[257,7199,5343],{"class":271},[70,7201,7202],{},"Seperation of concerns, right...",[70,7204,7205],{},"Now with tailwind, after a bit of experimenting and the help of tailwind merge I can have html (vue) that looks like this. Same number of css rules.",[247,7207,7209],{"className":7064,"code":7208,"language":7066,"meta":252,"style":252},"    \u003Cdiv\n        :class=\"twMerge(`\n            p-3\n            bg-neutral-50\n            focus:text-blue-500\n            `,\n            border && `\n                border\n                border-neutral-900\n                focus:border-blue-500\n            `,\n            disabled && `\n                bg-neutral-300\n                focus:text-neutral-500\n            `,\n            border && disabled && `\n                border-neutral-500\n            `)\"\n    >\n        \u003Cdiv :class=\"disabled && `line-through`\">\u003Cdiv>\n    \u003C/div>\n",[254,7210,7211,7217,7229,7234,7239,7244,7249,7254,7259,7264,7269,7273,7278,7283,7288,7292,7297,7302,7309,7314,7340],{"__ignoreMap":252},[257,7212,7213,7215],{"class":259,"line":260},[257,7214,7097],{"class":267},[257,7216,6534],{"class":319},[257,7218,7219,7222,7224,7226],{"class":259,"line":291},[257,7220,7221],{"class":303},"        :class",[257,7223,310],{"class":267},[257,7225,664],{"class":267},[257,7227,7228],{"class":284},"twMerge(`\n",[257,7230,7231],{"class":259,"line":297},[257,7232,7233],{"class":284},"            p-3\n",[257,7235,7236],{"class":259,"line":316},[257,7237,7238],{"class":284},"            bg-neutral-50\n",[257,7240,7241],{"class":259,"line":333},[257,7242,7243],{"class":284},"            focus:text-blue-500\n",[257,7245,7246],{"class":259,"line":346},[257,7247,7248],{"class":284},"            `,\n",[257,7250,7251],{"class":259,"line":359},[257,7252,7253],{"class":284},"            border && `\n",[257,7255,7256],{"class":259,"line":370},[257,7257,7258],{"class":284},"                border\n",[257,7260,7261],{"class":259,"line":376},[257,7262,7263],{"class":284},"                border-neutral-900\n",[257,7265,7266],{"class":259,"line":407},[257,7267,7268],{"class":284},"                focus:border-blue-500\n",[257,7270,7271],{"class":259,"line":435},[257,7272,7248],{"class":284},[257,7274,7275],{"class":259,"line":459},[257,7276,7277],{"class":284},"            disabled && `\n",[257,7279,7280],{"class":259,"line":476},[257,7281,7282],{"class":284},"                bg-neutral-300\n",[257,7284,7285],{"class":259,"line":487},[257,7286,7287],{"class":284},"                focus:text-neutral-500\n",[257,7289,7290],{"class":259,"line":494},[257,7291,7248],{"class":284},[257,7293,7294],{"class":259,"line":554},[257,7295,7296],{"class":284},"            border && disabled && `\n",[257,7298,7299],{"class":259,"line":582},[257,7300,7301],{"class":284},"                border-neutral-500\n",[257,7303,7304,7307],{"class":259,"line":630},[257,7305,7306],{"class":284},"            `)",[257,7308,288],{"class":267},[257,7310,7311],{"class":259,"line":636},[257,7312,7313],{"class":267},"    >\n",[257,7315,7316,7319,7321,7324,7326,7328,7331,7333,7336,7338],{"class":259,"line":645},[257,7317,7318],{"class":267},"        \u003C",[257,7320,6565],{"class":319},[257,7322,7323],{"class":303}," :class",[257,7325,310],{"class":267},[257,7327,664],{"class":267},[257,7329,7330],{"class":284},"disabled && `line-through`",[257,7332,664],{"class":267},[257,7334,7335],{"class":267},">\u003C",[257,7337,6565],{"class":319},[257,7339,6568],{"class":267},[257,7341,7342,7345,7347],{"class":259,"line":651},[257,7343,7344],{"class":267},"    \u003C/",[257,7346,6565],{"class":319},[257,7348,6568],{"class":267},[70,7350,7351],{},"And that's it.",[70,7353,7354],{},"There is no more jumping to the js or the css to look things up.",[70,7356,7357],{},"All styles will apply predictably. It's clear what's happening, which classes are being applied when. With the help of tailwind merge we can rely on order and use variables like in the example to avoid specificity issues.*.",[70,7359,7360],{},"Just a breath of fresh air.",[70,7362,7363],{},"Even with one style per line for readability I have managed to shrink the file size of ALL the components I converted.",[70,7365,7366,7367,7372],{},"I only now have two sections to worry about now, the logic, and the presentation. I've come to understand that presentation is invariably linked to state, and separating the css actually always makes things more painful. The creator of tailwind actually mentions this in the ",[74,7368,7371],{"href":7369,"rel":7370},"https://adamwathan.me/css-utility-classes-and-separation-of-concerns/",[78],"blog post"," where he made the arguments for tailwind on it's release, and I had read this before, but it never sunk in how painful this was until I wasn't experiencing the pain anymore.",[70,7374,7375,7376,450],{},"I was actually surprised how much faster I could style things (~3x) even when I had to have the tailwind docs pinned to lookup stuff and my tailwind autocomplete was not working well",[6750,7377,7378],{},[74,7379,7383],{"href":7380,"ariaDescribedBy":7381,"dataFootnoteRef":252,"id":7382},"#user-content-fn-2",[6756],"user-content-fnref-2","2",[70,7385,7386],{},"I've come to appreciate how easy it can do things that used to take multiple lines.",[70,7388,7389,7390,7397],{},"Take for example ",[74,7391,7394],{"href":7392,"rel":7393},"https://tailwindcss.com/docs/text-overflow#truncate",[78],[254,7395,7396],{},"truncate"," which does:",[247,7399,7402],{"className":7400,"code":7401,"language":2664},[6210],"overflow: hidden;\ntext-overflow: ellipsis;\nwhite-space: nowrap;\n",[254,7403,7401],{"__ignoreMap":252},[70,7405,7406],{},"Or gradients! If there's one thing I hate, it's writing css gradients. But in tailwind it's super simple, even with complex stops and everything:",[247,7408,7410],{"className":7064,"code":7409,"language":7066,"meta":252,"style":252},"\u003Cdiv class=\"bg-gradient-to-r from-white to-black\"/>\n\u003Cdiv class=\"\n    bg-gradient-to-r\n    from-white from-10%\n    via-blue-500 via-20%\n    to-black to-50%\n\"/>\n",[254,7411,7412,7431,7443,7448,7453,7458,7463],{"__ignoreMap":252},[257,7413,7414,7416,7418,7420,7422,7424,7427,7429],{"class":259,"line":260},[257,7415,394],{"class":267},[257,7417,6565],{"class":319},[257,7419,7102],{"class":303},[257,7421,310],{"class":267},[257,7423,664],{"class":267},[257,7425,7426],{"class":284},"bg-gradient-to-r from-white to-black",[257,7428,664],{"class":267},[257,7430,7114],{"class":267},[257,7432,7433,7435,7437,7439,7441],{"class":259,"line":291},[257,7434,394],{"class":267},[257,7436,6565],{"class":319},[257,7438,7102],{"class":303},[257,7440,310],{"class":267},[257,7442,288],{"class":267},[257,7444,7445],{"class":259,"line":297},[257,7446,7447],{"class":284},"    bg-gradient-to-r\n",[257,7449,7450],{"class":259,"line":316},[257,7451,7452],{"class":284},"    from-white from-10%\n",[257,7454,7455],{"class":259,"line":333},[257,7456,7457],{"class":284},"    via-blue-500 via-20%\n",[257,7459,7460],{"class":259,"line":346},[257,7461,7462],{"class":284},"    to-black to-50%\n",[257,7464,7465,7467],{"class":259,"line":359},[257,7466,664],{"class":267},[257,7468,7114],{"class":267},[95,7470,7472],{"id":7471},"tailwind-merge","* Tailwind Merge",[70,7474,7475],{},"But, tailwind merge is a MUST for complex applications and component libraries to avoid specificity issues. The reason why is that while tailwind cannot escape the css selector specificity problem completely, in fact we loose a bit of control.",[70,7477,7478],{},"See in regular css, if I have two selectors with equal specificity, the last one will win (note that this helps avoid the mess of having many variants and states):",[247,7480,7483],{"className":7481,"code":7482,"language":6675,"meta":252,"style":252},"language-css shiki shiki-themes material-theme-lighter material-theme material-theme-palenight",".input {\n    &.border:focus {...}\n    &.disabled:focus {...}\n}\n",[254,7484,7485,7494,7508,7526],{"__ignoreMap":252},[257,7486,7487,7489,7492],{"class":259,"line":260},[257,7488,450],{"class":267},[257,7490,7491],{"class":397},"input",[257,7493,313],{"class":267},[257,7495,7496,7499,7501,7503,7506],{"class":259,"line":291},[257,7497,7498],{"class":271},"    &.",[257,7500,6824],{"class":6779},[257,7502,323],{"class":267},[257,7504,7505],{"class":271},"focus {...",[257,7507,373],{"class":267},[257,7509,7510,7512,7514,7516,7518,7520,7522,7524],{"class":259,"line":297},[257,7511,6819],{"class":271},[257,7513,450],{"class":267},[257,7515,6926],{"class":397},[257,7517,323],{"class":267},[257,7519,6865],{"class":303},[257,7521,268],{"class":267},[257,7523,4408],{"class":271},[257,7525,373],{"class":267},[257,7527,7528],{"class":259,"line":316},[257,7529,373],{"class":271},[70,7531,7532],{},"In tailwind, you DO NOT have control over the order. The order of the classes is irrelevant, BUT the order tailwind declares them in the stylesheets is and this cannot be controlled (since a single rule might be used in many components).",[70,7534,7535],{},"If you do this, depending on what colors you picked, the style might or might not apply on disabled:",[247,7537,7539],{"className":7064,"code":7538,"language":7066,"meta":252,"style":252},"\u003Cdiv\n    :class=\"\n        border && `\n        border\n        border-red-500` +\n        disabled && `\n        border-neutral-500\n    `\"\n>\n\u003C/div>\n",[254,7540,7541,7547,7555,7560,7565,7570,7575,7580,7587,7591],{"__ignoreMap":252},[257,7542,7543,7545],{"class":259,"line":260},[257,7544,394],{"class":267},[257,7546,6534],{"class":319},[257,7548,7549,7551,7553],{"class":259,"line":291},[257,7550,7079],{"class":303},[257,7552,310],{"class":267},[257,7554,288],{"class":267},[257,7556,7557],{"class":259,"line":297},[257,7558,7559],{"class":284},"        border && `\n",[257,7561,7562],{"class":259,"line":316},[257,7563,7564],{"class":284},"        border\n",[257,7566,7567],{"class":259,"line":333},[257,7568,7569],{"class":284},"        border-red-500` +\n",[257,7571,7572],{"class":259,"line":346},[257,7573,7574],{"class":284},"        disabled && `\n",[257,7576,7577],{"class":259,"line":359},[257,7578,7579],{"class":284},"        border-neutral-500\n",[257,7581,7582,7585],{"class":259,"line":370},[257,7583,7584],{"class":284},"    `",[257,7586,288],{"class":267},[257,7588,7589],{"class":259,"line":376},[257,7590,6568],{"class":267},[257,7592,7593,7595,7597],{"class":259,"line":407},[257,7594,7119],{"class":267},[257,7596,6565],{"class":319},[257,7598,6568],{"class":267},[70,7600,7601],{},"Another thing I've seen done is using data attributes which looks cleaner and will seem to work at first, but this is because the data attributes are adding specificity to the selector, +1 for each data attribute.",[70,7603,7604,7605,7610],{},"Here's a ",[74,7606,7609],{"href":7607,"rel":7608},"https://specificity.keegan.st/",[78],"specificity calculator"," you can use to see this.",[70,7612,7613,7614,7617,7618,7621],{},"Tailwind data attribute variants create the following selectors: ",[254,7615,7616],{},"{ESCAPED_NAME}:[data-border=\"true\"]:[...]"," you can input ",[254,7619,7620],{},".class:[data]:[data]"," to quickly test, it would be the same thing.",[247,7623,7625],{"className":7064,"code":7624,"language":7066,"meta":252,"style":252},"\u003Cdiv\n    :data-border=\"border\"\n    :data-disabled=\"disabled\"\n    class=\"\n        data-[border=true]:border\n        data-[border=true]:border-red-500\n        data-[border=true]:data-[disabled]:border-neutral-500\n    \">\n\u003C/div>\n\n",[254,7626,7627,7633,7646,7659,7667,7672,7677,7682,7689],{"__ignoreMap":252},[257,7628,7629,7631],{"class":259,"line":260},[257,7630,394],{"class":267},[257,7632,6534],{"class":319},[257,7634,7635,7638,7640,7642,7644],{"class":259,"line":291},[257,7636,7637],{"class":303},"    :data-border",[257,7639,310],{"class":267},[257,7641,664],{"class":267},[257,7643,6824],{"class":284},[257,7645,288],{"class":267},[257,7647,7648,7651,7653,7655,7657],{"class":259,"line":297},[257,7649,7650],{"class":303},"    :data-disabled",[257,7652,310],{"class":267},[257,7654,664],{"class":267},[257,7656,6926],{"class":284},[257,7658,288],{"class":267},[257,7660,7661,7663,7665],{"class":259,"line":316},[257,7662,6605],{"class":303},[257,7664,310],{"class":267},[257,7666,288],{"class":267},[257,7668,7669],{"class":259,"line":333},[257,7670,7671],{"class":284},"        data-[border=true]:border\n",[257,7673,7674],{"class":259,"line":346},[257,7675,7676],{"class":284},"        data-[border=true]:border-red-500\n",[257,7678,7679],{"class":259,"line":359},[257,7680,7681],{"class":284},"        data-[border=true]:data-[disabled]:border-neutral-500\n",[257,7683,7684,7687],{"class":259,"line":370},[257,7685,7686],{"class":267},"    \"",[257,7688,6568],{"class":267},[257,7690,7691,7693,7695],{"class":259,"line":376},[257,7692,7119],{"class":267},[257,7694,6565],{"class":319},[257,7696,6568],{"class":267},[70,7698,7699],{},"You can easily run into the following problem, where these have equal specificity (2):",[247,7701,7703],{"className":7064,"code":7702,"language":7066,"meta":252,"style":252},"\u003Cbutton\n    :data-primary=\"primary\"\n    class=\"\n        data-[primary=true]:text-white\n        focus:text=blue-200\n    \">\n\u003C/button>\n\n",[254,7704,7705,7712,7726,7734,7739,7744,7750],{"__ignoreMap":252},[257,7706,7707,7709],{"class":259,"line":260},[257,7708,394],{"class":267},[257,7710,7711],{"class":319},"button\n",[257,7713,7714,7717,7719,7721,7724],{"class":259,"line":291},[257,7715,7716],{"class":303},"    :data-primary",[257,7718,310],{"class":267},[257,7720,664],{"class":267},[257,7722,7723],{"class":284},"primary",[257,7725,288],{"class":267},[257,7727,7728,7730,7732],{"class":259,"line":297},[257,7729,6605],{"class":303},[257,7731,310],{"class":267},[257,7733,288],{"class":267},[257,7735,7736],{"class":259,"line":316},[257,7737,7738],{"class":284},"        data-[primary=true]:text-white\n",[257,7740,7741],{"class":259,"line":333},[257,7742,7743],{"class":284},"        focus:text=blue-200\n",[257,7745,7746,7748],{"class":259,"line":346},[257,7747,7686],{"class":267},[257,7749,6568],{"class":267},[257,7751,7752,7754,7757],{"class":259,"line":359},[257,7753,7119],{"class":267},[257,7755,7756],{"class":319},"button",[257,7758,6568],{"class":267},[70,7760,7761],{},"Or worse, here the text will never change on focus when the button is primary and has a border because that has a specificity of 3.",[247,7763,7765],{"className":7064,"code":7764,"language":7066,"meta":252,"style":252},"\u003Cbutton\n    :data-primary=\"primary\"\n    :data-border=\"border\"\n    class=\"\n        data-[border=true]:data-[primary=true]:text-white\n        focus:text-blue-200\n    \">\n\u003C/button>\n",[254,7766,7767,7773,7785,7797,7805,7810,7815,7821],{"__ignoreMap":252},[257,7768,7769,7771],{"class":259,"line":260},[257,7770,394],{"class":267},[257,7772,7711],{"class":319},[257,7774,7775,7777,7779,7781,7783],{"class":259,"line":291},[257,7776,7716],{"class":303},[257,7778,310],{"class":267},[257,7780,664],{"class":267},[257,7782,7723],{"class":284},[257,7784,288],{"class":267},[257,7786,7787,7789,7791,7793,7795],{"class":259,"line":297},[257,7788,7637],{"class":303},[257,7790,310],{"class":267},[257,7792,664],{"class":267},[257,7794,6824],{"class":284},[257,7796,288],{"class":267},[257,7798,7799,7801,7803],{"class":259,"line":316},[257,7800,6605],{"class":303},[257,7802,310],{"class":267},[257,7804,288],{"class":267},[257,7806,7807],{"class":259,"line":333},[257,7808,7809],{"class":284},"        data-[border=true]:data-[primary=true]:text-white\n",[257,7811,7812],{"class":259,"line":346},[257,7813,7814],{"class":284},"        focus:text-blue-200\n",[257,7816,7817,7819],{"class":259,"line":359},[257,7818,7686],{"class":267},[257,7820,6568],{"class":267},[257,7822,7823,7825,7827],{"class":259,"line":370},[257,7824,7119],{"class":267},[257,7826,7756],{"class":319},[257,7828,6568],{"class":267},[70,7830,7831],{},"At this point you must pick a solution. You can:",[85,7833,7834,7841,7848],{},[88,7835,7836,7837,7840],{},"Add an important ",[254,7838,7839],{},"focus:!text-blue-200"," which can make it harder for the end user of components to override the rule.",[88,7842,7843,7844,7847],{},"Add ",[254,7845,7846],{},"data-[border=true]:data-[primary=true]:focus:text-blue-200",", but apart from creating hard to read css, this will create a lot of unneeded class soup in the html since the button would contain all styles for all variants even if you only end up using the one of them.",[88,7849,7850],{},"Use tailwind merge to bypass the problem.",[70,7852,7853],{},"If you pick tailwind-merge though, it is still a good idea to leave the data attributes, at least on the root of the components if you care about users being able to theme the app with css.",[247,7855,7857],{"className":7064,"code":7856,"language":7066,"meta":252,"style":252},"\u003Cdiv\n    :class=\"twMerge(`\n        p-3\n        bg-neutral-50\n        focus:text-blue-500\n        `,\n        border && `\n            border\n            border-neutral-900\n            focus:border-blue-500\n        `,\n        disabled && `\n            bg-neutral-300\n            focus:text-neutral-500\n        `,\n        border && disabled && `\n            border-neutral-500\n        `,\n        $attrs.class\n    )\"\n    v-bind=\"{...$attrs, class: undefined }\"\n>\n    \u003Cdiv :class=\"disabled && `line-through`\">\u003Cdiv>\n\u003C/div>\n",[254,7858,7859,7865,7875,7880,7885,7890,7895,7899,7904,7909,7914,7918,7922,7927,7932,7936,7941,7946,7950,7955,7961,7975,7979,8001],{"__ignoreMap":252},[257,7860,7861,7863],{"class":259,"line":260},[257,7862,394],{"class":267},[257,7864,6534],{"class":319},[257,7866,7867,7869,7871,7873],{"class":259,"line":291},[257,7868,7079],{"class":303},[257,7870,310],{"class":267},[257,7872,664],{"class":267},[257,7874,7228],{"class":284},[257,7876,7877],{"class":259,"line":297},[257,7878,7879],{"class":284},"        p-3\n",[257,7881,7882],{"class":259,"line":316},[257,7883,7884],{"class":284},"        bg-neutral-50\n",[257,7886,7887],{"class":259,"line":333},[257,7888,7889],{"class":284},"        focus:text-blue-500\n",[257,7891,7892],{"class":259,"line":346},[257,7893,7894],{"class":284},"        `,\n",[257,7896,7897],{"class":259,"line":359},[257,7898,7559],{"class":284},[257,7900,7901],{"class":259,"line":370},[257,7902,7903],{"class":284},"            border\n",[257,7905,7906],{"class":259,"line":376},[257,7907,7908],{"class":284},"            border-neutral-900\n",[257,7910,7911],{"class":259,"line":407},[257,7912,7913],{"class":284},"            focus:border-blue-500\n",[257,7915,7916],{"class":259,"line":435},[257,7917,7894],{"class":284},[257,7919,7920],{"class":259,"line":459},[257,7921,7574],{"class":284},[257,7923,7924],{"class":259,"line":476},[257,7925,7926],{"class":284},"            bg-neutral-300\n",[257,7928,7929],{"class":259,"line":487},[257,7930,7931],{"class":284},"            focus:text-neutral-500\n",[257,7933,7934],{"class":259,"line":494},[257,7935,7894],{"class":284},[257,7937,7938],{"class":259,"line":554},[257,7939,7940],{"class":284},"        border && disabled && `\n",[257,7942,7943],{"class":259,"line":582},[257,7944,7945],{"class":284},"            border-neutral-500\n",[257,7947,7948],{"class":259,"line":630},[257,7949,7894],{"class":284},[257,7951,7952],{"class":259,"line":636},[257,7953,7954],{"class":284},"        $attrs.class\n",[257,7956,7957,7959],{"class":259,"line":645},[257,7958,654],{"class":284},[257,7960,288],{"class":267},[257,7962,7963,7966,7968,7970,7973],{"class":259,"line":651},[257,7964,7965],{"class":303},"    v-bind",[257,7967,310],{"class":267},[257,7969,664],{"class":267},[257,7971,7972],{"class":284},"{...$attrs, class: undefined }",[257,7974,288],{"class":267},[257,7976,7977],{"class":259,"line":671},[257,7978,6568],{"class":267},[257,7980,7981,7983,7985,7987,7989,7991,7993,7995,7997,7999],{"class":259,"line":680},[257,7982,7097],{"class":267},[257,7984,6565],{"class":319},[257,7986,7323],{"class":303},[257,7988,310],{"class":267},[257,7990,664],{"class":267},[257,7992,7330],{"class":284},[257,7994,664],{"class":267},[257,7996,7335],{"class":267},[257,7998,6565],{"class":319},[257,8000,6568],{"class":267},[257,8002,8003,8005,8007],{"class":259,"line":685},[257,8004,7119],{"class":267},[257,8006,6565],{"class":319},[257,8008,6568],{"class":267},[95,8010,8012],{"id":8011},"the-downsides","The Downsides",[70,8014,8015],{},"There are, of course, always some downsides.",[942,8017,8019],{"id":8018},"inconsistent-naming","Inconsistent Naming",[70,8021,8022,8023,8026,8027,8030,8031,8034,8035,8038,8039,8042],{},"After some use, this is the one thing that really bugs me. You have ",[254,8024,8025],{},"py-*"," for top+bottom padding but ",[254,8028,8029],{},"gap-y-*"," for gaps? This happens in a few other places with units as well. You have spacing that goes down to ",[254,8032,8033],{},"-0.5"," but opacity which in css is ",[254,8036,8037],{},"0-1"," goes from ",[254,8040,8041],{},"0-100"," ???",[70,8044,8045,8046,8049,8050,8052,8053,8056,8057,8060],{},"I can understand not always using the same scales (e.g. ",[254,8047,8048],{},"sm"," , ",[254,8051,6160],{},", ",[254,8054,8055],{},"xl"," vs ",[254,8058,8059],{},"0-*",") but for some of the odder names, because the auto complete does not work based on the css property name, it can be very hard to find the utility you want. I have to keep the docs opened and pinned for actual searching. But I guess that could be considered more the autocomplete's fault, and not tailwind.",[942,8062,8064],{"id":8063},"missing-utilities","Missing Utilities",[70,8066,8067,8068,450],{},"Some css properties that are now pretty usable, do not exist yet. For example, text-shadow does not exist because ",[74,8069,8072],{"href":8070,"rel":8071},"https://github.com/tailwindlabs/tailwindcss/issues/162#issuecomment-777889883",[78],"which default styles to add has not been decided yet",[70,8074,8075],{},"Which fair, but I really wish they would at least they were provided as experimental properties or something instead of having to rely on other's plugins.",[70,8077,8078,8079,8082,8083,450],{},"Also some which should really exist, don't, such as grid with ",[254,8080,8081],{},"auto-fill"," and ",[254,8084,8085],{},"auto-fit",[942,8087,8089],{"id":8088},"hard-to-use-existing-tailwind-variables-in-custom-utilities","Hard to use Existing Tailwind Variables in Custom Utilities",[70,8091,8092,8093,8096],{},"I've written a few custom utilities for gradients, but couldn't for example, re-use the to/from-* gradient utilities and the css variables they create\nbecause I can't seperate the part I need (the color). For example, ",[254,8094,8095],{},"from-black from-0%"," will create:",[247,8098,8100],{"className":7481,"code":8099,"language":6675,"meta":252,"style":252},"-tw-gradient-from-position: 0%;\n--tw-gradient-from: #000 var(--tw-gradient-from-position);\n\n// which are then used like this:\n--tw-gradient-stops: var(--tw-gradient-from);\n",[254,8101,8102,8107,8118,8122,8127],{"__ignoreMap":252},[257,8103,8104],{"class":259,"line":260},[257,8105,8106],{"class":271},"-tw-gradient-from-position: 0%;\n",[257,8108,8109,8112,8115],{"class":259,"line":291},[257,8110,8111],{"class":271},"--tw-gradient-from: ",[257,8113,8114],{"class":267},"#",[257,8116,8117],{"class":271},"000 var(--tw-gradient-from-position);\n",[257,8119,8120],{"class":259,"line":297},[257,8121,294],{"emptyLinePlaceholder":60},[257,8123,8124],{"class":259,"line":316},[257,8125,8126],{"class":271},"// which are then used like this:\n",[257,8128,8129],{"class":259,"line":333},[257,8130,8131],{"class":271},"--tw-gradient-stops: var(--tw-gradient-from);\n",[70,8133,8134,8135,8138],{},"I can use the position, but not the color, there is no ",[254,8136,8137],{},"--tw-gradient-from-color",", so I have to create my own which can get messy.",[942,8140,8142],{"id":8141},"dynamic-values","Dynamic values",[70,8144,8145],{},"The stylesheet is compiled at build time (so that unused styles can be removed), so this means you can't use dynamic styles. This will not work. You have to use an inline style tag or a script tag.",[247,8147,8149],{"className":6519,"code":8148,"language":6165,"meta":252,"style":252},"\u003Cdiv :class=\"`p-[${customValue}]`\">\n\u003C/div>\n\n",[254,8150,8151,8183],{"__ignoreMap":252},[257,8152,8153,8155,8157,8160,8162,8164,8166,8169,8171,8174,8176,8178,8181],{"class":259,"line":260},[257,8154,394],{"class":267},[257,8156,6565],{"class":319},[257,8158,8159],{"class":267}," :",[257,8161,963],{"class":303},[257,8163,310],{"class":267},[257,8165,6546],{"class":267},[257,8167,8168],{"class":284},"p-[",[257,8170,4414],{"class":267},[257,8172,8173],{"class":271},"customValue",[257,8175,759],{"class":267},[257,8177,2580],{"class":284},[257,8179,8180],{"class":267},"`\"",[257,8182,6568],{"class":267},[257,8184,8185,8187,8189],{"class":259,"line":291},[257,8186,7119],{"class":267},[257,8188,6565],{"class":319},[257,8190,6568],{"class":267},[95,8192,8194],{"id":8193},"conclusion","Conclusion",[70,8196,8197],{},"I've been using it now for a few months and I can never go back to the old way.",[8199,8200,8203,8208],"section",{"className":8201,"dataFootnotes":252},[8202],"footnotes",[95,8204,8207],{"className":8205,"id":6756},[8206],"sr-only","Footnotes",[8209,8210,8211,8222],"ol",{},[88,8212,8214,8215],{"id":8213},"user-content-fn-1","I know, I could apply all the classes to the wrapper as well or use some BEM naming scheme and simplify the css, but then in complex elements, they need to be attached/created for every element which might only use a single state class, which probably isn't an issue performance wise if the classes aren't changing every second, but just irks me. And conditionally giving them the needed classes is beyond painful so I often stuck with this. ",[74,8216,8221],{"href":8217,"ariaLabel":8218,"className":8219,"dataFootnoteBackref":252},"#user-content-fnref-1","Back to reference 1",[8220],"data-footnote-backref","â†©",[88,8223,8225,8226],{"id":8224},"user-content-fn-2","I had trouble getting it to work with vscode + vue. Also you must type the name exactly and this is hard given the inconsistent naming. ",[74,8227,8221],{"href":8228,"ariaLabel":8229,"className":8230,"dataFootnoteBackref":252},"#user-content-fnref-2","Back to reference 2",[8220],[5826,8232,8233],{},"html pre.shiki code .sMK4o, html code.shiki .sMK4o{--shiki-light:#39ADB5;--shiki-default:#89DDFF;--shiki-dark:#89DDFF}html pre.shiki code .swJcz, html code.shiki .swJcz{--shiki-light:#E53935;--shiki-default:#F07178;--shiki-dark:#F07178}html pre.shiki code .spNyl, html code.shiki .spNyl{--shiki-light:#9C3EDA;--shiki-default:#C792EA;--shiki-dark:#C792EA}html pre.shiki code .sfazB, html code.shiki .sfazB{--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D}html .light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html.light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html pre.shiki code .sTEyZ, html code.shiki .sTEyZ{--shiki-light:#90A4AE;--shiki-default:#EEFFFF;--shiki-dark:#BABED8}html pre.shiki code .s2Zo4, html code.shiki .s2Zo4{--shiki-light:#6182B8;--shiki-default:#82AAFF;--shiki-dark:#82AAFF}html pre.shiki code .sBMFI, html code.shiki .sBMFI{--shiki-light:#E2931D;--shiki-default:#FFCB6B;--shiki-dark:#FFCB6B}html pre.shiki code .sqsOY, html code.shiki .sqsOY{--shiki-light:#8796B0;--shiki-default:#B2CCD6;--shiki-dark:#B2CCD6}html pre.shiki code .sbssI, html code.shiki .sbssI{--shiki-light:#F76D47;--shiki-default:#F78C6C;--shiki-dark:#F78C6C}",{"title":252,"searchDepth":291,"depth":291,"links":8235},[8236,8237,8243,8244],{"id":7471,"depth":291,"text":7472},{"id":8011,"depth":291,"text":8012,"children":8238},[8239,8240,8241,8242],{"id":8018,"depth":297,"text":8019},{"id":8063,"depth":297,"text":8064},{"id":8088,"depth":297,"text":8089},{"id":8141,"depth":297,"text":8142},{"id":8193,"depth":291,"text":8194},{"id":6756,"depth":291,"text":8207},"2023-09-14T00:00:00.000Z","CSS in HTML? Class soup? Relearning CSS property names? No thanks, right? or maybe I was wrong...","/thumbs/tailwind-logo.svg",[6675,6681],{},"---\ntitle: \"I cave, Tailwind rocks.\"\ndate: \"2023-09-14\"\ndescription: |-\n   CSS in HTML? Class soup? Relearning CSS property names? No thanks, right? or maybe I was wrong...\nimage: \"/thumbs/tailwind-logo.svg\"\npublished: true\ntags: [\"styling\"]\nlangs: [\"css\", \"tailwind\"]\n---\n\nMy first impression of tailwind was ğŸ¤®, css in html, not this again. What about seperation of concerns! When I looked at examples they just looked like some sort of class soup. The first example has to be scrolled because the lines are so long! Utility functions are a nice idea I'd been toying with adopting, but surely this went to far?\n\nI had looked into other css frameworks but it was easier to just roll my own than customize a utility framework so I didn't. I'd been toying with a theme management system / variable generator for apps, so using someone else's variables did not make sense. For a while I just used css with the variables my package produced to keep a consistent design.\n\n\nTailwind just seemed like another utility based css library that wouldn't benefit me very much.\n\nBut after seeing it praised again and again, I had to try it. [The docs are not wrong about this.](https://tailwindcss.com/docs/utility-first#:~:text=you%20have%20to%20actually%20try%20it)\n\nI tried it on a complicated component library to really battle test it and I finally understood what all the praise was about.\n\nIt's not just the points you hear all the time. There were also some things that aren't obvious on first glance that I really liked:\n\n- It's very easy to customize and make custom plugins.\n- You can quickly use custom values when you need them (e.g. `border-[calc(...)]`).\n- Many utility functions do more than one thing and make it easy to do common things that tend to bloat css.\n- Predictable application and overriding of styles (assuming the use of something like tailwind-merge).\n\nIt's hard to believe, but these all add up to make the class soup actually far exceed my previous scss in simplicity, readability, and maintainability. The [link above](https://tailwindcss.com/docs/utility-first) shows this to some extent but I did not even see this until I actually decided to try tailwind. It really should be one of the first things you see. \n\nAlso you don't have to put it all in one line! Why is it like that in so many examples, ğŸ˜­?\n\nYou can still write very readable styles if you want. And once you get a hang for the basic utility classes (this does not take as long as you'd think), the intent of the styles is far far clearer.\n\nHere's my own example. Where before in a my component library might have css that looked something like this (and yes, I know the *css* could be simplified, but in exchange for verbosity elsewhere[^1]):\n\n[^1]: I know, I could apply all the classes to the wrapper as well or use some BEM naming scheme and simplify the css, but then in complex elements, they need to be attached/created for every element which might only use a single state class, which probably isn't an issue performance wise if the classes aren't changing every second, but just irks me. And conditionally giving them the needed classes is beyond painful so I often stuck with this.\n\n```scss\n.component {\n\tpadding: 0 var(--padding-s);\n\tbackground: var(--color-bg-el) ;\n\t&.border {\n\t\tborder: var(--border-width) solid var(--color-border);\n\t\t&:focus { border-color: var(--color-border-focus) ;}\n\t}\n\t&:focus { color: var(--color-text-focus) ; }\n\t&.disabled { background: var(--color-bg-disabled); }\n\t&.disabled:focus { color: var(--color-text-disabled);}\n\t&.border.disabled:focus { border-color: var(--color-border-focus) ;}\n}\n.wraper {\n\t.component.disabled.border & {\n\t\ttext-decoration-line: line-through;\n\t}\n}\n```\n\nwith html (vue) that looked like this:\n```vue-html\n\u003Cdiv\n\t:class=\"classes\"\n>\n\t\u003Cdiv class=\"wrapper\"/>\n\u003C/div>\n```\n\nWhere `classes` was a computed red in setup, often abstracted away to a function for common states:\n\n```js\nconst classes = computed(() => ({\n\tdisabled: props.disabled,\n\tborder: props.border\n\t...\n}))\n```\nSeperation of concerns, right...\n\nNow with tailwind, after a bit of experimenting and the help of tailwind merge I can have html (vue) that looks like this. Same number of css rules.\n\n```vue-html\n\t\u003Cdiv\n\t\t:class=\"twMerge(`\n\t\t\tp-3\n\t\t\tbg-neutral-50\n\t\t\tfocus:text-blue-500\n\t\t\t`,\n\t\t\tborder && `\n\t\t\t\tborder\n\t\t\t\tborder-neutral-900\n\t\t\t\tfocus:border-blue-500\n\t\t\t`,\n\t\t\tdisabled && `\n\t\t\t\tbg-neutral-300\n\t\t\t\tfocus:text-neutral-500\n\t\t\t`,\n\t\t\tborder && disabled && `\n\t\t\t\tborder-neutral-500\n\t\t\t`)\"\n\t>\n\t\t\u003Cdiv :class=\"disabled && `line-through`\">\u003Cdiv>\n\t\u003C/div>\n```\nAnd that's it.\n\nThere is no more jumping to the js or the css to look things up.\n\nAll styles will apply predictably. It's clear what's happening, which classes are being applied when. With the help of tailwind merge we can rely on order and use variables like in the example to avoid specificity issues.\\*.\n\nJust a breath of fresh air.\n\nEven with one style per line for readability I have managed to shrink the file size of ALL the components I converted.\n\nI only now have two sections to worry about now, the logic, and the presentation. I've come to understand that presentation is invariably linked to state, and separating the css actually always makes things more painful. The creator of tailwind actually mentions this in the [blog post](https://adamwathan.me/css-utility-classes-and-separation-of-concerns/) where he made the arguments for tailwind on it's release, and I had read this before, but it never sunk in how painful this was until I wasn't experiencing the pain anymore.\n\nI was actually surprised how much faster I could style things (~3x) even when I had to have the tailwind docs pinned to lookup stuff and my tailwind autocomplete was not working well[^2].\n\n[^2]: I had trouble getting it to work with vscode + vue. Also you must type the name exactly and this is hard given the inconsistent naming.\n\nI've come to appreciate how easy it can do things that used to take multiple lines.\n\nTake for example [`truncate`](https://tailwindcss.com/docs/text-overflow#truncate) which does:\n```\noverflow: hidden;\ntext-overflow: ellipsis;\nwhite-space: nowrap;\n```\n\nOr gradients! If there's one thing I hate, it's writing css gradients. But in tailwind it's super simple, even with complex stops and everything:\n\n```vue-html\n\u003Cdiv class=\"bg-gradient-to-r from-white to-black\"/>\n\u003Cdiv class=\"\n\tbg-gradient-to-r\n\tfrom-white from-10%\n\tvia-blue-500 via-20%\n\tto-black to-50%\n\"/>\n```\n\n## \\* Tailwind Merge\n\nBut, tailwind merge is a MUST for complex applications and component libraries to avoid specificity issues. The reason why is that while tailwind cannot escape the css selector specificity problem completely, in fact we loose a bit of control.\n\nSee in regular css, if I have two selectors with equal specificity, the last one will win (note that this helps avoid the mess of having many variants and states):\n\n```css\n.input {\n\t&.border:focus {...}\n\t&.disabled:focus {...}\n}\n```\n\nIn tailwind, you DO NOT have control over the order. The order of the classes is irrelevant, BUT the order tailwind declares them in the stylesheets is and this cannot be controlled (since a single rule might be used in many components).\n\nIf you do this, depending on what colors you picked, the style might or might not apply on disabled:\n\n```vue-html\n\u003Cdiv\n\t:class=\"\n\t\tborder && `\n\t\tborder\n\t\tborder-red-500` +\n\t\tdisabled && `\n\t\tborder-neutral-500\n\t`\"\n>\n\u003C/div>\n```\n\nAnother thing I've seen done is using data attributes which looks cleaner and will seem to work at first, but this is because the data attributes are adding specificity to the selector, +1 for each data attribute.\n\nHere's a [specificity calculator](https://specificity.keegan.st/) you can use to see this.\n\nTailwind data attribute variants create the following selectors: `{ESCAPED_NAME}:[data-border=\"true\"]:[...]` you can input `.class:[data]:[data]` to quickly test, it would be the same thing.\n\n```vue-html\n\u003Cdiv\n\t:data-border=\"border\"\n\t:data-disabled=\"disabled\"\n\tclass=\"\n\t\tdata-[border=true]:border\n\t\tdata-[border=true]:border-red-500\n\t\tdata-[border=true]:data-[disabled]:border-neutral-500\n\t\">\n\u003C/div>\n\n```\n\nYou can easily run into the following problem, where these have equal specificity (2):\n\n```vue-html\n\u003Cbutton\n\t:data-primary=\"primary\"\n\tclass=\"\n\t\tdata-[primary=true]:text-white\n\t\tfocus:text=blue-200\n\t\">\n\u003C/button>\n\n```\n\nOr worse, here the text will never change on focus when the button is primary and has a border because that has a specificity of 3.\n```vue-html\n\u003Cbutton\n\t:data-primary=\"primary\"\n\t:data-border=\"border\"\n\tclass=\"\n\t\tdata-[border=true]:data-[primary=true]:text-white\n\t\tfocus:text-blue-200\n\t\">\n\u003C/button>\n```\n\nAt this point you must pick a solution. You can:\n\n- Add an important `focus:!text-blue-200` which can make it harder for the end user of components to override the rule.\n- Add `data-[border=true]:data-[primary=true]:focus:text-blue-200`, but apart from creating hard to read css, this will create a lot of unneeded class soup in the html since the button would contain all styles for all variants even if you only end up using the one of them.\n- Use tailwind merge to bypass the problem.\n\nIf you pick tailwind-merge though, it is still a good idea to leave the data attributes, at least on the root of the components if you care about users being able to theme the app with css. \n\n```vue-html\n\u003Cdiv\n\t:class=\"twMerge(`\n\t\tp-3\n\t\tbg-neutral-50\n\t\tfocus:text-blue-500\n\t\t`,\n\t\tborder && `\n\t\t\tborder\n\t\t\tborder-neutral-900\n\t\t\tfocus:border-blue-500\n\t\t`,\n\t\tdisabled && `\n\t\t\tbg-neutral-300\n\t\t\tfocus:text-neutral-500\n\t\t`,\n\t\tborder && disabled && `\n\t\t\tborder-neutral-500\n\t\t`,\n\t\t$attrs.class\n\t)\"\n\tv-bind=\"{...$attrs, class: undefined }\"\n>\n\t\u003Cdiv :class=\"disabled && `line-through`\">\u003Cdiv>\n\u003C/div>\n```\n\n## The Downsides\n\nThere are, of course, always some downsides.\n\n### Inconsistent Naming\n\nAfter some use, this is the one thing that really bugs me. You have `py-*` for top+bottom padding but `gap-y-*` for gaps? This happens in a few other places with units as well. You have spacing that goes down to `-0.5` but opacity which in css is `0-1` goes from `0-100` ???\n\nI can understand not always using the same scales (e.g. `sm` , `md`, `xl` vs `0-*`) but for some of the odder names, because the auto complete does not work based on the css property name, it can be very hard to find the utility you want. I have to keep the docs opened and pinned for actual searching. But I guess that could be considered more the autocomplete's fault, and not tailwind.\n\n### Missing Utilities\n\nSome css properties that are now pretty usable, do not exist yet. For example, text-shadow does not exist because [which default styles to add has not been decided yet](https://github.com/tailwindlabs/tailwindcss/issues/162#issuecomment-777889883).\n\nWhich fair, but I really wish they would at least they were provided as experimental properties or something instead of having to rely on other's plugins.\n\nAlso some which should really exist, don't, such as grid with `auto-fill` and `auto-fit`.\n\n### Hard to use Existing Tailwind Variables in Custom Utilities\n\nI've written a few custom utilities for gradients, but couldn't for example, re-use the to/from-* gradient utilities and the css variables they create\nbecause I can't seperate the part I need (the color). For example, `from-black from-0%` will create:\n\n\n```css\n-tw-gradient-from-position: 0%;\n--tw-gradient-from: #000 var(--tw-gradient-from-position);\n\n// which are then used like this:\n--tw-gradient-stops: var(--tw-gradient-from);\n```\nI can use the position, but not the color, there is no `--tw-gradient-from-color`, so I have to create my own which can get messy.\n\n### Dynamic values\n\nThe stylesheet is compiled at build time (so that unused styles can be removed), so this means you can't use dynamic styles. This will not work. You have to use an inline style tag or a script tag.\n\n```vue\n\u003Cdiv :class=\"`p-[${customValue}]`\">\n\u003C/div>\n\n```\n\n## Conclusion\n\nI've been using it now for a few months and I can never go back to the old way.\n",{"title":46,"description":8246},[8253],"styling","Lim4p-CMpeS0FVVRm2zWAETXaB9OqxSxeSidt62LB08",{"id":8256,"title":42,"body":8257,"date":8607,"description":8608,"extension":6160,"image":57,"langs":57,"meta":8609,"navigation":60,"path":43,"published":60,"rawbody":8610,"seo":8611,"static_image":57,"stem":44,"tags":8612,"video_image":57,"__hash__":8615},"blog/blog/semantic-release-v0.md",{"type":67,"value":8258,"toc":8605},[8259,8274,8277,8280,8283,8292,8297,8328,8337,8340,8343,8352,8417,8435,8513,8516,8520,8523,8534,8537,8540,8560,8563,8578,8585,8594,8597,8603],[70,8260,8261,8262,8267,8268,8273],{},"I love ",[74,8263,8266],{"href":8264,"rel":8265},"https://www.npmjs.com/package/semantic-release",[78],"semantic-release",", but it unfortunately doesn't support and is probably never going to ",[74,8269,8272],{"href":8270,"rel":8271},"https://github.com/semantic-release/semantic-release/issues/1507",[78],"support 0 major versioned packages",". The issue for it doesn't really contain a good workaround and has unfortunately been locked due to people being rude.",[70,8275,8276],{},"But I'd really like to v0 version some packages. I really regret having had to publish some highly experimental packages starting with v1. In their highly experimental phase it's usually just me using them and I pin them when using them so breaking changes aren't an issue. If I start at v1 and properly commit breaking changes, by the time the package is stable it's at v3+ or something. And the entire time the package says it's a WIP but the version is v1+, and I hate it. Often I won't event properly committed breaking changes unless they're major, half defeating the point of semantic versioning.",[70,8278,8279],{},"I've also tried avoiding publishing them in the first place and just using them directly from the repo, but this often requires more effort to get working (since the prepare script needs to be defined to properly build the package after downloading). Still good to publish packages that just work like this, but I always end up running into obscure problems doing things this way.",[70,8281,8282],{},"Ideally I want to just start at v0, write commits that create proper release notes listing the breaking changes, but not have them major bump until the package is more stable and I publish v1.",[70,8284,8285,8286,8291],{},"I got really annoyed at this situation recently so started looking at some of the alternatives mentioned in the issue, but most do not do everything semantic-release does. ",[74,8287,8290],{"href":8288,"rel":8289},"https://github.com/googleapis/release-please",[78],"release-please"," was the closest, but it's missing an easier way to manager branches and the workflow seems more error prone to me.",[8293,8294,8296],"h1",{"id":8295},"workaround","Workaround",[70,8298,8299,8300,8303,8304,8307,8308,8052,8311,8052,8314,8317,8318,8320,8321,8324,8325,8327],{},"This is the simplest workaround I've found. Instead of the regular ",[254,8301,8302],{},"feat/fix/..."," commits, I create ",[254,8305,8306],{},"v0feat/v0fix/...",". You could do this for all the commit types. I chose to just create three, ",[254,8309,8310],{},"v0feat",[254,8312,8313],{},"v0fix",[254,8315,8316],{},"v0breaking",", and technically ",[254,8319,8313],{}," is not needed since it's the same as ",[254,8322,8323],{},"fix",", but I liked the consistent naming. How you set this up, depends on what you'd like to bump what. Technically the only one you truly need is ",[254,8326,8316],{}," so release notes show breaking changes without a major bump.",[70,8329,8330,8331,8336],{},"Now I keep my own ",[74,8332,8335],{"href":8333,"rel":8334},"https://github.com/AlansCodeLog/my-semantic-release-config/blob/master/release.config.js",[78],"semantic-release-config"," so this was easier for me to do. You will need to either configure certain plugins manually each time or I highly suggest creating your own config and abstracting everything away (no more need to install all the deps/plugins needed, your config can just do it for you).",[70,8338,8339],{},"How to do so or the various places you can place your config is out of scope for this post.",[70,8341,8342],{},"I'll just be showing you how to configure the plugins.",[70,8344,8345,8346,8351],{},"First, ",[74,8347,8350],{"href":8348,"rel":8349},"https://github.com/semantic-release/commit-analyzer",[78],"commit-analyzer",". This will tell semantic-release how much to bump.",[247,8353,8357],{"className":8354,"code":8355,"language":8356,"meta":252,"style":252},"language-jsonc shiki shiki-themes material-theme-lighter material-theme material-theme-palenight","[\n    \"@semantic-release/commit-analyzer\",\n    {\n        // you can use a preset here if you like\n        \"preset\": \"conventionalcommits\",\n        \"releaseRules\": [\n            { \"type\": \"v0feat\", \"release\": \"patch\" },\n            { \"type\": \"v0fix\", \"release\": \"patch\" },\n            { \"type\": \"v0breaking\",  \"release\": \"minor\" }\n        ]\n    }\n],\n","jsonc",[254,8358,8359,8364,8369,8373,8378,8383,8388,8393,8398,8403,8408,8412],{"__ignoreMap":252},[257,8360,8361],{"class":259,"line":260},[257,8362,8363],{},"[\n",[257,8365,8366],{"class":259,"line":291},[257,8367,8368],{},"    \"@semantic-release/commit-analyzer\",\n",[257,8370,8371],{"class":259,"line":297},[257,8372,3315],{},[257,8374,8375],{"class":259,"line":316},[257,8376,8377],{},"        // you can use a preset here if you like\n",[257,8379,8380],{"class":259,"line":333},[257,8381,8382],{},"        \"preset\": \"conventionalcommits\",\n",[257,8384,8385],{"class":259,"line":346},[257,8386,8387],{},"        \"releaseRules\": [\n",[257,8389,8390],{"class":259,"line":359},[257,8391,8392],{},"            { \"type\": \"v0feat\", \"release\": \"patch\" },\n",[257,8394,8395],{"class":259,"line":370},[257,8396,8397],{},"            { \"type\": \"v0fix\", \"release\": \"patch\" },\n",[257,8399,8400],{"class":259,"line":376},[257,8401,8402],{},"            { \"type\": \"v0breaking\",  \"release\": \"minor\" }\n",[257,8404,8405],{"class":259,"line":407},[257,8406,8407],{},"        ]\n",[257,8409,8410],{"class":259,"line":435},[257,8411,1118],{},[257,8413,8414],{"class":259,"line":459},[257,8415,8416],{},"],\n",[70,8418,8419,8420,8425,8426,8429,8430],{},"Then, ",[74,8421,8424],{"href":8422,"rel":8423},"https://github.com/semantic-release/release-notes-generator",[78],"release-notes-generator",". This will tell semantic-release how to format the commit message headers. The docs for ",[254,8427,8428],{},"presetConfig"," are a bit hidden. You can find the full spec for them ",[74,8431,8434],{"href":8432,"rel":8433},"https://github.com/conventional-changelog/conventional-changelog-config-spec",[78],"here",[247,8436,8438],{"className":8354,"code":8437,"language":8356,"meta":252,"style":252},"[\n    \"@semantic-release/release-notes-generator\",\n    {\n        // note that if you use a preset, you will inherit it's options regarding what text counts as breaking changes\n        \"preset\": \"conventionalcommits\",\n        \"presetConfig\": {\n            \"types\": [\n                { \"type\":\"v0feat\", \"section\": \":star: New Features\" },\n                { \"type\": \"v0fix\", \"section\": \":bug: Fixes\" },\n                // Simulate a breaking change\n                { \"type\": \"v0breaking\", \"section\": \":warning: BREAKING CHANGES\" }\n            ]\n        }\n\n    }\n]\n",[254,8439,8440,8444,8449,8453,8458,8462,8467,8472,8477,8482,8487,8492,8497,8501,8505,8509],{"__ignoreMap":252},[257,8441,8442],{"class":259,"line":260},[257,8443,8363],{},[257,8445,8446],{"class":259,"line":291},[257,8447,8448],{},"    \"@semantic-release/release-notes-generator\",\n",[257,8450,8451],{"class":259,"line":297},[257,8452,3315],{},[257,8454,8455],{"class":259,"line":316},[257,8456,8457],{},"        // note that if you use a preset, you will inherit it's options regarding what text counts as breaking changes\n",[257,8459,8460],{"class":259,"line":333},[257,8461,8382],{},[257,8463,8464],{"class":259,"line":346},[257,8465,8466],{},"        \"presetConfig\": {\n",[257,8468,8469],{"class":259,"line":359},[257,8470,8471],{},"            \"types\": [\n",[257,8473,8474],{"class":259,"line":370},[257,8475,8476],{},"                { \"type\":\"v0feat\", \"section\": \":star: New Features\" },\n",[257,8478,8479],{"class":259,"line":376},[257,8480,8481],{},"                { \"type\": \"v0fix\", \"section\": \":bug: Fixes\" },\n",[257,8483,8484],{"class":259,"line":407},[257,8485,8486],{},"                // Simulate a breaking change\n",[257,8488,8489],{"class":259,"line":435},[257,8490,8491],{},"                { \"type\": \"v0breaking\", \"section\": \":warning: BREAKING CHANGES\" }\n",[257,8493,8494],{"class":259,"line":459},[257,8495,8496],{},"            ]\n",[257,8498,8499],{"class":259,"line":476},[257,8500,648],{},[257,8502,8503],{"class":259,"line":487},[257,8504,294],{"emptyLinePlaceholder":60},[257,8506,8507],{"class":259,"line":494},[257,8508,1118],{},[257,8510,8511],{"class":259,"line":554},[257,8512,4350],{},[70,8514,8515],{},"You can see the configs are pretty similar. In my config I create one shared object to pass as necessary to the plugins.",[8293,8517,8519],{"id":8518},"usage","Usage",[70,8521,8522],{},"First you will need to create your first commit. Usually I will just create an empty commit.",[247,8524,8528],{"className":8525,"code":8526,"language":8527,"meta":252,"style":252},"language-sh shiki shiki-themes material-theme-lighter material-theme material-theme-palenight","git commit --allow-empty \"v0feat: empty\"\n","sh",[254,8529,8530],{"__ignoreMap":252},[257,8531,8532],{"class":259,"line":260},[257,8533,8526],{},[70,8535,8536],{},"Now if you tried to run semantic release now, you would still get version v1.0.0.",[70,8538,8539],{},"You will need to tag the initial commit as v0.0.0 to trick semantic-release into working how we want.",[247,8541,8543],{"className":8525,"code":8542,"language":8527,"meta":252,"style":252},"git tag v0.0.0\n# don't forget!\ngit push --tags \n",[254,8544,8545,8550,8555],{"__ignoreMap":252},[257,8546,8547],{"class":259,"line":260},[257,8548,8549],{},"git tag v0.0.0\n",[257,8551,8552],{"class":259,"line":291},[257,8553,8554],{},"# don't forget!\n",[257,8556,8557],{"class":259,"line":297},[257,8558,8559],{},"git push --tags\n",[70,8561,8562],{},"Then add your code and your real commit.",[247,8564,8566],{"className":8525,"code":8565,"language":8527,"meta":252,"style":252},"git add .\ngit commit \"v0feat: initial\"\n",[254,8567,8568,8573],{"__ignoreMap":252},[257,8569,8570],{"class":259,"line":260},[257,8571,8572],{},"git add .\n",[257,8574,8575],{"class":259,"line":291},[257,8576,8577],{},"git commit \"v0feat: initial\"\n",[70,8579,8580,8581,8584],{},"Now you can do a dry run. Note you will need to push to your repo before doing so. So disable your release workflow if you have one. I personally have an env variable ",[254,8582,8583],{},"ENABLE_RELEASE"," I use to enable/disable, which has not been enabled yet at this point.",[247,8586,8588],{"className":8525,"code":8587,"language":8527,"meta":252,"style":252},"npx semantic-release --dry-run --no-ci #--debug\n",[254,8589,8590],{"__ignoreMap":252},[257,8591,8592],{"class":259,"line":260},[257,8593,8587],{},[70,8595,8596],{},"It should now print v0.0.1!",[70,8598,8599,8600,8602],{},"Now so long as you do not commit any commit types that trigger a major bump or use any text that triggers a breaking change in your commit messages (that's what ",[254,8601,8316],{}," is for), you should stay in v0.",[5826,8604,6474],{},{"title":252,"searchDepth":291,"depth":291,"links":8606},[],"2023-07-16T00:00:00.000Z","A simple workaround for semantic-release lack of support for 0 major versioned packages.",{},"---\ntitle: How to Publish v0.x.x Versioned Packages with Semantic Release \ndescription: \"A simple workaround for semantic-release lack of support for 0 major versioned packages.\"\ndate: 2023-07-16\ntags: [\"semantic-release\", \"build-tools\", \"ci\"]\npublished: true\n\n---\n\nI love [semantic-release](https://www.npmjs.com/package/semantic-release), but it unfortunately doesn't support and is probably never going to [support 0 major versioned packages](https://github.com/semantic-release/semantic-release/issues/1507). The issue for it doesn't really contain a good workaround and has unfortunately been locked due to people being rude.\n\nBut I'd really like to v0 version some packages. I really regret having had to publish some highly experimental packages starting with v1. In their highly experimental phase it's usually just me using them and I pin them when using them so breaking changes aren't an issue. If I start at v1 and properly commit breaking changes, by the time the package is stable it's at v3+ or something. And the entire time the package says it's a WIP but the version is v1+, and I hate it. Often I won't event properly committed breaking changes unless they're major, half defeating the point of semantic versioning.\n\nI've also tried avoiding publishing them in the first place and just using them directly from the repo, but this often requires more effort to get working (since the prepare script needs to be defined to properly build the package after downloading). Still good to publish packages that just work like this, but I always end up running into obscure problems doing things this way. \n\nIdeally I want to just start at v0, write commits that create proper release notes listing the breaking changes, but not have them major bump until the package is more stable and I publish v1.\n\nI got really annoyed at this situation recently so started looking at some of the alternatives mentioned in the issue, but most do not do everything semantic-release does. [release-please](https://github.com/googleapis/release-please) was the closest, but it's missing an easier way to manager branches and the workflow seems more error prone to me.\n\n# Workaround\n\nThis is the simplest workaround I've found. Instead of the regular `feat/fix/...` commits, I create `v0feat/v0fix/...`. You could do this for all the commit types. I chose to just create three, `v0feat`, `v0fix`, `v0breaking`, and technically `v0fix` is not needed since it's the same as `fix`, but I liked the consistent naming. How you set this up, depends on what you'd like to bump what. Technically the only one you truly need is `v0breaking` so release notes show breaking changes without a major bump.\n\nNow I keep my own [semantic-release-config](https://github.com/AlansCodeLog/my-semantic-release-config/blob/master/release.config.js) so this was easier for me to do. You will need to either configure certain plugins manually each time or I highly suggest creating your own config and abstracting everything away (no more need to install all the deps/plugins needed, your config can just do it for you).\n\nHow to do so or the various places you can place your config is out of scope for this post.\n\nI'll just be showing you how to configure the plugins.\n\nFirst, [commit-analyzer](https://github.com/semantic-release/commit-analyzer). This will tell semantic-release how much to bump.\n\n```jsonc\n[\n\t\"@semantic-release/commit-analyzer\",\n\t{\n\t\t// you can use a preset here if you like\n\t\t\"preset\": \"conventionalcommits\",\n\t\t\"releaseRules\": [\n\t\t\t{ \"type\": \"v0feat\", \"release\": \"patch\" },\n\t\t\t{ \"type\": \"v0fix\", \"release\": \"patch\" },\n\t\t\t{ \"type\": \"v0breaking\",  \"release\": \"minor\" }\n\t\t]\n\t}\n],\n```\n\nThen, [release-notes-generator](https://github.com/semantic-release/release-notes-generator). This will tell semantic-release how to format the commit message headers. The docs for `presetConfig` are a bit hidden. You can find the full spec for them [here](https://github.com/conventional-changelog/conventional-changelog-config-spec)\n\n```jsonc\n[\n\t\"@semantic-release/release-notes-generator\",\n\t{\n\t\t// note that if you use a preset, you will inherit it's options regarding what text counts as breaking changes\n\t\t\"preset\": \"conventionalcommits\",\n\t\t\"presetConfig\": {\n\t\t\t\"types\": [\n\t\t\t\t{ \"type\":\"v0feat\", \"section\": \":star: New Features\" },\n\t\t\t\t{ \"type\": \"v0fix\", \"section\": \":bug: Fixes\" },\n\t\t\t\t// Simulate a breaking change\n\t\t\t\t{ \"type\": \"v0breaking\", \"section\": \":warning: BREAKING CHANGES\" }\n\t\t\t]\n\t\t}\n\n\t}\n]\n```\n\nYou can see the configs are pretty similar. In my config I create one shared object to pass as necessary to the plugins.\n\n\n# Usage\n\nFirst you will need to create your first commit. Usually I will just create an empty commit.\n\n\n```sh\ngit commit --allow-empty \"v0feat: empty\"\n```\nNow if you tried to run semantic release now, you would still get version v1.0.0. \n\nYou will need to tag the initial commit as v0.0.0 to trick semantic-release into working how we want.\n\n```sh\ngit tag v0.0.0\n# don't forget!\ngit push --tags \n```\n\nThen add your code and your real commit.\n```sh\ngit add .\ngit commit \"v0feat: initial\"\n```\n\nNow you can do a dry run. Note you will need to push to your repo before doing so. So disable your release workflow if you have one. I personally have an env variable `ENABLE_RELEASE` I use to enable/disable, which has not been enabled yet at this point.\n\n```sh\nnpx semantic-release --dry-run --no-ci #--debug\n```\n\nIt should now print v0.0.1!\n\nNow so long as you do not commit any commit types that trigger a major bump or use any text that triggers a breaking change in your commit messages (that's what `v0breaking` is for), you should stay in v0.\n\n\n",{"title":42,"description":8608},[8266,8613,8614],"build-tools","ci","jpTxQetCFYwKqAvzQqvJtMWm1Ke_plmRVUnHk5nzq90",{"id":8617,"title":30,"body":8618,"date":9148,"description":9149,"extension":6160,"image":9150,"langs":9151,"meta":9152,"navigation":60,"path":31,"published":60,"rawbody":9153,"seo":9154,"static_image":57,"stem":32,"tags":9155,"video_image":57,"__hash__":9157},"blog/blog/neovim-wezterm-mod-number-keys.md",{"type":67,"value":8619,"toc":9146},[8620,8623,8632,8640,8647,8656,8670,8677,8680,8683,8894,8904,8907,9109,9112,9141,9144],[70,8621,8622],{},"I've been recently giving neovim a serious try (this is my fourth/fifth attempt). And I think this time it's going to work out, but I really miss Modifier+Number shortcuts.",[70,8624,8625,8626,8631],{},"Usually you cannot map to modifies + number keys in in neovim (e.g. Ctrl+1). You can ",[74,8627,8630],{"href":8628,"rel":8629},"https://vi.stackexchange.com/questions/19358/cannot-map-ctrl-number-except-6-or",[78],"try to map the raw key sequences"," but this is a pain and does not work for all numbers.",[70,8633,8634,8635,430],{},"The best way to get around this is to map to an obscure keybinding then make the terminal remap Mod+Number to those odd keybindings. I never got around to actually doing this usually because most terminal's configs are static it's also often a pain to remap keys (e.g. ",[74,8636,8639],{"href":8637,"rel":8638},"https://sw.kovidgoyal.net/kitty/conf/#shortcut-kitty.Send-arbitrary-text-on-key-presses",[78],"kitty, I like you, but...",[70,8641,8642,8643,8646],{},"Also the ideal way to do this is to map them to a key chain like ",[254,8644,8645],{},"{ObscureCombo} {Mods}+{Remap}"," so as to not take up useful keys. But that's even more painful.",[70,8648,8649,8650,8655],{},"Recently though I tried and switched to ",[74,8651,8654],{"href":8652,"rel":8653},"https://github.com/wez/wezterm",[78],"wezterm"," for my terminal emulator, and it's configured through lua which makes this super easy to do for all sequences.",[70,8657,8658,8659,8662,8663,8666,8667,450],{},"For example, I picked ",[254,8660,8661],{},"Ctrl+Alt+Shift+F12"," for the obscure key combo and letters for the remap part. So ",[254,8664,8665],{},"Ctrl+1"," would map to ",[254,8668,8669],{},"Ctrl+Alt+Shift+F12 Ctrl+q",[70,8671,8672,8673,8676],{},"The letter mapping is to avoid breaking anything. If we mapped them to, for example, the F keys again, we might accidentally shoot ourselves in the foot when pressing ",[254,8674,8675],{},"Alt+4"," .",[70,8678,8679],{},"Note that we also can't map the numbers without the modifiers, since wezterm has no way to know if we're in normal mode or not, and we would be left unable to type numbers if we did so.",[70,8681,8682],{},"Here's my wezterm function for remapping with all mods.",[247,8684,8688],{"className":8685,"code":8686,"language":8687,"meta":252,"style":252},"language-lua shiki shiki-themes material-theme-lighter material-theme material-theme-palenight","-- Allows using Mods+Number in the receiving program if it does not support it.\n-- In the receiving program, the keymap needs to be `\u003CC-A-S-F12> \u003CMods-F{q-p}>`\nlocal remapModNumber = function(keyConfig, modsToRemap)\n    -- it's not \u003CMods-F{Number}> for obvious reasons (i.e. A-F4)\n    local numMap = {\n        [\"1\"] = \"q\",\n        [\"2\"] = \"w\",\n        [\"3\"] = \"e\",\n        [\"4\"] = \"r\",\n        [\"5\"] = \"t\",\n        [\"6\"] = \"y\",\n        [\"7\"] = \"u\",\n        [\"8\"] = \"i\",\n        [\"9\"] = \"o\",\n        [\"0\"] = \"p\",\n    }\n\n    local createModNumberRemap = function(key, mods)\n        local res = {\n            key = key,\n            mods = mods,\n            action = act.Multiple({\n                --obscure key to use as base\n                act.SendKey({ key = \"F12\", mods = \"CTRL|SHIFT|ALT\" }),\n                act.SendKey({ key = numMap[key], mods = mods }),\n            }),\n        }\n        return res\n    end\n    print(keyConfig)\n    for i = 0, 9 do\n        for _, mod in ipairs(modsToRemap) do\n            -- cant insert normally???\n            keyConfig[#keyConfig + 1] = createModNumberRemap(tostring(i), mod)\n        end\n    end\nend\nconfig.keys = {\n    -- ...your other keybindings\n}\n\nremapModNumber(config.keys, { \"CTRL\", \"SHIFT\", \"ALT\", \"CTRL|ALT\", \"ALT|SHIFT\", \"CTRL|SHIFT\", \"ALT|CTRL\", \"CTRL|SHIFT|ALT\" })\n","lua",[254,8689,8690,8695,8700,8705,8710,8715,8720,8725,8730,8735,8740,8745,8750,8755,8760,8765,8769,8773,8778,8783,8788,8793,8798,8803,8808,8813,8818,8822,8827,8832,8837,8842,8847,8852,8857,8862,8866,8871,8876,8881,8885,8889],{"__ignoreMap":252},[257,8691,8692],{"class":259,"line":260},[257,8693,8694],{},"-- Allows using Mods+Number in the receiving program if it does not support it.\n",[257,8696,8697],{"class":259,"line":291},[257,8698,8699],{},"-- In the receiving program, the keymap needs to be `\u003CC-A-S-F12> \u003CMods-F{q-p}>`\n",[257,8701,8702],{"class":259,"line":297},[257,8703,8704],{},"local remapModNumber = function(keyConfig, modsToRemap)\n",[257,8706,8707],{"class":259,"line":316},[257,8708,8709],{},"    -- it's not \u003CMods-F{Number}> for obvious reasons (i.e. A-F4)\n",[257,8711,8712],{"class":259,"line":333},[257,8713,8714],{},"    local numMap = {\n",[257,8716,8717],{"class":259,"line":346},[257,8718,8719],{},"        [\"1\"] = \"q\",\n",[257,8721,8722],{"class":259,"line":359},[257,8723,8724],{},"        [\"2\"] = \"w\",\n",[257,8726,8727],{"class":259,"line":370},[257,8728,8729],{},"        [\"3\"] = \"e\",\n",[257,8731,8732],{"class":259,"line":376},[257,8733,8734],{},"        [\"4\"] = \"r\",\n",[257,8736,8737],{"class":259,"line":407},[257,8738,8739],{},"        [\"5\"] = \"t\",\n",[257,8741,8742],{"class":259,"line":435},[257,8743,8744],{},"        [\"6\"] = \"y\",\n",[257,8746,8747],{"class":259,"line":459},[257,8748,8749],{},"        [\"7\"] = \"u\",\n",[257,8751,8752],{"class":259,"line":476},[257,8753,8754],{},"        [\"8\"] = \"i\",\n",[257,8756,8757],{"class":259,"line":487},[257,8758,8759],{},"        [\"9\"] = \"o\",\n",[257,8761,8762],{"class":259,"line":494},[257,8763,8764],{},"        [\"0\"] = \"p\",\n",[257,8766,8767],{"class":259,"line":554},[257,8768,1118],{},[257,8770,8771],{"class":259,"line":582},[257,8772,294],{"emptyLinePlaceholder":60},[257,8774,8775],{"class":259,"line":630},[257,8776,8777],{},"    local createModNumberRemap = function(key, mods)\n",[257,8779,8780],{"class":259,"line":636},[257,8781,8782],{},"        local res = {\n",[257,8784,8785],{"class":259,"line":645},[257,8786,8787],{},"            key = key,\n",[257,8789,8790],{"class":259,"line":651},[257,8791,8792],{},"            mods = mods,\n",[257,8794,8795],{"class":259,"line":671},[257,8796,8797],{},"            action = act.Multiple({\n",[257,8799,8800],{"class":259,"line":680},[257,8801,8802],{},"                --obscure key to use as base\n",[257,8804,8805],{"class":259,"line":685},[257,8806,8807],{},"                act.SendKey({ key = \"F12\", mods = \"CTRL|SHIFT|ALT\" }),\n",[257,8809,8810],{"class":259,"line":691},[257,8811,8812],{},"                act.SendKey({ key = numMap[key], mods = mods }),\n",[257,8814,8815],{"class":259,"line":711},[257,8816,8817],{},"            }),\n",[257,8819,8820],{"class":259,"line":723},[257,8821,648],{},[257,8823,8824],{"class":259,"line":728},[257,8825,8826],{},"        return res\n",[257,8828,8829],{"class":259,"line":806},[257,8830,8831],{},"    end\n",[257,8833,8834],{"class":259,"line":812},[257,8835,8836],{},"    print(keyConfig)\n",[257,8838,8839],{"class":259,"line":835},[257,8840,8841],{},"    for i = 0, 9 do\n",[257,8843,8844],{"class":259,"line":880},[257,8845,8846],{},"        for _, mod in ipairs(modsToRemap) do\n",[257,8848,8849],{"class":259,"line":912},[257,8850,8851],{},"            -- cant insert normally???\n",[257,8853,8854],{"class":259,"line":919},[257,8855,8856],{},"            keyConfig[#keyConfig + 1] = createModNumberRemap(tostring(i), mod)\n",[257,8858,8859],{"class":259,"line":1917},[257,8860,8861],{},"        end\n",[257,8863,8864],{"class":259,"line":1923},[257,8865,8831],{},[257,8867,8868],{"class":259,"line":2481},[257,8869,8870],{},"end\n",[257,8872,8873],{"class":259,"line":2496},[257,8874,8875],{},"config.keys = {\n",[257,8877,8878],{"class":259,"line":2501},[257,8879,8880],{},"    -- ...your other keybindings\n",[257,8882,8883],{"class":259,"line":2527},[257,8884,373],{},[257,8886,8887],{"class":259,"line":2555},[257,8888,294],{"emptyLinePlaceholder":60},[257,8890,8891],{"class":259,"line":2560},[257,8892,8893],{},"remapModNumber(config.keys, { \"CTRL\", \"SHIFT\", \"ALT\", \"CTRL|ALT\", \"ALT|SHIFT\", \"CTRL|SHIFT\", \"ALT|CTRL\", \"CTRL|SHIFT|ALT\" })\n",[70,8895,8896,8897,8900,8901,450],{},"Then in vim, if we wanted to use ",[254,8898,8899],{},"\u003CC-1>"," we would map to ",[254,8902,8903],{},"\u003CC-S-A-F12>\u003CC-q>",[70,8905,8906],{},"I've also added a small helper function in my local utils module to help with this. I might extract this later into a plugin.",[247,8908,8910],{"className":8685,"code":8909,"language":8687,"meta":252,"style":252},"local M = {}\nlocal config = {\n    baseSequence = \"\u003CC-S-A-F12>\",\n}\nM.setup = function(opts)\n    opts = opts or {}\n    vim.tbl_extend(\"force\", config, opts)\nend\nlocal replacements = {\n    [\"1\"] = \"q\",\n    [\"2\"] = \"w\",\n    [\"3\"] = \"e\",\n    [\"4\"] = \"r\",\n    [\"5\"] = \"t\",\n    [\"6\"] = \"y\",\n    [\"7\"] = \"u\",\n    [\"8\"] = \"i\",\n    [\"9\"] = \"o\",\n    [\"0\"] = \"p\",\n}\nM.mapNum = function(keysString)\n    local str = \"\"\n    for i = 1, #keysString do\n        local prevPrevChar = i > 2 and keysString:sub(i - 2, i - 2) or nil\n\n        local prevChar = i > 1 and keysString:sub(i - 1, i - 1) or nil\n        local char = keysString:sub(i, i)\n        local isNumber = tonumber(char) ~= nil\n        local prevIsNumber = prevChar ~= nil and tonumber(prevChar) ~= nil\n        local prevIsAllowed = prevChar == nil or prevChar ~= \"F\" or prevIsNumber\n        local prevPrevIsAllowed = prevPrevChar == nil or prevPrevChar ~= \"F\"\n        if isNumber and prevIsAllowed and prevPrevIsAllowed then\n            str = str .. replacements[char]\n        else\n            str = str .. char\n        end\n    end\n    return config.baseSequence .. str\nend\n\nreturn M\n",[254,8911,8912,8917,8922,8927,8931,8936,8941,8946,8950,8955,8960,8965,8970,8975,8980,8985,8990,8995,9000,9005,9009,9014,9019,9024,9029,9033,9038,9043,9048,9053,9058,9063,9068,9073,9078,9083,9087,9091,9096,9100,9104],{"__ignoreMap":252},[257,8913,8914],{"class":259,"line":260},[257,8915,8916],{},"local M = {}\n",[257,8918,8919],{"class":259,"line":291},[257,8920,8921],{},"local config = {\n",[257,8923,8924],{"class":259,"line":297},[257,8925,8926],{},"    baseSequence = \"\u003CC-S-A-F12>\",\n",[257,8928,8929],{"class":259,"line":316},[257,8930,373],{},[257,8932,8933],{"class":259,"line":333},[257,8934,8935],{},"M.setup = function(opts)\n",[257,8937,8938],{"class":259,"line":346},[257,8939,8940],{},"    opts = opts or {}\n",[257,8942,8943],{"class":259,"line":359},[257,8944,8945],{},"    vim.tbl_extend(\"force\", config, opts)\n",[257,8947,8948],{"class":259,"line":370},[257,8949,8870],{},[257,8951,8952],{"class":259,"line":376},[257,8953,8954],{},"local replacements = {\n",[257,8956,8957],{"class":259,"line":407},[257,8958,8959],{},"    [\"1\"] = \"q\",\n",[257,8961,8962],{"class":259,"line":435},[257,8963,8964],{},"    [\"2\"] = \"w\",\n",[257,8966,8967],{"class":259,"line":459},[257,8968,8969],{},"    [\"3\"] = \"e\",\n",[257,8971,8972],{"class":259,"line":476},[257,8973,8974],{},"    [\"4\"] = \"r\",\n",[257,8976,8977],{"class":259,"line":487},[257,8978,8979],{},"    [\"5\"] = \"t\",\n",[257,8981,8982],{"class":259,"line":494},[257,8983,8984],{},"    [\"6\"] = \"y\",\n",[257,8986,8987],{"class":259,"line":554},[257,8988,8989],{},"    [\"7\"] = \"u\",\n",[257,8991,8992],{"class":259,"line":582},[257,8993,8994],{},"    [\"8\"] = \"i\",\n",[257,8996,8997],{"class":259,"line":630},[257,8998,8999],{},"    [\"9\"] = \"o\",\n",[257,9001,9002],{"class":259,"line":636},[257,9003,9004],{},"    [\"0\"] = \"p\",\n",[257,9006,9007],{"class":259,"line":645},[257,9008,373],{},[257,9010,9011],{"class":259,"line":651},[257,9012,9013],{},"M.mapNum = function(keysString)\n",[257,9015,9016],{"class":259,"line":671},[257,9017,9018],{},"    local str = \"\"\n",[257,9020,9021],{"class":259,"line":680},[257,9022,9023],{},"    for i = 1, #keysString do\n",[257,9025,9026],{"class":259,"line":685},[257,9027,9028],{},"        local prevPrevChar = i > 2 and keysString:sub(i - 2, i - 2) or nil\n",[257,9030,9031],{"class":259,"line":691},[257,9032,294],{"emptyLinePlaceholder":60},[257,9034,9035],{"class":259,"line":711},[257,9036,9037],{},"        local prevChar = i > 1 and keysString:sub(i - 1, i - 1) or nil\n",[257,9039,9040],{"class":259,"line":723},[257,9041,9042],{},"        local char = keysString:sub(i, i)\n",[257,9044,9045],{"class":259,"line":728},[257,9046,9047],{},"        local isNumber = tonumber(char) ~= nil\n",[257,9049,9050],{"class":259,"line":806},[257,9051,9052],{},"        local prevIsNumber = prevChar ~= nil and tonumber(prevChar) ~= nil\n",[257,9054,9055],{"class":259,"line":812},[257,9056,9057],{},"        local prevIsAllowed = prevChar == nil or prevChar ~= \"F\" or prevIsNumber\n",[257,9059,9060],{"class":259,"line":835},[257,9061,9062],{},"        local prevPrevIsAllowed = prevPrevChar == nil or prevPrevChar ~= \"F\"\n",[257,9064,9065],{"class":259,"line":880},[257,9066,9067],{},"        if isNumber and prevIsAllowed and prevPrevIsAllowed then\n",[257,9069,9070],{"class":259,"line":912},[257,9071,9072],{},"            str = str .. replacements[char]\n",[257,9074,9075],{"class":259,"line":919},[257,9076,9077],{},"        else\n",[257,9079,9080],{"class":259,"line":1917},[257,9081,9082],{},"            str = str .. char\n",[257,9084,9085],{"class":259,"line":1923},[257,9086,8861],{},[257,9088,9089],{"class":259,"line":2481},[257,9090,8831],{},[257,9092,9093],{"class":259,"line":2496},[257,9094,9095],{},"    return config.baseSequence .. str\n",[257,9097,9098],{"class":259,"line":2501},[257,9099,8870],{},[257,9101,9102],{"class":259,"line":2527},[257,9103,294],{"emptyLinePlaceholder":60},[257,9105,9106],{"class":259,"line":2555},[257,9107,9108],{},"return M\n",[70,9110,9111],{},"It can then be used like so:",[247,9113,9115],{"className":8685,"code":9114,"language":8687,"meta":252,"style":252},"local mn = require(\"utils\").mapNum\n\nvim.keymap.set(\"n\", mn(\"\u003CC-1>\"), ...)\n-- will not remap F1\nvim.keymap.set(\"n\", mn(\"\u003CC-F1>\"), ...) \n",[254,9116,9117,9122,9126,9131,9136],{"__ignoreMap":252},[257,9118,9119],{"class":259,"line":260},[257,9120,9121],{},"local mn = require(\"utils\").mapNum\n",[257,9123,9124],{"class":259,"line":291},[257,9125,294],{"emptyLinePlaceholder":60},[257,9127,9128],{"class":259,"line":297},[257,9129,9130],{},"vim.keymap.set(\"n\", mn(\"\u003CC-1>\"), ...)\n",[257,9132,9133],{"class":259,"line":316},[257,9134,9135],{},"-- will not remap F1\n",[257,9137,9138],{"class":259,"line":333},[257,9139,9140],{},"vim.keymap.set(\"n\", mn(\"\u003CC-F1>\"), ...)\n",[70,9142,9143],{},"How to get a local module to actually load using lazy.nvim is out of scope for this post, but I might write one on that later because it was not very straightforward.",[5826,9145,6474],{},{"title":252,"searchDepth":291,"depth":291,"links":9147},[],"2023-07-01T00:00:00.000Z","Some lua functions to make it possible to use Modifier+Number shortcuts (e.g.Ctrl+1) in neovim.","/thumbs/neovim-wezterm-icon.png",[8687],{},"---\ntitle: \"How to map Mod+Number keys in Vim/Neovim (using Wezterm)\"\ndate: 2023-07-01\ntags: [\"neovim\", \"wezterm\"]\nlangs: [\"lua\"]\npublished: true\ndescription: \"Some lua functions to make it possible to use Modifier+Number shortcuts (e.g.Ctrl+1) in neovim.\"\nimage: \"/thumbs/neovim-wezterm-icon.png\"\n---\n\nI've been recently giving neovim a serious try (this is my fourth/fifth attempt). And I think this time it's going to work out, but I really miss Modifier+Number shortcuts.\n\nUsually you cannot map to modifies + number keys in in neovim (e.g. Ctrl+1). You can [try to map the raw key sequences](https://vi.stackexchange.com/questions/19358/cannot-map-ctrl-number-except-6-or) but this is a pain and does not work for all numbers.\n\nThe best way to get around this is to map to an obscure keybinding then make the terminal remap Mod+Number to those odd keybindings. I never got around to actually doing this usually because most terminal's configs are static it's also often a pain to remap keys (e.g. [kitty, I like you, but...](https://sw.kovidgoyal.net/kitty/conf/#shortcut-kitty.Send-arbitrary-text-on-key-presses))\n\nAlso the ideal way to do this is to map them to a key chain like `{ObscureCombo} {Mods}+{Remap}` so as to not take up useful keys. But that's even more painful.\n\nRecently though I tried and switched to [wezterm](https://github.com/wez/wezterm) for my terminal emulator, and it's configured through lua which makes this super easy to do for all sequences.\n\nFor example, I picked `Ctrl+Alt+Shift+F12` for the obscure key combo and letters for the remap part. So `Ctrl+1` would map to `Ctrl+Alt+Shift+F12 Ctrl+q`.\n\nThe letter mapping is to avoid breaking anything. If we mapped them to, for example, the F keys again, we might accidentally shoot ourselves in the foot when pressing `Alt+4` .\n\nNote that we also can't map the numbers without the modifiers, since wezterm has no way to know if we're in normal mode or not, and we would be left unable to type numbers if we did so.\n\nHere's my wezterm function for remapping with all mods.\n\n```lua\n-- Allows using Mods+Number in the receiving program if it does not support it.\n-- In the receiving program, the keymap needs to be `\u003CC-A-S-F12> \u003CMods-F{q-p}>`\nlocal remapModNumber = function(keyConfig, modsToRemap)\n\t-- it's not \u003CMods-F{Number}> for obvious reasons (i.e. A-F4)\n\tlocal numMap = {\n\t\t[\"1\"] = \"q\",\n\t\t[\"2\"] = \"w\",\n\t\t[\"3\"] = \"e\",\n\t\t[\"4\"] = \"r\",\n\t\t[\"5\"] = \"t\",\n\t\t[\"6\"] = \"y\",\n\t\t[\"7\"] = \"u\",\n\t\t[\"8\"] = \"i\",\n\t\t[\"9\"] = \"o\",\n\t\t[\"0\"] = \"p\",\n\t}\n\n\tlocal createModNumberRemap = function(key, mods)\n\t\tlocal res = {\n\t\t\tkey = key,\n\t\t\tmods = mods,\n\t\t\taction = act.Multiple({\n\t\t\t\t--obscure key to use as base\n\t\t\t\tact.SendKey({ key = \"F12\", mods = \"CTRL|SHIFT|ALT\" }),\n\t\t\t\tact.SendKey({ key = numMap[key], mods = mods }),\n\t\t\t}),\n\t\t}\n\t\treturn res\n\tend\n\tprint(keyConfig)\n\tfor i = 0, 9 do\n\t\tfor _, mod in ipairs(modsToRemap) do\n\t\t\t-- cant insert normally???\n\t\t\tkeyConfig[#keyConfig + 1] = createModNumberRemap(tostring(i), mod)\n\t\tend\n\tend\nend\nconfig.keys = {\n\t-- ...your other keybindings\n}\n\nremapModNumber(config.keys, { \"CTRL\", \"SHIFT\", \"ALT\", \"CTRL|ALT\", \"ALT|SHIFT\", \"CTRL|SHIFT\", \"ALT|CTRL\", \"CTRL|SHIFT|ALT\" })\n```\n\nThen in vim, if we wanted to use `\u003CC-1>` we would map to `\u003CC-S-A-F12>\u003CC-q>`.\n\nI've also added a small helper function in my local utils module to help with this. I might extract this later into a plugin.\n\n```lua\nlocal M = {}\nlocal config = {\n\tbaseSequence = \"\u003CC-S-A-F12>\",\n}\nM.setup = function(opts)\n\topts = opts or {}\n\tvim.tbl_extend(\"force\", config, opts)\nend\nlocal replacements = {\n\t[\"1\"] = \"q\",\n\t[\"2\"] = \"w\",\n\t[\"3\"] = \"e\",\n\t[\"4\"] = \"r\",\n\t[\"5\"] = \"t\",\n\t[\"6\"] = \"y\",\n\t[\"7\"] = \"u\",\n\t[\"8\"] = \"i\",\n\t[\"9\"] = \"o\",\n\t[\"0\"] = \"p\",\n}\nM.mapNum = function(keysString)\n\tlocal str = \"\"\n\tfor i = 1, #keysString do\n\t\tlocal prevPrevChar = i > 2 and keysString:sub(i - 2, i - 2) or nil\n\n\t\tlocal prevChar = i > 1 and keysString:sub(i - 1, i - 1) or nil\n\t\tlocal char = keysString:sub(i, i)\n\t\tlocal isNumber = tonumber(char) ~= nil\n\t\tlocal prevIsNumber = prevChar ~= nil and tonumber(prevChar) ~= nil\n\t\tlocal prevIsAllowed = prevChar == nil or prevChar ~= \"F\" or prevIsNumber\n\t\tlocal prevPrevIsAllowed = prevPrevChar == nil or prevPrevChar ~= \"F\"\n\t\tif isNumber and prevIsAllowed and prevPrevIsAllowed then\n\t\t\tstr = str .. replacements[char]\n\t\telse\n\t\t\tstr = str .. char\n\t\tend\n\tend\n\treturn config.baseSequence .. str\nend\n\nreturn M\n```\n\nIt can then be used like so:\n```lua\nlocal mn = require(\"utils\").mapNum\n\nvim.keymap.set(\"n\", mn(\"\u003CC-1>\"), ...)\n-- will not remap F1\nvim.keymap.set(\"n\", mn(\"\u003CC-F1>\"), ...) \n```\n\nHow to get a local module to actually load using lazy.nvim is out of scope for this post, but I might write one on that later because it was not very straightforward.\n",{"title":30,"description":9149},[9156,8654],"neovim","JzZEzUM2UWLZvU3KZ-MB0cCLaAKIBeS3kam4p-ySotc",{"id":9159,"title":38,"body":9160,"date":9857,"description":9858,"extension":6160,"image":57,"langs":9859,"meta":9860,"navigation":60,"path":39,"published":60,"rawbody":9861,"seo":9862,"static_image":57,"stem":40,"tags":9863,"video_image":57,"__hash__":9864},"blog/blog/satisfies.md",{"type":67,"value":9161,"toc":9855},[9162,9175,9178,9181,9184,9547,9553,9559,9629,9635,9641,9719,9739,9751,9837,9840,9846,9849,9852],[70,9163,9164,9165,9168,9169,9174],{},"Typescript's new ",[254,9166,9167],{},"satisfies"," is great for it's ",[74,9170,9173],{"href":9171,"rel":9172},"https://www.typescriptlang.org/docs/handbook/release-notes/typescript-4-9.html#the-satisfies-operator",[78],"intended use case",", but it's also great for the following use case.",[70,9176,9177],{},"Writing libraries I often run into the following problem:",[70,9179,9180],{},"I want the user to have nice types when using a method, especially in a class, but this often requires complicated types and conditional returns which cannot be handled nicely internally.",[70,9182,9183],{},"Here's a very simple contrived example:",[247,9185,9187],{"className":249,"code":9186,"language":251,"meta":252,"style":252},"type MyType\u003CT> = {value: T}\n\nclass MyClass \u003CT extends MyType\u003Cany>, TCondition extends boolean = false> {\n    public entries: T[] = []\n    public condition: TCondition =false as TCondition\n    constructor(condition:TCondition, entries: T[]) {\n\n    }\n    /** Returns different depending on how the class is instantiated.*/\n    createEntry\u003CTEntry extends MyType\u003Cany>>(val: TEntry): TCondition extends true ? MyType\u003Ctrue> : MyType\u003Cfalse>  {\n        // we get the following error for both returns:\n        // Type '{ value: false; }' is not assignable to type 'TCondition extends true ? MyType\u003Ctrue> : MyType\u003Cfalse>'.\n        if (this.condition) {\n                return {value: true}\n        } else {\n                return {value: false}\n        }\n    }\n}\n\nconst myClass = new MyClass(true, [])\n\n// res = {value: true}\nconst res = myClass.createEntry({value: \"some val\"})\n",[254,9188,9189,9216,9220,9260,9279,9300,9330,9334,9338,9343,9403,9408,9413,9427,9442,9450,9464,9468,9472,9476,9480,9502,9506,9511],{"__ignoreMap":252},[257,9190,9191,9193,9196,9198,9201,9203,9205,9207,9209,9211,9214],{"class":259,"line":260},[257,9192,3756],{"class":303},[257,9194,9195],{"class":397}," MyType",[257,9197,394],{"class":267},[257,9199,9200],{"class":397},"T",[257,9202,401],{"class":267},[257,9204,444],{"class":267},[257,9206,268],{"class":267},[257,9208,1450],{"class":319},[257,9210,323],{"class":267},[257,9212,9213],{"class":397}," T",[257,9215,373],{"class":267},[257,9217,9218],{"class":259,"line":291},[257,9219,294],{"emptyLinePlaceholder":60},[257,9221,9222,9224,9227,9229,9231,9234,9236,9238,9241,9244,9247,9249,9252,9254,9256,9258],{"class":259,"line":297},[257,9223,963],{"class":303},[257,9225,9226],{"class":397}," MyClass",[257,9228,4527],{"class":267},[257,9230,9200],{"class":397},[257,9232,9233],{"class":303}," extends",[257,9235,9195],{"class":397},[257,9237,394],{"class":267},[257,9239,9240],{"class":397},"any",[257,9242,9243],{"class":267},">,",[257,9245,9246],{"class":397}," TCondition",[257,9248,9233],{"class":303},[257,9250,9251],{"class":397}," boolean",[257,9253,444],{"class":267},[257,9255,4996],{"class":397},[257,9257,401],{"class":267},[257,9259,313],{"class":267},[257,9261,9262,9265,9268,9270,9272,9275,9277],{"class":259,"line":316},[257,9263,9264],{"class":303},"    public",[257,9266,9267],{"class":319}," entries",[257,9269,323],{"class":267},[257,9271,9213],{"class":397},[257,9273,9274],{"class":271},"[] ",[257,9276,310],{"class":267},[257,9278,978],{"class":271},[257,9280,9281,9283,9286,9288,9290,9292,9295,9297],{"class":259,"line":333},[257,9282,9264],{"class":303},[257,9284,9285],{"class":319}," condition",[257,9287,323],{"class":267},[257,9289,9246],{"class":397},[257,9291,444],{"class":267},[257,9293,9294],{"class":1001},"false",[257,9296,3717],{"class":263},[257,9298,9299],{"class":397}," TCondition\n",[257,9301,9302,9305,9307,9310,9312,9315,9317,9319,9321,9323,9326,9328],{"class":259,"line":346},[257,9303,9304],{"class":303},"    constructor",[257,9306,418],{"class":267},[257,9308,9309],{"class":421},"condition",[257,9311,323],{"class":267},[257,9313,9314],{"class":397},"TCondition",[257,9316,534],{"class":267},[257,9318,9267],{"class":421},[257,9320,323],{"class":267},[257,9322,9213],{"class":397},[257,9324,9325],{"class":271},"[]",[257,9327,430],{"class":267},[257,9329,313],{"class":267},[257,9331,9332],{"class":259,"line":359},[257,9333,294],{"emptyLinePlaceholder":60},[257,9335,9336],{"class":259,"line":370},[257,9337,1118],{"class":267},[257,9339,9340],{"class":259,"line":376},[257,9341,9342],{"class":490},"    /** Returns different depending on how the class is instantiated.*/\n",[257,9344,9345,9348,9350,9353,9355,9357,9359,9361,9364,9367,9369,9372,9374,9376,9378,9380,9382,9384,9386,9388,9390,9392,9394,9396,9398,9400],{"class":259,"line":407},[257,9346,9347],{"class":319},"    createEntry",[257,9349,394],{"class":267},[257,9351,9352],{"class":397},"TEntry",[257,9354,9233],{"class":303},[257,9356,9195],{"class":397},[257,9358,394],{"class":267},[257,9360,9240],{"class":397},[257,9362,9363],{"class":267},">>(",[257,9365,9366],{"class":421},"val",[257,9368,323],{"class":267},[257,9370,9371],{"class":397}," TEntry",[257,9373,6758],{"class":267},[257,9375,9246],{"class":397},[257,9377,9233],{"class":303},[257,9379,4949],{"class":397},[257,9381,2196],{"class":267},[257,9383,9195],{"class":397},[257,9385,394],{"class":267},[257,9387,136],{"class":397},[257,9389,401],{"class":267},[257,9391,8159],{"class":267},[257,9393,9195],{"class":397},[257,9395,394],{"class":267},[257,9397,9294],{"class":397},[257,9399,401],{"class":267},[257,9401,9402],{"class":267},"  {\n",[257,9404,9405],{"class":259,"line":435},[257,9406,9407],{"class":490},"        // we get the following error for both returns:\n",[257,9409,9410],{"class":259,"line":459},[257,9411,9412],{"class":490},"        // Type '{ value: false; }' is not assignable to type 'TCondition extends true ? MyType\u003Ctrue> : MyType\u003Cfalse>'.\n",[257,9414,9415,9417,9419,9421,9423,9425],{"class":259,"line":476},[257,9416,1137],{"class":263},[257,9418,560],{"class":319},[257,9420,1025],{"class":267},[257,9422,9309],{"class":271},[257,9424,1096],{"class":319},[257,9426,579],{"class":267},[257,9428,9429,9432,9434,9436,9438,9440],{"class":259,"line":487},[257,9430,9431],{"class":263},"                return",[257,9433,268],{"class":267},[257,9435,1450],{"class":319},[257,9437,323],{"class":267},[257,9439,4949],{"class":1001},[257,9441,373],{"class":267},[257,9443,9444,9446,9448],{"class":259,"line":494},[257,9445,1051],{"class":267},[257,9447,2779],{"class":263},[257,9449,313],{"class":267},[257,9451,9452,9454,9456,9458,9460,9462],{"class":259,"line":554},[257,9453,9431],{"class":263},[257,9455,268],{"class":267},[257,9457,1450],{"class":319},[257,9459,323],{"class":267},[257,9461,4996],{"class":1001},[257,9463,373],{"class":267},[257,9465,9466],{"class":259,"line":582},[257,9467,648],{"class":267},[257,9469,9470],{"class":259,"line":630},[257,9471,1118],{"class":267},[257,9473,9474],{"class":259,"line":636},[257,9475,373],{"class":267},[257,9477,9478],{"class":259,"line":645},[257,9479,294],{"emptyLinePlaceholder":60},[257,9481,9482,9484,9487,9489,9491,9493,9495,9497,9499],{"class":259,"line":651},[257,9483,379],{"class":303},[257,9485,9486],{"class":271}," myClass ",[257,9488,310],{"class":267},[257,9490,387],{"class":267},[257,9492,9226],{"class":390},[257,9494,418],{"class":271},[257,9496,136],{"class":1001},[257,9498,534],{"class":267},[257,9500,9501],{"class":271}," [])\n",[257,9503,9504],{"class":259,"line":671},[257,9505,294],{"emptyLinePlaceholder":60},[257,9507,9508],{"class":259,"line":680},[257,9509,9510],{"class":490},"// res = {value: true}\n",[257,9512,9513,9515,9518,9520,9523,9525,9528,9530,9532,9534,9536,9538,9541,9543,9545],{"class":259,"line":685},[257,9514,379],{"class":303},[257,9516,9517],{"class":271}," res ",[257,9519,310],{"class":267},[257,9521,9522],{"class":271}," myClass",[257,9524,450],{"class":267},[257,9526,9527],{"class":390},"createEntry",[257,9529,418],{"class":271},[257,9531,518],{"class":267},[257,9533,1450],{"class":319},[257,9535,323],{"class":267},[257,9537,281],{"class":267},[257,9539,9540],{"class":284},"some val",[257,9542,664],{"class":267},[257,9544,759],{"class":267},[257,9546,551],{"class":271},[70,9548,9549,9550,9552],{},"For the user, the types are correct, but internally for us as developers they are very hard to work with. They can become a mess of cast types, often even as ",[254,9551,9240],{}," if there's a lot of conditional generics magic happening. I've found modifying objects or building objects to add to classes expecially painful.",[70,9554,9555,9556,450],{},"In the example you could cast as the return type but this is not safe if the value we're returning could satisfy either type. It's like, but not exactly like, casting ",[254,9557,9558],{},"as MyType\u003Cboolean>",[247,9560,9562],{"className":249,"code":9561,"language":251,"meta":252,"style":252},"if (this.condition) {\n    // no error\n    return {value: false} as TCondition extends true ? MyType\u003Ctrue> : MyType\u003Cfalse>\n}\n",[254,9563,9564,9578,9583,9625],{"__ignoreMap":252},[257,9565,9566,9569,9571,9573,9576],{"class":259,"line":260},[257,9567,9568],{"class":263},"if",[257,9570,560],{"class":271},[257,9572,1025],{"class":267},[257,9574,9575],{"class":271},"condition) ",[257,9577,579],{"class":267},[257,9579,9580],{"class":259,"line":291},[257,9581,9582],{"class":490},"    // no error\n",[257,9584,9585,9587,9589,9591,9593,9595,9597,9599,9601,9603,9605,9607,9609,9611,9613,9615,9617,9619,9621,9623],{"class":259,"line":297},[257,9586,674],{"class":263},[257,9588,268],{"class":267},[257,9590,1450],{"class":319},[257,9592,323],{"class":267},[257,9594,4996],{"class":1001},[257,9596,759],{"class":267},[257,9598,3717],{"class":263},[257,9600,9246],{"class":397},[257,9602,9233],{"class":303},[257,9604,4949],{"class":397},[257,9606,2196],{"class":267},[257,9608,9195],{"class":397},[257,9610,394],{"class":267},[257,9612,136],{"class":397},[257,9614,401],{"class":267},[257,9616,8159],{"class":267},[257,9618,9195],{"class":397},[257,9620,394],{"class":267},[257,9622,9294],{"class":397},[257,9624,6568],{"class":267},[257,9626,9627],{"class":259,"line":316},[257,9628,373],{"class":267},[70,9630,9631,9632,9634],{},"That's where the new ",[254,9633,9167],{}," operator can come in handy.",[70,9636,9637,9638,9640],{},"By itself it won't fix the error. If we do the following, it won't work, the types of the return ",[103,9639,3512],{}," are already correct.",[247,9642,9644],{"className":249,"code":9643,"language":251,"meta":252,"style":252},"if (this.condition) {\n    return {value: true} satisfies MyType\u003Ctrue>\n} else {\n    return {value: false} satisfies MyType\u003Cfalse>\n}\n",[254,9645,9646,9658,9683,9691,9715],{"__ignoreMap":252},[257,9647,9648,9650,9652,9654,9656],{"class":259,"line":260},[257,9649,9568],{"class":263},[257,9651,560],{"class":271},[257,9653,1025],{"class":267},[257,9655,9575],{"class":271},[257,9657,579],{"class":267},[257,9659,9660,9662,9664,9666,9668,9670,9672,9675,9677,9679,9681],{"class":259,"line":291},[257,9661,674],{"class":263},[257,9663,268],{"class":267},[257,9665,1450],{"class":319},[257,9667,323],{"class":267},[257,9669,4949],{"class":1001},[257,9671,759],{"class":267},[257,9673,9674],{"class":263}," satisfies",[257,9676,9195],{"class":397},[257,9678,394],{"class":267},[257,9680,136],{"class":397},[257,9682,6568],{"class":267},[257,9684,9685,9687,9689],{"class":259,"line":297},[257,9686,759],{"class":267},[257,9688,2779],{"class":263},[257,9690,313],{"class":267},[257,9692,9693,9695,9697,9699,9701,9703,9705,9707,9709,9711,9713],{"class":259,"line":316},[257,9694,674],{"class":263},[257,9696,268],{"class":267},[257,9698,1450],{"class":319},[257,9700,323],{"class":267},[257,9702,4996],{"class":1001},[257,9704,759],{"class":267},[257,9706,9674],{"class":263},[257,9708,9195],{"class":397},[257,9710,394],{"class":267},[257,9712,9294],{"class":397},[257,9714,6568],{"class":267},[257,9716,9717],{"class":259,"line":333},[257,9718,373],{"class":267},[70,9720,9721,9722,9725,9726,208,9729,8082,9734,6721],{},"This is because the real problem is typescript doesn't narrow the type of the ",[103,9723,9724],{},"return type"," based on ",[254,9727,9728],{},"this.condition",[74,9730,9733],{"href":9731,"rel":9732},"https://github.com/microsoft/TypeScript/issues/24929",[78],"#24929",[74,9735,9738],{"href":9736,"rel":9737},"https://github.com/microsoft/TypeScript/issues/33014",[78],"#33014",[70,9740,9741,9742,9744,9745,9748,9749,323],{},"But we can use ",[254,9743,9167],{}," to keep the expected type safety ",[103,9746,9747],{},"while"," casting as ",[254,9750,9240],{},[247,9752,9754],{"className":249,"code":9753,"language":251,"meta":252,"style":252},"if (this.condition) {\n    return {value: true} satisfies MyType\u003Ctrue> as any\n} else {\n    return {value: false} satisfies MyType\u003Cfalse> as any\n}\n",[254,9755,9756,9768,9797,9805,9833],{"__ignoreMap":252},[257,9757,9758,9760,9762,9764,9766],{"class":259,"line":260},[257,9759,9568],{"class":263},[257,9761,560],{"class":271},[257,9763,1025],{"class":267},[257,9765,9575],{"class":271},[257,9767,579],{"class":267},[257,9769,9770,9772,9774,9776,9778,9780,9782,9784,9786,9788,9790,9792,9794],{"class":259,"line":291},[257,9771,674],{"class":263},[257,9773,268],{"class":267},[257,9775,1450],{"class":319},[257,9777,323],{"class":267},[257,9779,4949],{"class":1001},[257,9781,759],{"class":267},[257,9783,9674],{"class":263},[257,9785,9195],{"class":397},[257,9787,394],{"class":267},[257,9789,136],{"class":397},[257,9791,401],{"class":267},[257,9793,3717],{"class":263},[257,9795,9796],{"class":397}," any\n",[257,9798,9799,9801,9803],{"class":259,"line":297},[257,9800,759],{"class":267},[257,9802,2779],{"class":263},[257,9804,313],{"class":267},[257,9806,9807,9809,9811,9813,9815,9817,9819,9821,9823,9825,9827,9829,9831],{"class":259,"line":316},[257,9808,674],{"class":263},[257,9810,268],{"class":267},[257,9812,1450],{"class":319},[257,9814,323],{"class":267},[257,9816,4996],{"class":1001},[257,9818,759],{"class":267},[257,9820,9674],{"class":263},[257,9822,9195],{"class":397},[257,9824,394],{"class":267},[257,9826,9294],{"class":397},[257,9828,401],{"class":267},[257,9830,3717],{"class":263},[257,9832,9796],{"class":397},[257,9834,9835],{"class":259,"line":333},[257,9836,373],{"class":267},[70,9838,9839],{},"This prevents us from not satisfying the type we expect before casting.",[247,9841,9844],{"className":9842,"code":9843,"language":2664},[6210],"// Type 'false' is not assignable to type 'true'.\nreturn {value: false} satisfies MyType\u003Ctrue> as any\n",[254,9845,9843],{"__ignoreMap":252},[70,9847,9848],{},"It can be very useful for keeping a more relaxed level of type safety inside very strictly typed classes.",[70,9850,9851],{},"The only error prone thing about doing this is that you do have to know what type you're expecting, but this is a lot safer than no safety at all.",[5826,9853,9854],{},"html pre.shiki code .spNyl, html code.shiki .spNyl{--shiki-light:#9C3EDA;--shiki-default:#C792EA;--shiki-dark:#C792EA}html pre.shiki code .sBMFI, html code.shiki .sBMFI{--shiki-light:#E2931D;--shiki-default:#FFCB6B;--shiki-dark:#FFCB6B}html pre.shiki code .sMK4o, html code.shiki .sMK4o{--shiki-light:#39ADB5;--shiki-default:#89DDFF;--shiki-dark:#89DDFF}html pre.shiki code .swJcz, html code.shiki .swJcz{--shiki-light:#E53935;--shiki-default:#F07178;--shiki-dark:#F07178}html pre.shiki code .sTEyZ, html code.shiki .sTEyZ{--shiki-light:#90A4AE;--shiki-default:#EEFFFF;--shiki-dark:#BABED8}html pre.shiki code .sfNiH, html code.shiki .sfNiH{--shiki-light:#FF5370;--shiki-default:#FF9CAC;--shiki-dark:#FF9CAC}html pre.shiki code .s7zQu, html code.shiki .s7zQu{--shiki-light:#39ADB5;--shiki-light-font-style:italic;--shiki-default:#89DDFF;--shiki-default-font-style:italic;--shiki-dark:#89DDFF;--shiki-dark-font-style:italic}html pre.shiki code .sHdIc, html code.shiki .sHdIc{--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-default:#EEFFFF;--shiki-default-font-style:italic;--shiki-dark:#BABED8;--shiki-dark-font-style:italic}html pre.shiki code .sHwdD, html code.shiki .sHwdD{--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-default:#546E7A;--shiki-default-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic}html pre.shiki code .s2Zo4, html code.shiki .s2Zo4{--shiki-light:#6182B8;--shiki-default:#82AAFF;--shiki-dark:#82AAFF}html pre.shiki code .sfazB, html code.shiki .sfazB{--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D}html .light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html.light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}",{"title":252,"searchDepth":291,"depth":291,"links":9856},[],"2022-10-10T00:00:00.000Z","Typescript's new satisfies is great for it's intended use case, but it's also great for the following use case.",[6163],{},"---\ntitle: \"Abusing Typescript's New `satisfies` Operator\"\ndate: \"2022-10-10\"\npublished: true\ntags: [\"tip\"]\nlangs: [\"typescript\"]\n---\nTypescript's new `satisfies` is great for it's [intended use case](https://www.typescriptlang.org/docs/handbook/release-notes/typescript-4-9.html#the-satisfies-operator), but it's also great for the following use case.\n\nWriting libraries I often run into the following problem:\n\nI want the user to have nice types when using a method, especially in a class, but this often requires complicated types and conditional returns which cannot be handled nicely internally.\n\nHere's a very simple contrived example:\n\n```ts\ntype MyType\u003CT> = {value: T}\n\nclass MyClass \u003CT extends MyType\u003Cany>, TCondition extends boolean = false> {\n\tpublic entries: T[] = []\n\tpublic condition: TCondition =false as TCondition\n\tconstructor(condition:TCondition, entries: T[]) {\n\n\t}\n\t/** Returns different depending on how the class is instantiated.*/\n\tcreateEntry\u003CTEntry extends MyType\u003Cany>>(val: TEntry): TCondition extends true ? MyType\u003Ctrue> : MyType\u003Cfalse>  {\n\t\t// we get the following error for both returns:\n\t\t// Type '{ value: false; }' is not assignable to type 'TCondition extends true ? MyType\u003Ctrue> : MyType\u003Cfalse>'.\n\t\tif (this.condition) {\n\t\t\t\treturn {value: true}\n\t\t} else {\n\t\t\t\treturn {value: false}\n\t\t}\n\t}\n}\n\nconst myClass = new MyClass(true, [])\n\n// res = {value: true}\nconst res = myClass.createEntry({value: \"some val\"})\n```\n\nFor the user, the types are correct, but internally for us as developers they are very hard to work with. They can become a mess of cast types, often even as `any` if there's a lot of conditional generics magic happening. I've found modifying objects or building objects to add to classes expecially painful.\n\nIn the example you could cast as the return type but this is not safe if the value we're returning could satisfy either type. It's like, but not exactly like, casting `as MyType\u003Cboolean>`. \n\n\n```ts\nif (this.condition) {\n\t// no error\n\treturn {value: false} as TCondition extends true ? MyType\u003Ctrue> : MyType\u003Cfalse>\n}\n```\n\nThat's where the new `satisfies` operator can come in handy.\n\nBy itself it won't fix the error. If we do the following, it won't work, the types of the return *values* are already correct. \n\n```ts\nif (this.condition) {\n\treturn {value: true} satisfies MyType\u003Ctrue>\n} else {\n\treturn {value: false} satisfies MyType\u003Cfalse>\n}\n```\nThis is because the real problem is typescript doesn't narrow the type of the *return type* based on `this.condition` (see [#24929](https://github.com/microsoft/TypeScript/issues/24929) and [#33014](https://github.com/microsoft/TypeScript/issues/33014)).\n\n\nBut we can use `satisfies` to keep the expected type safety *while* casting as `any`:\n\n```ts\nif (this.condition) {\n\treturn {value: true} satisfies MyType\u003Ctrue> as any\n} else {\n\treturn {value: false} satisfies MyType\u003Cfalse> as any\n}\n```\n\nThis prevents us from not satisfying the type we expect before casting.\n\n```\n// Type 'false' is not assignable to type 'true'.\nreturn {value: false} satisfies MyType\u003Ctrue> as any\n```\n\nIt can be very useful for keeping a more relaxed level of type safety inside very strictly typed classes.\n\nThe only error prone thing about doing this is that you do have to know what type you're expecting, but this is a lot safer than no safety at all.\n",{"title":38,"description":9858},[6680],"0iY8EYOdJLK9QmCtJvKnnZsB8vYsLhxPOq9Ht6stp2U",{"id":9866,"title":26,"body":9867,"date":9971,"description":9972,"extension":6160,"image":9945,"langs":9973,"meta":9975,"navigation":60,"path":27,"published":60,"rawbody":9977,"seo":9978,"static_image":57,"stem":28,"tags":9979,"video_image":57,"__hash__":9982},"blog/blog/krita-brush-pr.md",{"type":67,"value":9868,"toc":9969},[9869,9872,9875,9878,9885,9894,9897,9900,9903,9906,9915,9924,9927,9930,9933,9936,9939,9947,9950,9953,9956,9961],[70,9870,9871],{},"I switched to Krita from Photoshop a while back now. Photoshop has not really improved it's painting experience in any wayfor a long time and it's had some long standing brush engine related bugs that annoy me to no end.",[70,9873,9874],{},"Krita on the other hand was a little bit rough around the edges, but has some of the best brush engines around (yes, multiple engines), and it's constantly being improved. Plus, it's open source. If something bothers me, I can try to fix it.",[70,9876,9877],{},"One of the little things that did bother me is Krita's popup palette. It had too much going on in my opinion, with no way to disable some parts of it. The number of brush slots had to be pre set in the configuration and they did not use the optimal space. There were also some minor bugs.",[70,9879,9880,9881,450],{},"I went into this knowing zero C++, never having really built a program like this. It was quite the learning experience, but I finally got everything I wanted fixed and merged! You can find more details about the PR ",[74,9882,8434],{"href":9883,"rel":9884},"https://invent.kde.org/graphics/krita/-/merge_requests/922",[78],[70,9886,9887,9888,9893],{},"Krita has some good build docs, but I'm on windows and between that and all this being new to me, there were a lot of little gotchas. I documented them all and ended up writing myself some simple build scripts to simplify everything. I published these along with my VSCode setup and all my notes on ",[74,9889,9892],{"href":9890,"rel":9891},"https://github.com/AlansCodeLog/krita-build-vscode-config",[78],"github",". Hope it might help others in a similar situation.",[70,9895,9896],{},"Anyways I initially started with the simple stuff. The small bug fixes to get familiar with the code base. It's huge so it helps to focus on some small area. Now this might seem obvious, but I know to my beginner self it was not. My go to strategy for finding something in such a large code base is to search for some text at/near what I want to change and go from there. I do not really try to understand the organization of the project. Enough will emerge from looking at related files to understand what I need. Usually it is not more than a couple of files that you'll need to look at to change something.",[70,9898,9899],{},"When in doubt there was also the very helpful Krita dev IRC chat to point me in the right direction.",[70,9901,9902],{},"The C++ was not as scary as I thought it would be. It's not like you have to deal with pointers or memory management that much at all. You just have to get used to the syntax and using header files and that's about it. The key really is to have your editor setup properly so you have autocomplete. There's a note on how to do that in the readme of the scripts I published.",[70,9904,9905],{},"Krita is built Qt so it also helped have the Qt docs open at all times.",[70,9907,9908,9909,9914],{},"As I made small fixes, I used ",[74,9910,9913],{"href":9911,"rel":9912},"https://stacked-git.github.io/",[78],"stacked git"," to commit them. I might make a blog post about it later, but it's great for exploratory stuff like this. It makes it super easy to push different changes to different commits, and then later re-order them before submitting a PR. Or temporarily hide some commits for debugging or because they didn't work out.",[70,9916,9917,9918,9923],{},"I also kept multiple ",[74,9919,9922],{"href":9920,"rel":9921},"https://git-scm.com/docs/git-worktree",[78],"git worktrees"," for different branches. Git worktrees if you've never used them, allow you to checkout a branch in a different folder. So I could have many separate branches and builds. I had one for my branch, one for the the master branch, and a third one just for checking out/navigating commits. This is because switching branches will trigger a complete rebuild and that would take 2-3 hours. So worktrees were a must. I could also setup multiple builds like this.",[70,9925,9926],{},"Next I moved on to the more difficult issue I wanted to tackle, the algorithm that laid out the popup palette brush slots. Making it support a dynamic slot count was easy as the widget could already support them, it was just a matter of allowing it in the config and getting the count of brushes for the chosen tag.",[70,9928,9929],{},"What I really wanted to change was the way the slots were drawn, since they were often too small depending on the count and the ring diameters chosen.",[70,9931,9932],{},"Qt widgets have a paintEvent method where one can draw arbitrary lines and shapes. This is how the majority of the popup palette is drawn. I found it similar to drawing on an html canvas which I already had some experience with..",[70,9934,9935],{},"Here I started to just change the colors of the drawn parts and commment/uncomment code until I understood it more, adding my own comments if needed. Once I understood everything I commented out any code not related to the brush slots I wanted to change and started playing with the algorithm which was in a separate area, drawing measurements to the screen if I didn't understand them.",[70,9937,9938],{},"Some demon summoning later and with a similar procress I understood the original algorithm which relied on a couple of loops to try to find the optimal number of rows we could have.",[70,9940,9941],{},[9942,9943],"img",{"alt":9944,"src":9945,"style":9946},"Slots drawn on top of the krita palette.","/thumbs/krita-demon-summoning.png","margin:auto;width:100%;max-width:300px;",[70,9948,9949],{},"I tried to find a geometric approach to calculating the size of the slot circles, but the problem is if we want to allow user control of the diameter of the outer ring, the slots cannot have the same size on every row. We end up limited by how many fit in the inner row.",[70,9951,9952],{},"So I expanded on the original algorithm, adding several checks to shrink/enlarge the slots depending on the situation. These checks are not recursive or complicated in that sence, so while the algorithm is a lot more complex, it still happens in \"steps\", and you can comment out a part and see that it just no longer optimizes the slot sizes in that situation.",[70,9954,9955],{},"Here is the before/after with the rings at various sizes.",[70,9957,9958],{},[134,9959],{"src":9960,"controls":60},"/posts/krita-palette-before-after.mp4",[70,9962,9963,9964,6721],{},"Anyways, this and a few other goodies I added should be out properly in Krita 5.1, otherwise you can try nightly Next builds (they're in the bottom half of the ",[74,9965,9968],{"href":9966,"rel":9967},"https://krita.org/en/download/krita-desktop/",[78],"download page",{"title":252,"searchDepth":291,"depth":291,"links":9970},[],"2021-08-01T00:00:00.000Z","From zero C++ to getting a PR merged into Krita.",[9974],"c++",{"coverAlt":9976},"Debug lines drawn on top of the krita palette.","---\ntitle: \"Krita Popup Palette Improvements\"\ndescription: \"From zero C++ to getting a PR merged into Krita.\"\ndate: \"2021-08-01\"\npublished: true\nimage: \"/thumbs/krita-demon-summoning.png\"\ncoverAlt: \"Debug lines drawn on top of the krita palette.\"\ntags: [\"krita\", \"graphics\"]\nlangs: [\"c++\"]\n---\n\nI switched to Krita from Photoshop a while back now. Photoshop has not really improved it's painting experience in any wayfor a long time and it's had some long standing brush engine related bugs that annoy me to no end.\n\nKrita on the other hand was a little bit rough around the edges, but has some of the best brush engines around (yes, multiple engines), and it's constantly being improved. Plus, it's open source. If something bothers me, I can try to fix it.\n\nOne of the little things that did bother me is Krita's popup palette. It had too much going on in my opinion, with no way to disable some parts of it. The number of brush slots had to be pre set in the configuration and they did not use the optimal space. There were also some minor bugs.\n\nI went into this knowing zero C++, never having really built a program like this. It was quite the learning experience, but I finally got everything I wanted fixed and merged! You can find more details about the PR [here](https://invent.kde.org/graphics/krita/-/merge_requests/922).\n\nKrita has some good build docs, but I'm on windows and between that and all this being new to me, there were a lot of little gotchas. I documented them all and ended up writing myself some simple build scripts to simplify everything. I published these along with my VSCode setup and all my notes on [github](https://github.com/AlansCodeLog/krita-build-vscode-config). Hope it might help others in a similar situation. \n\nAnyways I initially started with the simple stuff. The small bug fixes to get familiar with the code base. It's huge so it helps to focus on some small area. Now this might seem obvious, but I know to my beginner self it was not. My go to strategy for finding something in such a large code base is to search for some text at/near what I want to change and go from there. I do not really try to understand the organization of the project. Enough will emerge from looking at related files to understand what I need. Usually it is not more than a couple of files that you'll need to look at to change something.\n\nWhen in doubt there was also the very helpful Krita dev IRC chat to point me in the right direction.\n\nThe C++ was not as scary as I thought it would be. It's not like you have to deal with pointers or memory management that much at all. You just have to get used to the syntax and using header files and that's about it. The key really is to have your editor setup properly so you have autocomplete. There's a note on how to do that in the readme of the scripts I published.\n\nKrita is built Qt so it also helped have the Qt docs open at all times. \n\nAs I made small fixes, I used [stacked git](https://stacked-git.github.io/) to commit them. I might make a blog post about it later, but it's great for exploratory stuff like this. It makes it super easy to push different changes to different commits, and then later re-order them before submitting a PR. Or temporarily hide some commits for debugging or because they didn't work out. \n\nI also kept multiple [git worktrees](https://git-scm.com/docs/git-worktree) for different branches. Git worktrees if you've never used them, allow you to checkout a branch in a different folder. So I could have many separate branches and builds. I had one for my branch, one for the the master branch, and a third one just for checking out/navigating commits. This is because switching branches will trigger a complete rebuild and that would take 2-3 hours. So worktrees were a must. I could also setup multiple builds like this.\n\nNext I moved on to the more difficult issue I wanted to tackle, the algorithm that laid out the popup palette brush slots. Making it support a dynamic slot count was easy as the widget could already support them, it was just a matter of allowing it in the config and getting the count of brushes for the chosen tag.\n\nWhat I really wanted to change was the way the slots were drawn, since they were often too small depending on the count and the ring diameters chosen.\n\nQt widgets have a paintEvent method where one can draw arbitrary lines and shapes. This is how the majority of the popup palette is drawn. I found it similar to drawing on an html canvas which I already had some experience with..\n\nHere I started to just change the colors of the drawn parts and commment/uncomment code until I understood it more, adding my own comments if needed. Once I understood everything I commented out any code not related to the brush slots I wanted to change and started playing with the algorithm which was in a separate area, drawing measurements to the screen if I didn't understand them.\n\nSome demon summoning later and with a similar procress I understood the original algorithm which relied on a couple of loops to try to find the optimal number of rows we could have.\n\n![Slots drawn on top of the krita palette.](/thumbs/krita-demon-summoning.png){style=\"margin:auto;width:100%;max-width:300px;\"}\n\n\nI tried to find a geometric approach to calculating the size of the slot circles, but the problem is if we want to allow user control of the diameter of the outer ring, the slots cannot have the same size on every row. We end up limited by how many fit in the inner row.\n\nSo I expanded on the original algorithm, adding several checks to shrink/enlarge the slots depending on the situation. These checks are not recursive or complicated in that sence, so while the algorithm is a lot more complex, it still happens in \"steps\", and you can comment out a part and see that it just no longer optimizes the slot sizes in that situation.\n\nHere is the before/after with the rings at various sizes.\n\n\u003Cvideo src=\"/posts/krita-palette-before-after.mp4\" controls>\u003C/video>\n\nAnyways, this and a few other goodies I added should be out properly in Krita 5.1, otherwise you can try nightly Next builds (they're in the bottom half of the [download page](https://krita.org/en/download/krita-desktop/)).\n",{"title":26,"description":9972},[9980,9981],"krita","graphics","I8Oh2___Dk79lvaEiV-LTH6LfqGQmtBphjqRU2gn7UM",{"id":9984,"title":18,"body":9985,"date":10017,"description":10018,"extension":6160,"image":10019,"langs":10020,"meta":10022,"navigation":60,"path":19,"published":60,"rawbody":10023,"seo":10024,"static_image":57,"stem":20,"tags":10025,"video_image":57,"__hash__":10028},"blog/blog/blender-debugger.md",{"type":67,"value":9986,"toc":10015},[9987,9996,10004,10007],[70,9988,9989,9990,9995],{},"I've written a small ",[74,9991,9994],{"href":9992,"rel":9993},"https://github.com/alanscodelog/blender-debugger-for-vscode",[78]," Blender plugin "," to help remote debug Blender plugins. Now that's a mouthful.",[70,9997,9998,9999,10003],{},"This allows the setting of breakpoints in your editor, and stepping through the code. It was mainly written to be compatible with VSCode, hence the name. But some other editors also support connecting to ",[10000,10001,10002],"del",{},"ptvsd"," (edit: it has been changed to use debugpy now).",[70,10005,10006],{},"import { YouTube } from \"@astro-community/astro-embed-youtube\";",[10008,10009,10012],"you-tube",{"id":10010,"poster":10011},"UVDf2VSmRvk","https://i.ytimg.com/vi/UVDf2VSmRvk/maxresdefault.jpg",[70,10013,10014],{},"Full documentation is available on github, but I've also made a video over on my art youtube channel, showing how to set it up and use itfor beginners.",{"title":252,"searchDepth":291,"depth":291,"links":10016},[],"2018-02-23T00:00:00.000Z","A small Blender plugin to help remote debug Blender plugins. ","/thumbs/blender-debugger-cover.jpg",[10021],"python",{},"---\ntitle: Remote Debugging Addon for Blender\ndescription: \"A small Blender plugin to help remote debug Blender plugins. \"\ndate: 2018-02-23\ntags: [\"3d\",\"blender\"]\nlangs: [\"python\"]\npublished: true\nimage: \"/thumbs/blender-debugger-cover.jpg\"\n---\n\nI've written a small [ Blender plugin ](https://github.com/alanscodelog/blender-debugger-for-vscode) to help remote debug Blender plugins. Now that's a mouthful.\n\nThis allows the setting of breakpoints in your editor, and stepping through the code. It was mainly written to be compatible with VSCode, hence the name. But some other editors also support connecting to ~~ptvsd~~ (edit: it has been changed to use debugpy now).\n\nimport { YouTube } from \"@astro-community/astro-embed-youtube\";\n\n\u003CYouTube id=\"UVDf2VSmRvk\" poster=\"https://i.ytimg.com/vi/UVDf2VSmRvk/maxresdefault.jpg\"/>\n\nFull documentation is available on github, but I've also made a video over on my art youtube channel, showing how to set it up and use itfor beginners.\n",{"title":18,"description":10018},[10026,10027],"3d","blender","J0TsDfWxC9Tg7rEfFVmqayYgy21qINJZyRFzL3IriYo",1770083874483]