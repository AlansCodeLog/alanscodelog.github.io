import{U as B,ad as j,aq as H,I as N,o as C,f as E,w as v,r as V,y as M,u as s,ag as T,aP as O,aQ as F,i as I,e as X,x as $,aR as Z,c as k,j as g,aS as L,B as A,d as R,F as G,Y as Q,H as q,aT as Y,aU as J,h as K,ay as ee,aV as te}from"./BKh8bA8C.js";import{D as oe,a as ne,b as ae}from"./BfP8iEm1.js";import{u as ie,f as se,p as le,m as D,P as U,M as z}from"./DXSC_K-z.js";let re=0;function ue(o){const t=new WeakMap,u=ie();function b(a){if(o.mode!=="popLayout")return;const c=a.offsetParent,d=c instanceof HTMLElement&&c.offsetWidth||0,l={height:a.offsetHeight||0,width:a.offsetWidth||0,top:a.offsetTop,left:a.offsetLeft,right:0};l.right=d-l.width-l.left;const p=o.anchorX==="left"?`left: ${l.left}px`:`right: ${l.right}px`,x=`pop-${re++}`;a.dataset.motionPopId=x;const r=document.createElement("style");u.value.nonce&&(r.nonce=u.value.nonce),t.set(a,r),document.head.appendChild(r),r.sheet&&r.sheet.insertRule(`
    [data-motion-pop-id="${x}"] {
      position: absolute !important;
      width: ${l.width}px !important;
      height: ${l.height}px !important;
      top: ${l.top}px !important;
      ${p} !important;
      }
      `)}function y(a){const c=t.get(a);c&&(t.delete(a),se.render(()=>{document.head.removeChild(c)}))}return{addPopStyle:b,removePopStyle:y}}function ce(o){const t=new Map,u=new Set,{addPopStyle:b,removePopStyle:y}=ue(o);function a(e,i){let n=t.get(e);n||(n={motions:new Set,exitingMotions:new Set,el:e},t.set(e,n)),n.motions.add(i)}function c(e,i){const n=t.get(e);n&&(n.exitingMotions.delete(i),n.exitingMotions.size===0&&n.done&&r(n))}function d(e){u.add(e)}function l(e){u.delete(e)}const p={initial:o.initial,custom:o.custom,register:a,onMotionExitComplete:c,registerPending:d,unregisterPending:l};B(()=>o.custom,e=>{p.custom=e},{flush:"pre"}),le(p),j(()=>{p.initial=void 0});function x(e){if(e instanceof HTMLElement&&!e.hasAttribute(U)){e.setAttribute(U,"");const i=D.get(e);i&&!i.presenceContainer&&(i.presenceContainer=e,a(e,i))}}function r(e){var i,n,h,_,f;y(e.el),(i=e.done)==null||i.call(e),e.done=void 0,(n=e.el)!=null&&n.isConnected?(_=(h=e.motions.values().next())==null?void 0:h.value)==null||_.didUpdate():(e.motions.forEach(w=>{w.unmount()}),e.motions.clear()),(f=o.onExitComplete)==null||f.call(o)}function S(e,i){x(e);const n=t.get(e);n&&(n.exitingMotions.clear(),n.motions.forEach(h=>{h.setActive("exit",!1),h.getSnapshot(h.options,!0)})),i()}function P(e,i){var n,h,_;const f=e;x(f),u.forEach(m=>{m.element&&f.contains(m.element)&&(m.presenceContainer=f,a(f,m),u.delete(m))});const w=t.get(f),W=D.get(f);if((!w||w.motions.size===0)&&!W){i(),(n=o.onExitComplete)==null||n.call(o);return}w.done=i,b(f),w.motions.forEach(m=>{w.exitingMotions.add(m),m.setActive("exit",!0),m.getSnapshot(m.options,!1)}),(_=(h=w.motions.values().next())==null?void 0:h.value)==null||_.didUpdate()}return H(()=>{t.forEach(e=>{e.motions.forEach(i=>{i.unmount()})}),t.clear()}),{enter:S,exit:P}}const de=N({name:"AnimatePresence",inheritAttrs:!0,__name:"AnimatePresence",props:{mode:{default:"sync"},initial:{type:Boolean,default:!0},as:{},custom:{},onExitComplete:{},anchorX:{default:"left"}},setup(o){const t=o,{enter:u,exit:b}=ce(t),y=I(()=>t.mode!=="wait"?{tag:t.as}:{mode:t.mode==="wait"?"out-in":void 0});return(a,c)=>(C(),E(T(a.mode==="wait"?O:F),M(y.value,{appear:"",onLeave:s(b),onEnter:s(u)}),{default:v(()=>[V(a.$slots,"default")]),_:3},16,["onLeave","onEnter"]))}}),fe={slots:{base:"rounded-md w-full",overlay:"fixed inset-0 bg-default/75 backdrop-blur-sm will-change-opacity",content:"fixed inset-0 flex items-center justify-center cursor-zoom-out focus:outline-none",zoomedImage:"w-full h-auto max-w-[95vw] max-h-[95vh] object-contain rounded-md"},variants:{zoom:{true:"will-change-transform"},open:{true:""}},compoundVariants:[{zoom:!0,open:!1,class:"cursor-zoom-in"}]},me=["onClick"],ve=Object.assign({inheritAttrs:!1},{__name:"ProseImg",props:{src:{type:String,required:!0},alt:{type:String,required:!0},width:{type:[String,Number],required:!1},height:{type:[String,Number],required:!1},class:{type:null,required:!1},zoom:{type:Boolean,required:!1,default:!0},ui:{type:null,required:!1}},setup(o){const t=o,u=X(),[b,y]=$(),[a,c]=$(),d=Q(!1),l=I(()=>q({extend:q(fe),...u.ui?.prose?.img||{}})({zoom:t.zoom,open:d.value})),p=I(()=>{if(t.src?.startsWith("/")&&!t.src.startsWith("//")){const r=Y(J(K().app.baseURL));if(r!=="/"&&!t.src.startsWith(r))return ee(r,t.src)}return t.src}),x=I(()=>`${p.value}::${te()}`);return t.zoom&&Z(window,"scroll",()=>{d.value=!1}),(r,S)=>(C(),k(G,null,[g(s(b),null,{default:v(()=>[(C(),E(T(s(L)),M({src:p.value,alt:o.alt,width:o.width,height:o.height},r.$attrs,{class:l.value.base({class:[t.ui?.base,t.class]})}),null,16,["src","alt","width","height","class"]))]),_:1}),g(s(a),null,{default:v(()=>[(C(),E(T(s(L)),M({src:p.value,alt:o.alt},r.$attrs,{class:l.value.zoomedImage({class:[t.ui?.zoomedImage]})}),null,16,["src","alt","class"]))]),_:1}),o.zoom?(C(),E(s(ae),{key:0,open:d.value,"onUpdate:open":S[0]||(S[0]=P=>d.value=P),modal:!1},{default:v(({close:P})=>[g(s(oe),{"as-child":""},{default:v(()=>[g(s(z),{"layout-id":x.value,"as-child":"",transition:{type:"spring",bounce:.15,duration:.5,ease:"easeInOut"}},{default:v(()=>[g(s(y))]),_:1},8,["layout-id"])]),_:1}),g(s(ne),null,{default:v(()=>[g(s(de),null,{default:v(()=>[d.value?(C(),E(s(z),{key:0,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},class:A(l.value.overlay({class:[t.ui?.overlay]}))},null,8,["class"])):R("",!0),d.value?(C(),k("div",{key:1,class:A(l.value.content({class:[t.ui?.content]})),onClick:P},[g(s(z),{"as-child":"","layout-id":x.value,transition:{type:"spring",bounce:.15,duration:.5,ease:"easeInOut"}},{default:v(()=>[g(s(c))]),_:1},8,["layout-id"])],10,me)):R("",!0)]),_:2},1024)]),_:2},1024)]),_:1},8,["open"])):(C(),E(s(y),{key:1}))],64))}});export{ve as default};
