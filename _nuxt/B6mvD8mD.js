import{I as E,$ as T,a0 as A,a1 as I,U as M,i as S,a2 as U,a3 as j,a4 as L,a5 as v,a6 as V,a7 as P,a8 as W,a9 as q}from"./BKh8bA8C.js";import{h as K,f as F,a as z}from"./BLETcTSH.js";import{f as x,n as G}from"./iik6CYzq.js";function H(t,n){return n.reduce((e,o)=>{const r=J(t,o);return r!==void 0&&(e[o]=r),e},{})}function J(t,n){return n.split(".").reduce((e,o)=>e&&e[o],t)}const y="default",D=/^@|^v-on:/,w=/^:|^v-bind:/,Q=/^v-model/,X=["select","textarea","input"],Y=new Set(["math","svg"]),O=new Set,Z=Object.fromEntries(["p","a","blockquote","code","pre","code","em","h1","h2","h3","h4","h5","h6","hr","img","ul","ol","li","strong","table","thead","tbody","td","th","tr","script"].map(t=>[t,`prose-${t}`])),k=["script","base"],tt=E({name:"MDCRenderer",props:{body:{type:Object,required:!0},data:{type:Object,default:()=>({})},class:{type:[String,Object],default:void 0},tag:{type:[String,Boolean],default:void 0},prose:{type:Boolean,default:void 0},components:{type:Object,default:()=>({})},unwrap:{type:[Boolean,String],default:!1}},async setup(t){const e=A()?.appContext?.app?.$nuxt,o=e?.$route||e?._route,{mdc:r}=e?.$config?.public||{},s=r?.components?.customElements||r?.components?.custom;s&&s.forEach(a=>O.add(a));const p=S(()=>({...r?.components?.prose&&t.prose!==!1?Z:{},...r?.components?.map||{},...q(t.data?.mdc?.components||{}),...t.components})),l=S(()=>{const a=(t.body?.children||[]).map(u=>u.tag||u.type).filter(u=>!C(u));return Array.from(new Set(a)).sort().join(".")}),c=I({...t.data});M(()=>t.data,a=>{Object.assign(c,a)}),await lt(t.body,{tags:p.value});function i(a,u){const m=a.split(".").length-1;return a.split(".").reduce((f,d,g)=>g==m&&f?(f[d]=u,f[d]):typeof f=="object"?f[d]:void 0,c)}return{tags:p,contentKey:l,route:o,runtimeData:c,updateRuntimeData:i}},render(t){const{tags:n,tag:e,body:o,data:r,contentKey:s,route:p,unwrap:l,runtimeData:c,updateRuntimeData:i}=t;if(!o)return null;const a={...r,tags:n,$route:p,runtimeData:c,updateRuntimeData:i},u=e!==!1?b(e||a.component?.name||a.component||"div"):void 0;return u?T(u,{...a.component?.props,class:t.class,...this.$attrs,key:s},{default:m}):m?.();function m(){const f=R(o,T,{documentMeta:a,parentScope:a,resolveComponent:b});return f?.default?l?x(f.default(),typeof l=="string"?l.split(" "):["*"]):f.default():null}}});function et(t,n,e,o){const{documentMeta:r,parentScope:s,resolveComponent:p}=e;if(t.type==="text")return n(v,t.value);if(t.type==="comment")return n(V,null,t.value);const l=t.tag,c=N(t,r.tags);if(t.tag==="binding")return nt(t,n,r,s);const i=$(c)?m=>m:p;if(k.includes(c))return n("pre",{class:"mdc-renderer-dangerous-tag"},"<"+c+">"+G(t)+"</"+c+">");const a=i(c);typeof a=="object"&&(a.tag=l);const u=rt(t,r);return o&&(u.key=o),n(a,u,R(t,n,{documentMeta:r,parentScope:{...s,...u},resolveComponent:i}))}function R(t,n,e){const{documentMeta:o,parentScope:r,resolveComponent:s}=e,l=(t.children||[]).reduce((i,a)=>{if(!ut(a))return i[y].children.push(a),i;const u=ct(a);return i[u]=i[u]||{props:{},children:[]},a.type==="element"&&(i[u].props=a.props,i[u].children.push(...a.children||[])),i},{[y]:{props:{},children:[]}});return Object.entries(l).reduce((i,[a,{props:u,children:m}])=>(m.length&&(i[a]=(f={})=>{const d=H(f,Object.keys(u||{}));let g=m.map((_,B)=>et(_,n,{documentMeta:o,parentScope:{...r,...d},resolveComponent:s},String(_.props?.key||B)));return u?.unwrap&&(g=x(g,u.unwrap)),pt(g)}),i),{})}function nt(t,n,e,o={}){const r={...e.runtimeData,...o,$document:e,$doc:e},s=/\.|\[(\d+)\]/,l=(t.props?.value.trim().split(s).filter(Boolean)).reduce((i,a)=>{if(i&&a in i)return typeof i[a]=="function"?i[a]():i[a]},r),c=t.props?.defaultValue;return n(v,l??c??"")}function rt(t,n){const{tag:e="",props:o={}}=t;return Object.keys(o).reduce(function(r,s){if(s==="__ignoreMap")return r;const p=o[s];if(Q.test(s))return ot(s,p,r,n,{native:X.includes(e)});if(s==="v-bind")return st(s,p,r,n);if(D.test(s))return at(s,p,r,n);if(w.test(s))return it(s,p,r,n);const{attribute:l}=F(z,s);return Array.isArray(p)&&p.every(c=>typeof c=="string")?(r[l]=p.join(" "),r):(r[l]=p,r)},{})}function ot(t,n,e,o,{native:r}){const s=t.match(/^v-model:([^=]+)/)?.[1]||"modelValue",p=r?"value":s,l=r?"onInput":`onUpdate:${s}`;return e[p]=h(n,o.runtimeData),e[l]=c=>{o.updateRuntimeData(n,r?c.target?.value:c)},e}function st(t,n,e,o){const r=h(n,o);return e=Object.assign(e,r),e}function at(t,n,e,o){return t=t.replace(D,""),e.on=e.on||{},e.on[t]=()=>h(n,o),e}function it(t,n,e,o){return t=t.replace(w,""),e[t]=h(n,o),e}const b=t=>{if(typeof t=="string"){if(C(t))return t;const n=U(j(t),!1);return!t||n?.name==="AsyncComponentWrapper"||typeof n=="string"?n:"setup"in n?L(()=>new Promise(e=>e(n))):n}return t};function h(t,n){const e=t.split(".").reduce((o,r)=>typeof o=="object"?o[r]:void 0,n);return typeof e>"u"?W(t):e}function ct(t){let n="";for(const e of Object.keys(t.props||{}))if(!(!e.startsWith("#")&&!e.startsWith("v-slot:"))){n=e.split(/[:#]/,2)[1];break}return n||y}function ut(t){return t.tag==="template"}function $(t){return Y.has(t)}function pt(t){const n=[];for(const e of t){const o=n[n.length-1];e.type===v&&o?.type===v?o.children=o.children+e.children:n.push(e)}return n}async function lt(t,n){if(!t)return;const e=Array.from(new Set(o(t,n)));await Promise.all(e.map(async r=>{if(r?.render||r?.ssrRender||r?.__ssrInlineRender)return;const s=b(r);s?.__asyncLoader&&!s.__asyncResolved&&await s.__asyncLoader()}));function o(r,s){const p=r.tag;if(r.type==="text"||p==="binding"||r.type==="comment")return[];const l=N(r,s.tags);if($(l))return[];const c=[];r.type!=="root"&&!C(l)&&c.push(l);for(const i of r.children||[])c.push(...o(i,s));return c}}function N(t,n){const e=t.tag;return!e||typeof t.props?.__ignoreMap<"u"?e:n[e]||n[j(e)]||n[P(t.tag)]||e}function C(t){return(typeof t=="string"?O.has(t):!1)||K.has(t)}const gt=Object.assign(tt,{__name:"MDCRenderer"});export{gt as M};
